2020-08-22 12:07:34.065601 (MainThread): Running with dbt=0.17.2
2020-08-22 12:07:34.389668 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 12:07:34.391668 (MainThread): Tracking: tracking
2020-08-22 12:07:34.391668 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3715BB748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3715BBF48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3715BBD88>]}
2020-08-22 12:07:34.445764 (MainThread): Partial parsing not enabled
2020-08-22 12:07:34.455681 (MainThread): Parsing macros\core.sql
2020-08-22 12:07:34.468683 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 12:07:34.538699 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 12:07:34.554701 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 12:07:34.560703 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 12:07:34.567713 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 12:07:34.575706 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 12:07:34.581708 (MainThread): Parsing macros\etc\query.sql
2020-08-22 12:07:34.586718 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 12:07:34.602712 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 12:07:34.625716 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 12:07:34.633718 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 12:07:34.647730 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 12:07:34.682728 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 12:07:34.725737 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 12:07:34.735739 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 12:07:34.762744 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 12:07:34.777748 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 12:07:34.789750 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 12:07:34.803762 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 12:07:34.810755 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 12:07:34.816756 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 12:07:34.821768 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 12:07:34.830759 (MainThread): Parsing macros\adapters.sql
2020-08-22 12:07:34.858764 (MainThread): Parsing macros\catalog.sql
2020-08-22 12:07:34.871777 (MainThread): Parsing macros\etc.sql
2020-08-22 12:07:34.878768 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 12:07:34.901774 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 12:07:34.909775 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 12:07:34.917776 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 12:07:34.935781 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 12:07:34.965796 (MainThread): Partial parsing not enabled
2020-08-22 12:07:35.017806 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 12:07:35.018807 (MainThread): Opening a new connection, currently in state init
2020-08-22 12:07:35.053814 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 12:07:35.053814 (MainThread): Opening a new connection, currently in state closed
2020-08-22 12:07:35.305858 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 12:07:35.306857 (MainThread): 
2020-08-22 12:07:35.307859 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 12:07:35.307859 (MainThread): Opening a new connection, currently in state closed
2020-08-22 12:07:35.310868 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211".
2020-08-22 12:07:35.311858 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 12:07:35.619603 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_quick-asset-287211_dbt_alice".
2020-08-22 12:07:35.619603 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2020-08-22 12:07:35.619603 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_quick-asset-287211_dbt_alice".
2020-08-22 12:07:35.619603 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2020-08-22 12:07:35.619603 (ThreadPoolExecutor-0_0): Creating schema "quick-asset-287211.dbt_alice".
2020-08-22 12:07:35.620594 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 12:07:36.316230 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 12:07:36.316230 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 12:07:36.317239 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 12:07:36.651663 (MainThread): 07:07:36 | Concurrency: 1 threads (target='dev')
2020-08-22 12:07:36.651663 (MainThread): 07:07:36 | 
2020-08-22 12:07:36.654673 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-08-22 12:07:36.655673 (Thread-1): 07:07:36 | 1 of 2 START table model dbt_alice.my_first_dbt_model................ [RUN]
2020-08-22 12:07:36.656674 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 12:07:36.656674 (Thread-1): Opening a new connection, currently in state init
2020-08-22 12:07:36.656674 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-08-22 12:07:36.678679 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 12:07:36.680670 (Thread-1): finished collecting timing info
2020-08-22 12:07:36.729688 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 12:07:36.731680 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-08-22 12:07:39.132110 (Thread-1): finished collecting timing info
2020-08-22 12:07:39.133101 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b74f4647-fc1b-474b-94c4-257daf514e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3717DF2C8>]}
2020-08-22 12:07:39.134101 (Thread-1): 07:07:39 | 1 of 2 OK created table model dbt_alice.my_first_dbt_model........... [CREATE TABLE (2) in 2.48s]
2020-08-22 12:07:39.135101 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-08-22 12:07:39.135101 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-08-22 12:07:39.136101 (Thread-1): 07:07:39 | 2 of 2 START view model dbt_alice.my_second_dbt_model................ [RUN]
2020-08-22 12:07:39.137102 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 12:07:39.137102 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 12:07:39.137102 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-08-22 12:07:39.145112 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 12:07:39.146104 (Thread-1): finished collecting timing info
2020-08-22 12:07:39.168117 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 12:07:39.169109 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
where id = 1;


2020-08-22 12:07:40.140176 (Thread-1): finished collecting timing info
2020-08-22 12:07:40.141177 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b74f4647-fc1b-474b-94c4-257daf514e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3717DAEC8>]}
2020-08-22 12:07:40.143177 (Thread-1): 07:07:40 | 2 of 2 OK created view model dbt_alice.my_second_dbt_model........... [CREATE VIEW in 1.01s]
2020-08-22 12:07:40.144177 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-08-22 12:07:40.189186 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 12:07:40.189186 (MainThread): Opening a new connection, currently in state closed
2020-08-22 12:07:40.190188 (MainThread): 07:07:40 | 
2020-08-22 12:07:40.190188 (MainThread): 07:07:40 | Finished running 1 table model, 1 view model in 4.88s.
2020-08-22 12:07:40.192188 (MainThread): Connection 'master' was properly closed.
2020-08-22 12:07:40.192188 (MainThread): Connection 'create_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 12:07:40.192188 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 12:07:40.192188 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2020-08-22 12:07:40.201190 (MainThread): 
2020-08-22 12:07:40.201190 (MainThread): Completed successfully
2020-08-22 12:07:40.202189 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-08-22 12:07:40.203189 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E37189B508>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E37176CF88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3717BBF88>]}
2020-08-22 12:07:40.203189 (MainThread): Flushing usage events
2020-08-22 12:28:41.777057 (MainThread): Running with dbt=0.17.2
2020-08-22 12:28:42.199101 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 12:28:42.200101 (MainThread): Tracking: tracking
2020-08-22 12:28:42.201093 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEB231B848>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEB231D308>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEB231D348>]}
2020-08-22 12:28:42.255112 (MainThread): Partial parsing not enabled
2020-08-22 12:28:42.263107 (MainThread): Parsing macros\core.sql
2020-08-22 12:28:42.276108 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 12:28:42.343123 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 12:28:42.359126 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 12:28:42.365129 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 12:28:42.371129 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 12:28:42.378130 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 12:28:42.384132 (MainThread): Parsing macros\etc\query.sql
2020-08-22 12:28:42.391143 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 12:28:42.405136 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 12:28:42.428141 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 12:28:42.435143 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 12:28:42.449147 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 12:28:42.482153 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 12:28:42.524162 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 12:28:42.533165 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 12:28:42.559170 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 12:28:42.573173 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 12:28:42.584175 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 12:28:42.598179 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 12:28:42.605180 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 12:28:42.610181 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 12:28:42.616182 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 12:28:42.623184 (MainThread): Parsing macros\adapters.sql
2020-08-22 12:28:42.650190 (MainThread): Parsing macros\catalog.sql
2020-08-22 12:28:42.662192 (MainThread): Parsing macros\etc.sql
2020-08-22 12:28:42.668193 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 12:28:42.690208 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 12:28:42.697200 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 12:28:42.705201 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 12:28:42.723206 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 12:28:42.749221 (MainThread): Partial parsing not enabled
2020-08-22 12:28:42.791229 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 12:28:42.791229 (MainThread): Opening a new connection, currently in state init
2020-08-22 12:28:42.823236 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 12:28:42.823236 (MainThread): Opening a new connection, currently in state closed
2020-08-22 12:28:42.836239 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 12:28:42.836239 (MainThread): Opening a new connection, currently in state closed
2020-08-22 12:28:43.097427 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 12:28:43.098287 (MainThread): 
2020-08-22 12:28:43.099297 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 12:28:43.099297 (MainThread): Opening a new connection, currently in state closed
2020-08-22 12:28:43.104289 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211".
2020-08-22 12:28:43.104289 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 12:28:43.541697 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 12:28:43.541697 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 12:28:43.542709 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 12:28:43.905181 (MainThread): 07:28:43 | Concurrency: 1 threads (target='dev')
2020-08-22 12:28:43.905181 (MainThread): 07:28:43 | 
2020-08-22 12:28:43.908182 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-08-22 12:28:43.910183 (Thread-1): 07:28:43 | 1 of 3 START table model dbt_alice.my_first_dbt_model................ [RUN]
2020-08-22 12:28:43.910183 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 12:28:43.910183 (Thread-1): Opening a new connection, currently in state init
2020-08-22 12:28:43.910183 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-08-22 12:28:43.939189 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 12:28:43.940189 (Thread-1): finished collecting timing info
2020-08-22 12:28:43.968195 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 12:28:44.340892 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 12:28:44.340892 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-08-22 12:28:46.651760 (Thread-1): finished collecting timing info
2020-08-22 12:28:46.652761 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '220a04f4-ab00-4a0c-ad72-34e77da4a1b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEB2599208>]}
2020-08-22 12:28:46.653753 (Thread-1): 07:28:46 | 1 of 3 OK created table model dbt_alice.my_first_dbt_model........... [CREATE TABLE (2) in 2.74s]
2020-08-22 12:28:46.654752 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-08-22 12:28:46.654752 (Thread-1): Began running node model.jaffle_shop.customers
2020-08-22 12:28:46.655753 (Thread-1): 07:28:46 | 2 of 3 START view model dbt_alice.customers.......................... [RUN]
2020-08-22 12:28:46.657753 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 12:28:46.657753 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 12:28:46.657753 (Thread-1): Compiling model.jaffle_shop.customers
2020-08-22 12:28:46.664763 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-08-22 12:28:46.665754 (Thread-1): finished collecting timing info
2020-08-22 12:28:46.691760 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-08-22 12:28:46.692769 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2020-08-22 12:28:47.635944 (Thread-1): finished collecting timing info
2020-08-22 12:28:47.636944 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '220a04f4-ab00-4a0c-ad72-34e77da4a1b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEB25A74C8>]}
2020-08-22 12:28:47.637944 (Thread-1): 07:28:47 | 2 of 3 OK created view model dbt_alice.customers..................... [CREATE VIEW in 0.98s]
2020-08-22 12:28:47.638945 (Thread-1): Finished running node model.jaffle_shop.customers
2020-08-22 12:28:47.638945 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-08-22 12:28:47.639945 (Thread-1): 07:28:47 | 3 of 3 START view model dbt_alice.my_second_dbt_model................ [RUN]
2020-08-22 12:28:47.640945 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 12:28:47.640945 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 12:28:47.640945 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-08-22 12:28:47.648949 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 12:28:47.649956 (Thread-1): finished collecting timing info
2020-08-22 12:28:47.653947 (Thread-1): unclosed <socket.socket fd=844, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 62993), raddr=('216.58.194.74', 443)>
2020-08-22 12:28:47.653947 (Thread-1): unclosed <socket.socket fd=420, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 62992), raddr=('172.217.12.74', 443)>
2020-08-22 12:28:47.653947 (Thread-1): unclosed <socket.socket fd=1100, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 62995), raddr=('216.58.194.74', 443)>
2020-08-22 12:28:47.654949 (Thread-1): unclosed <socket.socket fd=1104, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 62994), raddr=('172.217.12.74', 443)>
2020-08-22 12:28:47.656958 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 12:28:47.657949 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
where id = 1;


2020-08-22 12:28:48.594217 (Thread-1): finished collecting timing info
2020-08-22 12:28:48.595217 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '220a04f4-ab00-4a0c-ad72-34e77da4a1b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEB2733108>]}
2020-08-22 12:28:48.596217 (Thread-1): 07:28:48 | 3 of 3 OK created view model dbt_alice.my_second_dbt_model........... [CREATE VIEW in 0.96s]
2020-08-22 12:28:48.597218 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-08-22 12:28:48.620791 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 12:28:48.620791 (MainThread): Opening a new connection, currently in state closed
2020-08-22 12:28:48.621792 (MainThread): 07:28:48 | 
2020-08-22 12:28:48.621792 (MainThread): 07:28:48 | Finished running 1 table model, 2 view models in 5.52s.
2020-08-22 12:28:48.622792 (MainThread): Connection 'master' was properly closed.
2020-08-22 12:28:48.622792 (MainThread): Connection 'list_quick-asset-287211' was properly closed.
2020-08-22 12:28:48.622792 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 12:28:48.622792 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2020-08-22 12:28:48.636795 (MainThread): 
2020-08-22 12:28:48.636795 (MainThread): Completed successfully
2020-08-22 12:28:48.637796 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-08-22 12:28:48.638795 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEB248BF08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEB271D688>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEB2792648>]}
2020-08-22 12:28:48.638795 (MainThread): Flushing usage events
2020-08-22 12:28:56.607594 (MainThread): Running with dbt=0.17.2
2020-08-22 12:28:56.952252 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 12:28:56.953252 (MainThread): Tracking: tracking
2020-08-22 12:28:56.953252 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ACDB2B888>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ACDB2BF48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ACDB2B708>]}
2020-08-22 12:28:57.004262 (MainThread): Partial parsing not enabled
2020-08-22 12:28:57.008255 (MainThread): Parsing macros\core.sql
2020-08-22 12:28:57.015265 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 12:28:57.083280 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 12:28:57.096283 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 12:28:57.098283 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 12:28:57.100283 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 12:28:57.103284 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 12:28:57.106284 (MainThread): Parsing macros\etc\query.sql
2020-08-22 12:28:57.107277 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 12:28:57.118287 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 12:28:57.139284 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 12:28:57.141284 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 12:28:57.150294 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 12:28:57.178300 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 12:28:57.217309 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 12:28:57.219310 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 12:28:57.241314 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 12:28:57.251317 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 12:28:57.257308 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 12:28:57.266320 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 12:28:57.269311 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 12:28:57.270311 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 12:28:57.272321 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 12:28:57.274312 (MainThread): Parsing macros\adapters.sql
2020-08-22 12:28:57.295326 (MainThread): Parsing macros\catalog.sql
2020-08-22 12:28:57.304328 (MainThread): Parsing macros\etc.sql
2020-08-22 12:28:57.305328 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 12:28:57.322333 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 12:28:57.325324 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 12:28:57.328333 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 12:28:57.341413 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 12:28:57.367341 (MainThread): Partial parsing not enabled
2020-08-22 12:28:57.411341 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 12:28:57.411341 (MainThread): Opening a new connection, currently in state init
2020-08-22 12:28:57.444359 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 12:28:57.444359 (MainThread): Opening a new connection, currently in state closed
2020-08-22 12:28:57.458353 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 12:28:57.458353 (MainThread): Opening a new connection, currently in state closed
2020-08-22 12:28:57.709407 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 12:28:57.710407 (MainThread): 
2020-08-22 12:28:57.711407 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 12:28:57.711407 (MainThread): Opening a new connection, currently in state closed
2020-08-22 12:28:57.716409 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211".
2020-08-22 12:28:57.716409 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 12:28:58.068844 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 12:28:58.068844 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 12:28:58.069844 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 12:28:58.397048 (MainThread): 07:28:58 | Concurrency: 1 threads (target='dev')
2020-08-22 12:28:58.397515 (MainThread): 07:28:58 | 
2020-08-22 12:28:58.400518 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-08-22 12:28:58.401527 (Thread-1): 07:28:58 | 1 of 3 START table model dbt_alice.my_first_dbt_model................ [RUN]
2020-08-22 12:28:58.401527 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 12:28:58.401527 (Thread-1): Opening a new connection, currently in state init
2020-08-22 12:28:58.401527 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-08-22 12:28:58.422531 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 12:28:58.423588 (Thread-1): finished collecting timing info
2020-08-22 12:28:58.450529 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 12:28:58.804703 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 12:28:58.805703 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-08-22 12:29:00.665353 (Thread-1): finished collecting timing info
2020-08-22 12:29:00.665353 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f97c681-0493-4752-9848-1cd3e8628116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ACDCE4B88>]}
2020-08-22 12:29:00.666354 (Thread-1): 07:29:00 | 1 of 3 OK created table model dbt_alice.my_first_dbt_model........... [CREATE TABLE (2) in 2.26s]
2020-08-22 12:29:00.667354 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-08-22 12:29:00.667354 (Thread-1): Began running node model.jaffle_shop.customers
2020-08-22 12:29:00.668354 (Thread-1): 07:29:00 | 2 of 3 START view model dbt_alice.customers.......................... [RUN]
2020-08-22 12:29:00.669425 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 12:29:00.669425 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 12:29:00.669425 (Thread-1): Compiling model.jaffle_shop.customers
2020-08-22 12:29:00.674437 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-08-22 12:29:00.675438 (Thread-1): finished collecting timing info
2020-08-22 12:29:00.697443 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-08-22 12:29:00.699434 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(o2rder_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2020-08-22 12:29:01.412695 (Thread-1): finished collecting timing info
2020-08-22 12:29:01.413706 (Thread-1): Database Error in model customers (models\customers.sql)
  Unrecognized name: o2rder_id; Did you mean order_id? at [36:15]
  compiled SQL at target\run\jaffle_shop\models\customers.sql
Traceback (most recent call last):
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 85, in exception_handler
    yield
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 364, in _retry_and_handle
    deadline=None)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 226, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 353, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\future\polling.py", line 122, in result
    self._blocking_poll(timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\job.py", line 3098, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\future\polling.py", line 101, in _blocking_poll
    retry_(self._done_or_raise)()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\future\polling.py", line 80, in _done_or_raise
    if not self.done():
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\job.py", line 3085, in done
    timeout=timeout,
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\client.py", line 1287, in _get_query_results
    retry, method="GET", path=path, query_params=extra_params, timeout=timeout
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\client.py", line 556, in _call_api
    return call()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\_http.py", line 423, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/quick-asset-287211/queries/0788fa0b-31d0-4f31-869c-15413eedaa80?maxResults=0&location=US: Unrecognized name: o2rder_id; Did you mean order_id? at [36:15]

(job ID: 0788fa0b-31d0-4f31-869c-15413eedaa80)

                                                         -----Query Job SQL Follows-----                                                         

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
   2:
   3:
   4:  create or replace view `quick-asset-287211`.`dbt_alice`.`customers`
   5:  OPTIONS()
   6:  as with customers as (
   7:
   8:    select
   9:        id as customer_id,
  10:        first_name,
  11:        last_name
  12:
  13:    from `dbt-tutorial`.jaffle_shop.customers
  14:
  15:),
  16:
  17:orders as (
  18:
  19:    select
  20:        id as order_id,
  21:        user_id as customer_id,
  22:        order_date,
  23:        status
  24:
  25:    from `dbt-tutorial`.jaffle_shop.orders
  26:
  27:),
  28:
  29:customer_orders as (
  30:
  31:    select
  32:        customer_id,
  33:
  34:        min(order_date) as first_order_date,
  35:        max(order_date) as most_recent_order_date,
  36:        count(o2rder_id) as number_of_orders
  37:
  38:    from orders
  39:
  40:    group by 1
  41:
  42:),
  43:
  44:
  45:final as (
  46:
  47:    select
  48:        customers.customer_id,
  49:        customers.first_name,
  50:        customers.last_name,
  51:        customer_orders.first_order_date,
  52:        customer_orders.most_recent_order_date,
  53:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  54:
  55:    from customers
  56:
  57:    left join customer_orders using (customer_id)
  58:
  59:)
  60:
  61:select * from final;
  62:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\base\impl.py", line 228, in execute
    fetch=fetch
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 235, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 228, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 364, in _retry_and_handle
    deadline=None)
  File "c:\users\bhala\.conda\envs\dbt\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 89, in exception_handler
    self.handle_error(e, message)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 77, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models\customers.sql)
  Unrecognized name: o2rder_id; Did you mean order_id? at [36:15]
  compiled SQL at target\run\jaffle_shop\models\customers.sql
2020-08-22 12:29:01.491271 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f97c681-0493-4752-9848-1cd3e8628116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ACDDB41C8>]}
2020-08-22 12:29:01.492280 (Thread-1): 07:29:01 | 2 of 3 ERROR creating view model dbt_alice.customers................. [ERROR in 0.82s]
2020-08-22 12:29:01.493270 (Thread-1): Finished running node model.jaffle_shop.customers
2020-08-22 12:29:01.493270 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-08-22 12:29:01.494271 (Thread-1): 07:29:01 | 3 of 3 START view model dbt_alice.my_second_dbt_model................ [RUN]
2020-08-22 12:29:01.495280 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 12:29:01.495280 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 12:29:01.495280 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-08-22 12:29:01.503272 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 12:29:01.504273 (Thread-1): finished collecting timing info
2020-08-22 12:29:01.508273 (Thread-1): unclosed <socket.socket fd=672, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 63006), raddr=('216.58.194.74', 443)>
2020-08-22 12:29:01.509275 (Thread-1): unclosed <socket.socket fd=720, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 63005), raddr=('172.217.12.74', 443)>
2020-08-22 12:29:01.509275 (Thread-1): unclosed <socket.socket fd=1100, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 63007), raddr=('172.217.12.74', 443)>
2020-08-22 12:29:01.509275 (Thread-1): unclosed <socket.socket fd=1104, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 63008), raddr=('216.58.194.74', 443)>
2020-08-22 12:29:01.510274 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 12:29:01.511275 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
where id = 1;


2020-08-22 12:29:02.457440 (Thread-1): finished collecting timing info
2020-08-22 12:29:02.457440 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f97c681-0493-4752-9848-1cd3e8628116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ACDDC4B08>]}
2020-08-22 12:29:02.458440 (Thread-1): 07:29:02 | 3 of 3 OK created view model dbt_alice.my_second_dbt_model........... [CREATE VIEW in 0.96s]
2020-08-22 12:29:02.459671 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-08-22 12:29:02.553640 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 12:29:02.553640 (MainThread): Opening a new connection, currently in state closed
2020-08-22 12:29:02.554633 (MainThread): 07:29:02 | 
2020-08-22 12:29:02.554633 (MainThread): 07:29:02 | Finished running 1 table model, 2 view models in 4.84s.
2020-08-22 12:29:02.556175 (MainThread): Connection 'master' was properly closed.
2020-08-22 12:29:02.556175 (MainThread): Connection 'list_quick-asset-287211' was properly closed.
2020-08-22 12:29:02.556175 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 12:29:02.556175 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2020-08-22 12:29:02.566181 (MainThread): 
2020-08-22 12:29:02.566181 (MainThread): Completed with 1 error and 0 warnings:
2020-08-22 12:29:02.566181 (MainThread): 
2020-08-22 12:29:02.567180 (MainThread): Database Error in model customers (models\customers.sql)
2020-08-22 12:29:02.567180 (MainThread):   Unrecognized name: o2rder_id; Did you mean order_id? at [36:15]
2020-08-22 12:29:02.568180 (MainThread):   compiled SQL at target\run\jaffle_shop\models\customers.sql
2020-08-22 12:29:02.568180 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2020-08-22 12:29:02.569181 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ACDE5FB08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ACDD44908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ACDC44248>]}
2020-08-22 12:29:02.569181 (MainThread): Flushing usage events
2020-08-22 12:30:34.602299 (MainThread): Running with dbt=0.17.2
2020-08-22 12:30:34.926361 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 12:30:34.926361 (MainThread): Tracking: tracking
2020-08-22 12:30:34.927361 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD9B96B808>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD9B96BEC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD9B96B748>]}
2020-08-22 12:30:34.978372 (MainThread): Partial parsing not enabled
2020-08-22 12:30:34.981504 (MainThread): Parsing macros\core.sql
2020-08-22 12:30:34.987551 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 12:30:35.051565 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 12:30:35.063568 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 12:30:35.064568 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 12:30:35.067569 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 12:30:35.069569 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 12:30:35.071570 (MainThread): Parsing macros\etc\query.sql
2020-08-22 12:30:35.073570 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 12:30:35.083572 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 12:30:35.101576 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 12:30:35.103576 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 12:30:35.112578 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 12:30:35.139584 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 12:30:35.177592 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 12:30:35.179593 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 12:30:35.201598 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 12:30:35.210600 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 12:30:35.216601 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 12:30:35.225603 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 12:30:35.227603 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 12:30:35.229604 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 12:30:35.230604 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 12:30:35.232604 (MainThread): Parsing macros\adapters.sql
2020-08-22 12:30:35.254609 (MainThread): Parsing macros\catalog.sql
2020-08-22 12:30:35.261611 (MainThread): Parsing macros\etc.sql
2020-08-22 12:30:35.262611 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 12:30:35.280615 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 12:30:35.284616 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 12:30:35.287617 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 12:30:35.300620 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 12:30:35.327625 (MainThread): Partial parsing not enabled
2020-08-22 12:30:35.372644 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 12:30:35.372644 (MainThread): Opening a new connection, currently in state init
2020-08-22 12:30:35.404642 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 12:30:35.405642 (MainThread): Opening a new connection, currently in state closed
2020-08-22 12:30:35.419655 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 12:30:35.419655 (MainThread): Opening a new connection, currently in state closed
2020-08-22 12:30:35.671700 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 12:30:35.672701 (MainThread): 
2020-08-22 12:30:35.673701 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 12:30:35.673701 (MainThread): Opening a new connection, currently in state closed
2020-08-22 12:30:35.678704 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211".
2020-08-22 12:30:35.678704 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 12:30:36.059643 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 12:30:36.059643 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 12:30:36.060634 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 12:30:36.398012 (MainThread): 07:30:36 | Concurrency: 1 threads (target='dev')
2020-08-22 12:30:36.398012 (MainThread): 07:30:36 | 
2020-08-22 12:30:36.402015 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-08-22 12:30:36.403024 (Thread-1): 07:30:36 | 1 of 3 START table model dbt_alice.my_first_dbt_model................ [RUN]
2020-08-22 12:30:36.404016 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 12:30:36.404016 (Thread-1): Opening a new connection, currently in state init
2020-08-22 12:30:36.404016 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-08-22 12:30:36.425029 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 12:30:36.426021 (Thread-1): finished collecting timing info
2020-08-22 12:30:36.454027 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 12:30:36.822525 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 12:30:36.823525 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-08-22 12:30:38.963034 (Thread-1): finished collecting timing info
2020-08-22 12:30:38.964034 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41d7f26a-0ab1-459a-b010-27955ca066bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD9BB45708>]}
2020-08-22 12:30:38.965034 (Thread-1): 07:30:38 | 1 of 3 OK created table model dbt_alice.my_first_dbt_model........... [CREATE TABLE (2) in 2.56s]
2020-08-22 12:30:38.965034 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-08-22 12:30:38.966035 (Thread-1): Began running node model.jaffle_shop.customers
2020-08-22 12:30:38.967036 (Thread-1): 07:30:38 | 2 of 3 START view model dbt_alice.customers.......................... [RUN]
2020-08-22 12:30:38.967036 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 12:30:38.967036 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 12:30:38.967036 (Thread-1): Compiling model.jaffle_shop.customers
2020-08-22 12:30:38.973036 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-08-22 12:30:38.975037 (Thread-1): finished collecting timing info
2020-08-22 12:30:38.996041 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-08-22 12:30:38.998042 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2020-08-22 12:30:39.844632 (Thread-1): finished collecting timing info
2020-08-22 12:30:39.845632 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41d7f26a-0ab1-459a-b010-27955ca066bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD9BB60408>]}
2020-08-22 12:30:39.846632 (Thread-1): 07:30:39 | 2 of 3 OK created view model dbt_alice.customers..................... [CREATE VIEW in 0.88s]
2020-08-22 12:30:39.847633 (Thread-1): Finished running node model.jaffle_shop.customers
2020-08-22 12:30:39.847633 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-08-22 12:30:39.848633 (Thread-1): 07:30:39 | 3 of 3 START view model dbt_alice.my_second_dbt_model................ [RUN]
2020-08-22 12:30:39.849633 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 12:30:39.849633 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 12:30:39.849633 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-08-22 12:30:39.861636 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 12:30:39.862637 (Thread-1): finished collecting timing info
2020-08-22 12:30:39.866637 (Thread-1): unclosed <socket.socket fd=980, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 63039), raddr=('216.58.194.74', 443)>
2020-08-22 12:30:39.866637 (Thread-1): unclosed <socket.socket fd=848, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 63038), raddr=('172.217.12.74', 443)>
2020-08-22 12:30:39.866637 (Thread-1): unclosed <socket.socket fd=1100, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 63040), raddr=('172.217.12.74', 443)>
2020-08-22 12:30:39.866637 (Thread-1): unclosed <socket.socket fd=1112, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 63041), raddr=('216.58.194.74', 443)>
2020-08-22 12:30:39.869638 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 12:30:39.870638 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
where id = 1;


2020-08-22 12:30:40.833706 (Thread-1): finished collecting timing info
2020-08-22 12:30:40.833706 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41d7f26a-0ab1-459a-b010-27955ca066bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD9BD74E08>]}
2020-08-22 12:30:40.834707 (Thread-1): 07:30:40 | 3 of 3 OK created view model dbt_alice.my_second_dbt_model........... [CREATE VIEW in 0.98s]
2020-08-22 12:30:40.835707 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-08-22 12:30:40.887600 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 12:30:40.887600 (MainThread): Opening a new connection, currently in state closed
2020-08-22 12:30:40.888601 (MainThread): 07:30:40 | 
2020-08-22 12:30:40.888601 (MainThread): 07:30:40 | Finished running 1 table model, 2 view models in 5.21s.
2020-08-22 12:30:40.889601 (MainThread): Connection 'master' was properly closed.
2020-08-22 12:30:40.889601 (MainThread): Connection 'list_quick-asset-287211' was properly closed.
2020-08-22 12:30:40.889601 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 12:30:40.889601 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2020-08-22 12:30:40.899593 (MainThread): 
2020-08-22 12:30:40.899593 (MainThread): Completed successfully
2020-08-22 12:30:40.900595 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-08-22 12:30:40.901595 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD9BC21608>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD9BB00E08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD9BDF1F08>]}
2020-08-22 12:30:40.901595 (MainThread): Flushing usage events
2020-08-22 12:37:53.898312 (MainThread): Running with dbt=0.17.2
2020-08-22 12:37:54.219170 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 12:37:54.219170 (MainThread): Tracking: tracking
2020-08-22 12:37:54.220162 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB05A3A608>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB05A3AFC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB05A3ACC8>]}
2020-08-22 12:37:54.269181 (MainThread): Partial parsing not enabled
2020-08-22 12:37:54.272182 (MainThread): Parsing macros\core.sql
2020-08-22 12:37:54.278183 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 12:37:54.340197 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 12:37:54.352199 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 12:37:54.353201 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 12:37:54.356200 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 12:37:54.358320 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 12:37:54.361323 (MainThread): Parsing macros\etc\query.sql
2020-08-22 12:37:54.362201 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 12:37:54.372194 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 12:37:54.391209 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 12:37:54.394327 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 12:37:54.403336 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 12:37:54.431216 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 12:37:54.469216 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 12:37:54.471225 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 12:37:54.492229 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 12:37:54.501231 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 12:37:54.508225 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 12:37:54.516235 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 12:37:54.519235 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 12:37:54.520235 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 12:37:54.522228 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 12:37:54.524236 (MainThread): Parsing macros\adapters.sql
2020-08-22 12:37:54.545241 (MainThread): Parsing macros\catalog.sql
2020-08-22 12:37:54.554235 (MainThread): Parsing macros\etc.sql
2020-08-22 12:37:54.554235 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 12:37:54.572238 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 12:37:54.576248 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 12:37:54.578249 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 12:37:54.592243 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 12:37:54.619258 (MainThread): Partial parsing not enabled
2020-08-22 12:37:54.662267 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 12:37:54.662267 (MainThread): Opening a new connection, currently in state init
2020-08-22 12:37:54.698274 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 12:37:54.699275 (MainThread): Opening a new connection, currently in state closed
2020-08-22 12:37:54.714278 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 12:37:54.714278 (MainThread): Opening a new connection, currently in state closed
2020-08-22 12:37:54.974380 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 12:37:54.975335 (MainThread): 
2020-08-22 12:37:54.976325 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 12:37:54.976325 (MainThread): Opening a new connection, currently in state closed
2020-08-22 12:37:54.981327 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211".
2020-08-22 12:37:54.981327 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 12:37:55.412057 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 12:37:55.412057 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 12:37:55.413058 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 12:37:55.767508 (MainThread): 07:37:55 | Concurrency: 1 threads (target='dev')
2020-08-22 12:37:55.767950 (MainThread): 07:37:55 | 
2020-08-22 12:37:55.770954 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-08-22 12:37:55.771955 (Thread-1): 07:37:55 | 1 of 3 START table model dbt_alice.my_first_dbt_model................ [RUN]
2020-08-22 12:37:55.771955 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 12:37:55.772955 (Thread-1): Opening a new connection, currently in state init
2020-08-22 12:37:55.772955 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-08-22 12:37:55.792969 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 12:37:55.793968 (Thread-1): finished collecting timing info
2020-08-22 12:37:55.820974 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 12:37:56.229634 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 12:37:56.230635 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-08-22 12:37:58.767282 (Thread-1): finished collecting timing info
2020-08-22 12:37:58.768282 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91e19010-c402-41cf-87a9-01e23b7ecd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB05CB1F88>]}
2020-08-22 12:37:58.769282 (Thread-1): 07:37:58 | 1 of 3 OK created table model dbt_alice.my_first_dbt_model........... [CREATE TABLE (2) in 3.00s]
2020-08-22 12:37:58.770283 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-08-22 12:37:58.770283 (Thread-1): Began running node model.jaffle_shop.customers
2020-08-22 12:37:58.771282 (Thread-1): 07:37:58 | 2 of 3 START table model dbt_alice.customers......................... [RUN]
2020-08-22 12:37:58.771282 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 12:37:58.772282 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 12:37:58.772282 (Thread-1): Compiling model.jaffle_shop.customers
2020-08-22 12:37:58.778284 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-08-22 12:37:58.778284 (Thread-1): finished collecting timing info
2020-08-22 12:37:58.783285 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 12:37:59.157967 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 12:37:59.281435 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-08-22 12:37:59.282435 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2020-08-22 12:38:01.999132 (Thread-1): finished collecting timing info
2020-08-22 12:38:02.000132 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91e19010-c402-41cf-87a9-01e23b7ecd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB05CE6B48>]}
2020-08-22 12:38:02.001133 (Thread-1): 07:38:02 | 2 of 3 OK created table model dbt_alice.customers.................... [CREATE TABLE (100) in 3.23s]
2020-08-22 12:38:02.002242 (Thread-1): Finished running node model.jaffle_shop.customers
2020-08-22 12:38:02.002242 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-08-22 12:38:02.003124 (Thread-1): 07:38:02 | 3 of 3 START view model dbt_alice.my_second_dbt_model................ [RUN]
2020-08-22 12:38:02.004133 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 12:38:02.004133 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 12:38:02.004133 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-08-22 12:38:02.013126 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 12:38:02.013126 (Thread-1): finished collecting timing info
2020-08-22 12:38:02.022137 (Thread-1): unclosed <socket.socket fd=996, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 63115), raddr=('172.217.9.10', 443)>
2020-08-22 12:38:02.022137 (Thread-1): unclosed <socket.socket fd=1020, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 63114), raddr=('216.58.194.138', 443)>
2020-08-22 12:38:02.022137 (Thread-1): unclosed <socket.socket fd=1076, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 63117), raddr=('172.217.9.10', 443)>
2020-08-22 12:38:02.023129 (Thread-1): unclosed <socket.socket fd=1080, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 63116), raddr=('216.58.194.138', 443)>
2020-08-22 12:38:02.036140 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 12:38:02.037142 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
where id = 1;


2020-08-22 12:38:02.990922 (Thread-1): finished collecting timing info
2020-08-22 12:38:02.991922 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91e19010-c402-41cf-87a9-01e23b7ecd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB05D93AC8>]}
2020-08-22 12:38:02.993922 (Thread-1): 07:38:02 | 3 of 3 OK created view model dbt_alice.my_second_dbt_model........... [CREATE VIEW in 0.99s]
2020-08-22 12:38:02.993922 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-08-22 12:38:03.079875 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 12:38:03.079875 (MainThread): Opening a new connection, currently in state closed
2020-08-22 12:38:03.080875 (MainThread): 07:38:03 | 
2020-08-22 12:38:03.080875 (MainThread): 07:38:03 | Finished running 2 table models, 1 view model in 8.10s.
2020-08-22 12:38:03.081875 (MainThread): Connection 'master' was properly closed.
2020-08-22 12:38:03.081875 (MainThread): Connection 'list_quick-asset-287211' was properly closed.
2020-08-22 12:38:03.081875 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 12:38:03.081875 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2020-08-22 12:38:03.091877 (MainThread): 
2020-08-22 12:38:03.091877 (MainThread): Completed successfully
2020-08-22 12:38:03.092878 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-08-22 12:38:03.092878 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB05C14DC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB05D92E48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB05E70808>]}
2020-08-22 12:38:03.093887 (MainThread): Flushing usage events
2020-08-22 14:55:43.959177 (MainThread): Running with dbt=0.17.2
2020-08-22 14:55:44.384281 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 14:55:44.385424 (MainThread): Tracking: tracking
2020-08-22 14:55:44.386272 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201807CB48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201807CAC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201807E0C8>]}
2020-08-22 14:55:44.436293 (MainThread): Partial parsing not enabled
2020-08-22 14:55:44.446295 (MainThread): Parsing macros\core.sql
2020-08-22 14:55:44.458512 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 14:55:44.522526 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 14:55:44.534528 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 14:55:44.540540 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 14:55:44.548532 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 14:55:44.551542 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 14:55:44.558534 (MainThread): Parsing macros\etc\query.sql
2020-08-22 14:55:44.564763 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 14:55:44.574537 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 14:55:44.597544 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 14:55:44.604544 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 14:55:44.613089 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 14:55:44.641097 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 14:55:44.683108 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 14:55:44.692109 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 14:55:44.715114 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 14:55:44.725117 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 14:55:44.732118 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 14:55:44.745121 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 14:55:44.752123 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 14:55:44.757124 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 14:55:44.759133 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 14:55:44.766126 (MainThread): Parsing macros\adapters.sql
2020-08-22 14:55:44.793132 (MainThread): Parsing macros\catalog.sql
2020-08-22 14:55:44.805294 (MainThread): Parsing macros\etc.sql
2020-08-22 14:55:44.812136 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 14:55:44.833141 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 14:55:44.837150 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 14:55:44.846144 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 14:55:44.864148 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 14:55:44.890163 (MainThread): Partial parsing not enabled
2020-08-22 14:55:44.932172 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 14:55:44.932172 (MainThread): Opening a new connection, currently in state init
2020-08-22 14:55:44.965171 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 14:55:44.965171 (MainThread): Opening a new connection, currently in state closed
2020-08-22 14:55:44.979174 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 14:55:44.979174 (MainThread): Opening a new connection, currently in state closed
2020-08-22 14:55:45.220237 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 14:55:45.221228 (MainThread): 
2020-08-22 14:55:45.222229 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 14:55:45.222229 (MainThread): Opening a new connection, currently in state closed
2020-08-22 14:55:45.227239 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211".
2020-08-22 14:55:45.227239 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 14:55:45.702985 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 14:55:45.702985 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 14:55:45.703818 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 14:55:46.106700 (MainThread): 09:55:46 | Concurrency: 1 threads (target='dev')
2020-08-22 14:55:46.107036 (MainThread): 09:55:46 | 
2020-08-22 14:55:46.109930 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-08-22 14:55:46.110941 (Thread-1): 09:55:46 | 1 of 3 START table model dbt_alice.my_first_dbt_model................ [RUN]
2020-08-22 14:55:46.110941 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 14:55:46.111932 (Thread-1): Opening a new connection, currently in state init
2020-08-22 14:55:46.111932 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-08-22 14:55:46.130945 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 14:55:46.131945 (Thread-1): finished collecting timing info
2020-08-22 14:55:46.157951 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 14:55:46.535039 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 14:55:46.536039 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-08-22 14:55:49.200904 (Thread-1): finished collecting timing info
2020-08-22 14:55:49.201903 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabe6b98-d27d-4110-aed9-834443e194ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201804CC48>]}
2020-08-22 14:55:49.202904 (Thread-1): 09:55:49 | 1 of 3 OK created table model dbt_alice.my_first_dbt_model........... [CREATE TABLE (2) in 3.09s]
2020-08-22 14:55:49.203904 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-08-22 14:55:49.203904 (Thread-1): Began running node model.jaffle_shop.customers
2020-08-22 14:55:49.204904 (Thread-1): 09:55:49 | 2 of 3 START table model dbt_alice.customers......................... [RUN]
2020-08-22 14:55:49.205673 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 14:55:49.205673 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 14:55:49.205673 (Thread-1): Compiling model.jaffle_shop.customers
2020-08-22 14:55:49.210685 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-08-22 14:55:49.211685 (Thread-1): finished collecting timing info
2020-08-22 14:55:49.216678 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 14:55:49.536152 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-08-22 14:55:49.537152 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2020-08-22 14:55:54.799254 (Thread-1): finished collecting timing info
2020-08-22 14:55:54.800253 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabe6b98-d27d-4110-aed9-834443e194ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220181F84C8>]}
2020-08-22 14:55:54.801262 (Thread-1): 09:55:54 | 2 of 3 OK created table model dbt_alice.customers.................... [CREATE TABLE (100) in 5.59s]
2020-08-22 14:55:54.801597 (Thread-1): Finished running node model.jaffle_shop.customers
2020-08-22 14:55:54.801597 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-08-22 14:55:54.802601 (Thread-1): 09:55:54 | 3 of 3 START view model dbt_alice.my_second_dbt_model................ [RUN]
2020-08-22 14:55:54.803600 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 14:55:54.803600 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 14:55:54.803600 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-08-22 14:55:54.811610 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 14:55:54.811610 (Thread-1): finished collecting timing info
2020-08-22 14:55:54.824613 (Thread-1): unclosed <socket.socket fd=980, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64536), raddr=('216.58.194.74', 443)>
2020-08-22 14:55:54.825613 (Thread-1): unclosed <socket.socket fd=720, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64535), raddr=('172.217.1.138', 443)>
2020-08-22 14:55:54.825613 (Thread-1): unclosed <socket.socket fd=1076, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64538), raddr=('216.58.194.74', 443)>
2020-08-22 14:55:54.825613 (Thread-1): unclosed <socket.socket fd=1080, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64537), raddr=('172.217.1.138', 443)>
2020-08-22 14:55:54.834615 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 14:55:54.835615 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
where id = 1;


2020-08-22 14:55:55.561471 (Thread-1): finished collecting timing info
2020-08-22 14:55:55.562471 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabe6b98-d27d-4110-aed9-834443e194ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220181F84C8>]}
2020-08-22 14:55:55.563471 (Thread-1): 09:55:55 | 3 of 3 OK created view model dbt_alice.my_second_dbt_model........... [CREATE VIEW in 0.76s]
2020-08-22 14:55:55.564230 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-08-22 14:55:55.618796 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 14:55:55.618796 (MainThread): Opening a new connection, currently in state closed
2020-08-22 14:55:55.619780 (MainThread): 09:55:55 | 
2020-08-22 14:55:55.619780 (MainThread): 09:55:55 | Finished running 2 table models, 1 view model in 10.40s.
2020-08-22 14:55:55.620780 (MainThread): Connection 'master' was properly closed.
2020-08-22 14:55:55.620780 (MainThread): Connection 'list_quick-asset-287211' was properly closed.
2020-08-22 14:55:55.620780 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 14:55:55.620780 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2020-08-22 14:55:55.629790 (MainThread): 
2020-08-22 14:55:55.630782 (MainThread): Completed successfully
2020-08-22 14:55:55.630782 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-08-22 14:55:55.631783 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022018206548>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220181FE5C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022018247288>]}
2020-08-22 14:55:55.631783 (MainThread): Flushing usage events
2020-08-22 15:04:03.712045 (MainThread): Running with dbt=0.17.2
2020-08-22 15:04:04.038118 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 15:04:04.038118 (MainThread): Tracking: tracking
2020-08-22 15:04:04.039119 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD28BA848>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD28BA9C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD28BCE48>]}
2020-08-22 15:04:04.088129 (MainThread): Partial parsing not enabled
2020-08-22 15:04:04.092130 (MainThread): Parsing macros\core.sql
2020-08-22 15:04:04.098131 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:04:04.160145 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:04:04.172140 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:04:04.174139 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:04:04.176139 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:04:04.179141 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:04:04.182142 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:04:04.183142 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:04:04.194153 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:04:04.212157 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:04:04.215150 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:04:04.223159 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:04:04.251166 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:04:04.288165 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:04:04.291175 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:04:04.313180 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:04:04.322172 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:04:04.329184 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:04:04.338185 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:04:04.340177 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:04:04.342178 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:04:04.343187 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:04:04.345259 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:04:04.366183 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:04:04.374194 (MainThread): Parsing macros\etc.sql
2020-08-22 15:04:04.375271 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:04:04.393191 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:04:04.396190 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:04:04.399190 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:04:04.412193 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:04:04.439199 (MainThread): Partial parsing not enabled
2020-08-22 15:04:04.481208 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:04:04.481208 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:04:04.513216 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:04:04.513216 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:04:04.527219 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:04:04.527219 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:04:04.774284 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:04:04.775274 (MainThread): 
2020-08-22 15:04:04.776276 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:04:04.776276 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:04:04.781277 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211".
2020-08-22 15:04:04.781277 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 15:04:05.178850 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:04:05.178850 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:04:05.178850 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:04:05.493670 (MainThread): 10:04:05 | Concurrency: 1 threads (target='dev')
2020-08-22 15:04:05.494670 (MainThread): 10:04:05 | 
2020-08-22 15:04:05.499672 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:04:05.500673 (Thread-1): 10:04:05 | 1 of 3 START table model dbt_alice.my_first_dbt_model................ [RUN]
2020-08-22 15:04:05.500673 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:04:05.501671 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:04:05.501671 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-08-22 15:04:05.522685 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:04:05.523685 (Thread-1): finished collecting timing info
2020-08-22 15:04:05.550692 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:04:05.902212 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:04:05.903213 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-08-22 15:04:07.891325 (Thread-1): finished collecting timing info
2020-08-22 15:04:07.891325 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51cb05c6-2eba-4f7e-9b04-6759b08bcffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD2A63D88>]}
2020-08-22 15:04:07.892326 (Thread-1): 10:04:07 | 1 of 3 OK created table model dbt_alice.my_first_dbt_model........... [CREATE TABLE (2) in 2.39s]
2020-08-22 15:04:07.893401 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:04:07.893401 (Thread-1): Began running node model.jaffle_shop.customers
2020-08-22 15:04:07.894317 (Thread-1): 10:04:07 | 2 of 3 START view model dbt_alice.customers.......................... [RUN]
2020-08-22 15:04:07.895318 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:04:07.895318 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:04:07.895318 (Thread-1): Compiling model.jaffle_shop.customers
2020-08-22 15:04:07.901328 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-08-22 15:04:07.902319 (Thread-1): finished collecting timing info
2020-08-22 15:04:07.922323 (Thread-1): finished collecting timing info
2020-08-22 15:04:07.922323 (Thread-1): Compilation Error in model customers (models\customers.sql)
  Trying to create view `quick-asset-287211`.`dbt_alice`.`customers`, but it currently exists as a table. Either drop `quick-asset-287211`.`dbt_alice`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro adapter_macro (macros\adapters\common.sql)
  > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model customers (models\customers.sql)
Traceback (most recent call last):
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 29, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\exceptions.py", line 970, in inner
    raise exc
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\exceptions.py", line 967, in inner
    return func(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\exceptions.py", line 638, in relation_wrong_type
    model)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\exceptions.py", line 396, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model customers (models\customers.sql)
  Trying to create view `quick-asset-287211`.`dbt_alice`.`customers`, but it currently exists as a table. Either drop `quick-asset-287211`.`dbt_alice`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro adapter_macro (macros\adapters\common.sql)
  > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model customers (models\customers.sql)
2020-08-22 15:04:07.957340 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51cb05c6-2eba-4f7e-9b04-6759b08bcffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD2AB4C48>]}
2020-08-22 15:04:07.959340 (Thread-1): 10:04:07 | 2 of 3 ERROR creating view model dbt_alice.customers................. [ERROR in 0.06s]
2020-08-22 15:04:07.959762 (Thread-1): Finished running node model.jaffle_shop.customers
2020-08-22 15:04:07.959762 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:04:07.960766 (Thread-1): 10:04:07 | 3 of 3 START view model dbt_alice.my_second_dbt_model................ [RUN]
2020-08-22 15:04:07.961765 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:04:07.961765 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:04:07.961765 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-08-22 15:04:07.969776 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:04:07.970776 (Thread-1): finished collecting timing info
2020-08-22 15:04:07.978779 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:04:07.979779 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
where id = 1;


2020-08-22 15:04:08.186154 (Thread-1): unclosed <socket.socket fd=804, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64638), raddr=('172.217.9.10', 443)>
2020-08-22 15:04:08.186154 (Thread-1): unclosed <socket.socket fd=836, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64637), raddr=('172.217.1.138', 443)>
2020-08-22 15:04:08.966893 (Thread-1): finished collecting timing info
2020-08-22 15:04:08.966893 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51cb05c6-2eba-4f7e-9b04-6759b08bcffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD2CE91C8>]}
2020-08-22 15:04:08.967893 (Thread-1): 10:04:08 | 3 of 3 OK created view model dbt_alice.my_second_dbt_model........... [CREATE VIEW in 1.01s]
2020-08-22 15:04:08.968970 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:04:09.008291 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:04:09.008291 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:04:09.009303 (MainThread): 10:04:09 | 
2020-08-22 15:04:09.009635 (MainThread): 10:04:09 | Finished running 1 table model, 2 view models in 4.23s.
2020-08-22 15:04:09.010638 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:04:09.010638 (MainThread): Connection 'list_quick-asset-287211' was properly closed.
2020-08-22 15:04:09.010638 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:04:09.010638 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2020-08-22 15:04:09.020640 (MainThread): 
2020-08-22 15:04:09.020640 (MainThread): Completed with 1 error and 0 warnings:
2020-08-22 15:04:09.021639 (MainThread): 
2020-08-22 15:04:09.021639 (MainThread): Compilation Error in model customers (models\customers.sql)
2020-08-22 15:04:09.022640 (MainThread):   Trying to create view `quick-asset-287211`.`dbt_alice`.`customers`, but it currently exists as a table. Either drop `quick-asset-287211`.`dbt_alice`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
2020-08-22 15:04:09.022640 (MainThread):   
2020-08-22 15:04:09.022640 (MainThread):   > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
2020-08-22 15:04:09.023639 (MainThread):   > called by macro adapter_macro (macros\adapters\common.sql)
2020-08-22 15:04:09.025641 (MainThread):   > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
2020-08-22 15:04:09.025641 (MainThread):   > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
2020-08-22 15:04:09.026641 (MainThread):   > called by macro materialization_view_bigquery (macros\materializations\view.sql)
2020-08-22 15:04:09.026641 (MainThread):   > called by model customers (models\customers.sql)
2020-08-22 15:04:09.027641 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2020-08-22 15:04:09.027641 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD2BCC108>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD2AA2388>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD2C36288>]}
2020-08-22 15:04:09.027641 (MainThread): Flushing usage events
2020-08-22 15:04:23.413456 (MainThread): Running with dbt=0.17.2
2020-08-22 15:04:23.744821 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 15:04:23.745828 (MainThread): Tracking: tracking
2020-08-22 15:04:23.746830 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F44EF2D48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F44F1B748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F44F1BC48>]}
2020-08-22 15:04:23.796839 (MainThread): Partial parsing not enabled
2020-08-22 15:04:23.800840 (MainThread): Parsing macros\core.sql
2020-08-22 15:04:23.806834 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:04:23.868848 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:04:23.880858 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:04:23.881850 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:04:23.883850 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:04:23.886850 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:04:23.888851 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:04:23.890852 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:04:23.900854 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:04:23.918867 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:04:23.921859 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:04:23.930867 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:04:23.958868 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:04:23.995875 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:04:23.998877 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:04:24.020882 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:04:24.029883 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:04:24.036886 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:04:24.045887 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:04:24.048887 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:04:24.049887 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:04:24.051888 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:04:24.053889 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:04:24.074893 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:04:24.082895 (MainThread): Parsing macros\etc.sql
2020-08-22 15:04:24.083895 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:04:24.100909 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:04:24.104902 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:04:24.106900 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:04:24.120904 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:04:24.147910 (MainThread): Partial parsing not enabled
2020-08-22 15:04:24.189928 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:04:24.189928 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:04:24.221927 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:04:24.221927 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:04:24.235938 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:04:24.235938 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:04:24.483986 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:04:24.484995 (MainThread): 
2020-08-22 15:04:24.485985 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:04:24.485985 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:04:24.490987 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211".
2020-08-22 15:04:24.490987 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 15:04:24.856381 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:04:24.856381 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:04:24.857382 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:04:25.156219 (MainThread): 10:04:25 | Concurrency: 1 threads (target='dev')
2020-08-22 15:04:25.156219 (MainThread): 10:04:25 | 
2020-08-22 15:04:25.159324 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:04:25.160328 (Thread-1): 10:04:25 | 1 of 3 START table model dbt_alice.my_first_dbt_model................ [RUN]
2020-08-22 15:04:25.161327 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:04:25.161327 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:04:25.161327 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-08-22 15:04:25.181341 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:04:25.182341 (Thread-1): finished collecting timing info
2020-08-22 15:04:25.209347 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:04:25.581249 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:04:25.582250 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-08-22 15:04:27.360673 (Thread-1): finished collecting timing info
2020-08-22 15:04:27.360673 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96c449b3-9119-44e9-b40f-434fb7fa0356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F450B2908>]}
2020-08-22 15:04:27.362683 (Thread-1): 10:04:27 | 1 of 3 OK created table model dbt_alice.my_first_dbt_model........... [CREATE TABLE (2) in 2.20s]
2020-08-22 15:04:27.362946 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:04:27.362946 (Thread-1): Began running node model.jaffle_shop.customers
2020-08-22 15:04:27.364950 (Thread-1): 10:04:27 | 2 of 3 START view model dbt_alice.customers.......................... [RUN]
2020-08-22 15:04:27.364950 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:04:27.364950 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:04:27.364950 (Thread-1): Compiling model.jaffle_shop.customers
2020-08-22 15:04:27.370951 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-08-22 15:04:27.371960 (Thread-1): finished collecting timing info
2020-08-22 15:04:27.391964 (Thread-1): finished collecting timing info
2020-08-22 15:04:27.392964 (Thread-1): Compilation Error in model customers (models\customers.sql)
  Trying to create view `quick-asset-287211`.`dbt_alice`.`customers`, but it currently exists as a table. Either drop `quick-asset-287211`.`dbt_alice`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro adapter_macro (macros\adapters\common.sql)
  > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model customers (models\customers.sql)
Traceback (most recent call last):
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 29, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\exceptions.py", line 970, in inner
    raise exc
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\exceptions.py", line 967, in inner
    return func(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\exceptions.py", line 638, in relation_wrong_type
    model)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\exceptions.py", line 396, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model customers (models\customers.sql)
  Trying to create view `quick-asset-287211`.`dbt_alice`.`customers`, but it currently exists as a table. Either drop `quick-asset-287211`.`dbt_alice`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro adapter_macro (macros\adapters\common.sql)
  > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model customers (models\customers.sql)
2020-08-22 15:04:27.394965 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96c449b3-9119-44e9-b40f-434fb7fa0356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F450C8108>]}
2020-08-22 15:04:27.395965 (Thread-1): 10:04:27 | 2 of 3 ERROR creating view model dbt_alice.customers................. [ERROR in 0.03s]
2020-08-22 15:04:27.396956 (Thread-1): Finished running node model.jaffle_shop.customers
2020-08-22 15:04:27.396956 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:04:27.397966 (Thread-1): 10:04:27 | 3 of 3 START view model dbt_alice.my_second_dbt_model................ [RUN]
2020-08-22 15:04:27.397966 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:04:27.397966 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:04:27.397966 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-08-22 15:04:27.406968 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:04:27.407959 (Thread-1): finished collecting timing info
2020-08-22 15:04:27.415969 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:04:27.416961 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
where id = 1;


2020-08-22 15:04:27.595066 (Thread-1): unclosed <socket.socket fd=660, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64649), raddr=('172.217.9.10', 443)>
2020-08-22 15:04:27.595066 (Thread-1): unclosed <socket.socket fd=764, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64648), raddr=('172.217.1.138', 443)>
2020-08-22 15:04:28.167346 (Thread-1): finished collecting timing info
2020-08-22 15:04:28.167346 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96c449b3-9119-44e9-b40f-434fb7fa0356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4512D388>]}
2020-08-22 15:04:28.169346 (Thread-1): 10:04:28 | 3 of 3 OK created view model dbt_alice.my_second_dbt_model........... [CREATE VIEW in 0.77s]
2020-08-22 15:04:28.169578 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:04:28.238993 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:04:28.238993 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:04:28.239998 (MainThread): 10:04:28 | 
2020-08-22 15:04:28.239998 (MainThread): 10:04:28 | Finished running 1 table model, 2 view models in 3.76s.
2020-08-22 15:04:28.241006 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:04:28.241006 (MainThread): Connection 'list_quick-asset-287211' was properly closed.
2020-08-22 15:04:28.241006 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:04:28.241006 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2020-08-22 15:04:28.251009 (MainThread): 
2020-08-22 15:04:28.252000 (MainThread): Completed with 1 error and 0 warnings:
2020-08-22 15:04:28.252000 (MainThread): 
2020-08-22 15:04:28.253000 (MainThread): Compilation Error in model customers (models\customers.sql)
2020-08-22 15:04:28.253000 (MainThread):   Trying to create view `quick-asset-287211`.`dbt_alice`.`customers`, but it currently exists as a table. Either drop `quick-asset-287211`.`dbt_alice`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
2020-08-22 15:04:28.254000 (MainThread):   
2020-08-22 15:04:28.254000 (MainThread):   > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
2020-08-22 15:04:28.254000 (MainThread):   > called by macro adapter_macro (macros\adapters\common.sql)
2020-08-22 15:04:28.255001 (MainThread):   > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
2020-08-22 15:04:28.257001 (MainThread):   > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
2020-08-22 15:04:28.257001 (MainThread):   > called by macro materialization_view_bigquery (macros\materializations\view.sql)
2020-08-22 15:04:28.258001 (MainThread):   > called by model customers (models\customers.sql)
2020-08-22 15:04:28.258001 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2020-08-22 15:04:28.259001 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F451B4208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F451B4248>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F45120E88>]}
2020-08-22 15:04:28.259001 (MainThread): Flushing usage events
2020-08-22 15:05:35.111453 (MainThread): Running with dbt=0.17.2
2020-08-22 15:05:35.433067 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 15:05:35.434068 (MainThread): Tracking: tracking
2020-08-22 15:05:35.434068 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B90B52BC08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B90B52B9C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B90B52B848>]}
2020-08-22 15:05:35.484070 (MainThread): Partial parsing not enabled
2020-08-22 15:05:35.488070 (MainThread): Parsing macros\core.sql
2020-08-22 15:05:35.494081 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:05:35.558096 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:05:35.570098 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:05:35.571099 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:05:35.573099 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:05:35.576099 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:05:35.578091 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:05:35.579100 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:05:35.589102 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:05:35.607106 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:05:35.610108 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:05:35.618109 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:05:35.646115 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:05:35.683124 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:05:35.686124 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:05:35.707120 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:05:35.717131 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:05:35.723123 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:05:35.732126 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:05:35.735135 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:05:35.736136 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:05:35.738136 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:05:35.740127 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:05:35.762133 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:05:35.770135 (MainThread): Parsing macros\etc.sql
2020-08-22 15:05:35.771135 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:05:35.789139 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:05:35.792228 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:05:35.795140 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:05:35.808146 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:05:35.835149 (MainThread): Partial parsing not enabled
2020-08-22 15:05:35.884169 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:05:35.884169 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:05:35.917167 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:05:35.917167 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:05:35.931180 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:05:35.931180 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:05:36.180236 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:05:36.181227 (MainThread): 
2020-08-22 15:05:36.182228 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:05:36.182228 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:05:36.187237 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211".
2020-08-22 15:05:36.187237 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 15:05:36.505520 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:05:36.505520 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:05:36.506524 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:05:36.835511 (MainThread): 10:05:36 | Concurrency: 1 threads (target='dev')
2020-08-22 15:05:36.836511 (MainThread): 10:05:36 | 
2020-08-22 15:05:36.839503 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:05:36.840512 (Thread-1): 10:05:36 | 1 of 3 START table model dbt_alice.my_first_dbt_model................ [RUN]
2020-08-22 15:05:36.841512 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:05:36.841512 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:05:36.841512 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-08-22 15:05:36.862517 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:05:36.863517 (Thread-1): finished collecting timing info
2020-08-22 15:05:36.899526 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:05:37.248705 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:05:37.249705 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-08-22 15:05:38.935208 (Thread-1): finished collecting timing info
2020-08-22 15:05:38.936208 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ae5206d-2353-480a-a91c-7e4b1494b0ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B90B7B3608>]}
2020-08-22 15:05:38.937209 (Thread-1): 10:05:38 | 1 of 3 OK created table model dbt_alice.my_first_dbt_model........... [CREATE TABLE (2) in 2.09s]
2020-08-22 15:05:38.938209 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:05:38.938209 (Thread-1): Began running node model.jaffle_shop.customers
2020-08-22 15:05:38.939209 (Thread-1): 10:05:38 | 2 of 3 START view model dbt_alice.customers.......................... [RUN]
2020-08-22 15:05:38.940210 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:05:38.940210 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:05:38.940210 (Thread-1): Compiling model.jaffle_shop.customers
2020-08-22 15:05:38.946211 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-08-22 15:05:38.947211 (Thread-1): finished collecting timing info
2020-08-22 15:05:38.969217 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-08-22 15:05:38.971217 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2020-08-22 15:05:39.840114 (Thread-1): finished collecting timing info
2020-08-22 15:05:39.841115 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ae5206d-2353-480a-a91c-7e4b1494b0ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B90B6C9408>]}
2020-08-22 15:05:39.842115 (Thread-1): 10:05:39 | 2 of 3 OK created view model dbt_alice.customers..................... [CREATE VIEW in 0.90s]
2020-08-22 15:05:39.843115 (Thread-1): Finished running node model.jaffle_shop.customers
2020-08-22 15:05:39.843115 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:05:39.844115 (Thread-1): 10:05:39 | 3 of 3 START view model dbt_alice.my_second_dbt_model................ [RUN]
2020-08-22 15:05:39.845115 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:05:39.845115 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:05:39.845115 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-08-22 15:05:39.853126 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:05:39.854117 (Thread-1): finished collecting timing info
2020-08-22 15:05:39.858119 (Thread-1): unclosed <socket.socket fd=972, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64674), raddr=('172.217.9.10', 443)>
2020-08-22 15:05:39.858119 (Thread-1): unclosed <socket.socket fd=368, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64673), raddr=('172.217.1.138', 443)>
2020-08-22 15:05:39.859119 (Thread-1): unclosed <socket.socket fd=1100, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64676), raddr=('172.217.9.10', 443)>
2020-08-22 15:05:39.859119 (Thread-1): unclosed <socket.socket fd=1096, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64675), raddr=('172.217.1.138', 443)>
2020-08-22 15:05:39.861128 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:05:39.862120 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
where id = 1;


2020-08-22 15:05:40.778503 (Thread-1): finished collecting timing info
2020-08-22 15:05:40.778503 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ae5206d-2353-480a-a91c-7e4b1494b0ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B90B7C7908>]}
2020-08-22 15:05:40.779503 (Thread-1): 10:05:40 | 3 of 3 OK created view model dbt_alice.my_second_dbt_model........... [CREATE VIEW in 0.93s]
2020-08-22 15:05:40.782495 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:05:40.889462 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:05:40.889462 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:05:40.890454 (MainThread): 10:05:40 | 
2020-08-22 15:05:40.890454 (MainThread): 10:05:40 | Finished running 1 table model, 2 view models in 4.71s.
2020-08-22 15:05:40.891454 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:05:40.891454 (MainThread): Connection 'list_quick-asset-287211' was properly closed.
2020-08-22 15:05:40.891454 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:05:40.891454 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2020-08-22 15:05:40.901456 (MainThread): 
2020-08-22 15:05:40.902457 (MainThread): Completed successfully
2020-08-22 15:05:40.902457 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-08-22 15:05:40.903457 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B90B93CB08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B90B882B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B90B9B4E08>]}
2020-08-22 15:05:40.903457 (MainThread): Flushing usage events
2020-08-22 15:06:21.373503 (MainThread): Running with dbt=0.17.2
2020-08-22 15:06:21.696954 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 15:06:21.697955 (MainThread): Tracking: tracking
2020-08-22 15:06:21.697955 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C661BC748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C66193648>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C66193508>]}
2020-08-22 15:06:21.747965 (MainThread): Partial parsing not enabled
2020-08-22 15:06:21.750967 (MainThread): Parsing macros\core.sql
2020-08-22 15:06:21.756968 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:06:21.821982 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:06:21.834986 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:06:21.835986 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:06:21.838986 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:06:21.841987 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:06:21.843979 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:06:21.845979 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:06:21.857981 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:06:21.876985 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:06:21.879986 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:06:21.888988 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:06:21.916994 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:06:21.954002 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:06:21.957003 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:06:21.979018 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:06:21.988019 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:06:21.994021 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:06:22.003023 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:06:22.006024 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:06:22.007024 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:06:22.009024 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:06:22.011025 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:06:22.033030 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:06:22.041032 (MainThread): Parsing macros\etc.sql
2020-08-22 15:06:22.042032 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:06:22.059036 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:06:22.063036 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:06:22.065037 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:06:22.079031 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:06:22.105046 (MainThread): Partial parsing not enabled
2020-08-22 15:06:22.150056 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:06:22.150056 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:06:22.187056 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:06:22.187056 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:06:22.201068 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:06:22.201068 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:06:22.450125 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:06:22.451114 (MainThread): 
2020-08-22 15:06:22.452116 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:06:22.452116 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:06:22.457117 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211".
2020-08-22 15:06:22.458117 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 15:06:22.805558 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:06:22.805558 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:06:22.806561 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:06:23.158928 (MainThread): 10:06:23 | Concurrency: 1 threads (target='dev')
2020-08-22 15:06:23.158928 (MainThread): 10:06:23 | 
2020-08-22 15:06:23.162920 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:06:23.163929 (Thread-1): 10:06:23 | 1 of 3 START table model dbt_alice.my_first_dbt_model................ [RUN]
2020-08-22 15:06:23.164472 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:06:23.164472 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:06:23.164472 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-08-22 15:06:23.185480 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:06:23.186489 (Thread-1): finished collecting timing info
2020-08-22 15:06:23.213495 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:06:23.570974 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:06:23.571975 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-08-22 15:06:25.232039 (Thread-1): finished collecting timing info
2020-08-22 15:06:25.232039 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '662c6415-10e1-47e9-a42b-737b50d3bcf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C663B6E48>]}
2020-08-22 15:06:25.234039 (Thread-1): 10:06:25 | 1 of 3 OK created table model dbt_alice.my_first_dbt_model........... [CREATE TABLE (2) in 2.07s]
2020-08-22 15:06:25.234039 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:06:25.234039 (Thread-1): Began running node model.jaffle_shop.customers
2020-08-22 15:06:25.236040 (Thread-1): 10:06:25 | 2 of 3 START table model dbt_alice.customers......................... [RUN]
2020-08-22 15:06:25.236040 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:06:25.236040 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:06:25.236040 (Thread-1): Compiling model.jaffle_shop.customers
2020-08-22 15:06:25.242041 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-08-22 15:06:25.243041 (Thread-1): finished collecting timing info
2020-08-22 15:06:25.247042 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:06:25.647123 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:06:25.767451 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-08-22 15:06:25.768451 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2020-08-22 15:06:28.440515 (Thread-1): finished collecting timing info
2020-08-22 15:06:28.441517 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '662c6415-10e1-47e9-a42b-737b50d3bcf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C66453E48>]}
2020-08-22 15:06:28.442517 (Thread-1): 10:06:28 | 2 of 3 OK created table model dbt_alice.customers.................... [CREATE TABLE (100) in 3.20s]
2020-08-22 15:06:28.442517 (Thread-1): Finished running node model.jaffle_shop.customers
2020-08-22 15:06:28.443508 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:06:28.444507 (Thread-1): 10:06:28 | 3 of 3 START view model dbt_alice.my_second_dbt_model................ [RUN]
2020-08-22 15:06:28.444507 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:06:28.444507 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:06:28.444507 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-08-22 15:06:28.453519 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:06:28.453519 (Thread-1): finished collecting timing info
2020-08-22 15:06:28.462521 (Thread-1): unclosed <socket.socket fd=792, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64694), raddr=('172.217.9.10', 443)>
2020-08-22 15:06:28.462521 (Thread-1): unclosed <socket.socket fd=472, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64693), raddr=('172.217.1.138', 443)>
2020-08-22 15:06:28.463641 (Thread-1): unclosed <socket.socket fd=1088, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64697), raddr=('172.217.9.10', 443)>
2020-08-22 15:06:28.463641 (Thread-1): unclosed <socket.socket fd=1076, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64696), raddr=('172.217.1.138', 443)>
2020-08-22 15:06:28.476524 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:06:28.477524 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
where id = 1;


2020-08-22 15:06:29.241028 (Thread-1): finished collecting timing info
2020-08-22 15:06:29.241028 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '662c6415-10e1-47e9-a42b-737b50d3bcf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C664E3C48>]}
2020-08-22 15:06:29.242029 (Thread-1): 10:06:29 | 3 of 3 OK created view model dbt_alice.my_second_dbt_model........... [CREATE VIEW in 0.80s]
2020-08-22 15:06:29.243030 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:06:29.307099 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:06:29.307099 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:06:29.308110 (MainThread): 10:06:29 | 
2020-08-22 15:06:29.308110 (MainThread): 10:06:29 | Finished running 2 table models, 1 view model in 6.85s.
2020-08-22 15:06:29.309111 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:06:29.309111 (MainThread): Connection 'list_quick-asset-287211' was properly closed.
2020-08-22 15:06:29.309111 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:06:29.309111 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2020-08-22 15:06:29.319112 (MainThread): 
2020-08-22 15:06:29.319112 (MainThread): Completed successfully
2020-08-22 15:06:29.320104 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-08-22 15:06:29.320104 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C664EEE88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C66453348>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C66345CC8>]}
2020-08-22 15:06:29.321104 (MainThread): Flushing usage events
2020-08-22 15:07:48.657887 (MainThread): Running with dbt=0.17.2
2020-08-22 15:07:48.991954 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 15:07:48.991954 (MainThread): Tracking: tracking
2020-08-22 15:07:48.992954 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A5BBB788>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A5BBB748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A5BBD908>]}
2020-08-22 15:07:49.046975 (MainThread): Partial parsing not enabled
2020-08-22 15:07:49.049976 (MainThread): Parsing macros\core.sql
2020-08-22 15:07:49.055977 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:07:49.119991 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:07:49.131994 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:07:49.132994 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:07:49.134995 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:07:49.136995 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:07:49.139996 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:07:49.140996 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:07:49.150998 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:07:49.169994 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:07:49.173003 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:07:49.180997 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:07:49.209012 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:07:49.248020 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:07:49.250021 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:07:49.272026 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:07:49.282029 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:07:49.288029 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:07:49.297031 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:07:49.300032 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:07:49.301033 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:07:49.302033 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:07:49.304033 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:07:49.325038 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:07:49.333039 (MainThread): Parsing macros\etc.sql
2020-08-22 15:07:49.334039 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:07:49.350043 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:07:49.354044 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:07:49.356045 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:07:49.370039 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:07:49.395053 (MainThread): Partial parsing not enabled
2020-08-22 15:07:49.438055 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:07:49.438055 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:07:49.472063 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:07:49.472063 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:07:49.486066 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:07:49.486066 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:07:49.736130 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:07:49.737122 (MainThread): 
2020-08-22 15:07:49.738122 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:07:49.738122 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:07:49.743132 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211".
2020-08-22 15:07:49.744124 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 15:07:50.100401 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:07:50.100401 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:07:50.101404 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:07:50.413534 (MainThread): 10:07:50 | Concurrency: 1 threads (target='dev')
2020-08-22 15:07:50.414046 (MainThread): 10:07:50 | 
2020-08-22 15:07:50.417049 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:07:50.418049 (Thread-1): 10:07:50 | 1 of 3 START table model dbt_alice.my_first_dbt_model................ [RUN]
2020-08-22 15:07:50.419055 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:07:50.419055 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:07:50.419055 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-08-22 15:07:50.440064 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:07:50.440064 (Thread-1): finished collecting timing info
2020-08-22 15:07:50.467070 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:07:50.833187 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:07:50.834212 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-08-22 15:07:52.618304 (Thread-1): finished collecting timing info
2020-08-22 15:07:52.619304 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b37fb03-b9d3-43b2-9f9d-abd4f2bdf48f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A5E59108>]}
2020-08-22 15:07:52.620304 (Thread-1): 10:07:52 | 1 of 3 OK created table model dbt_alice.my_first_dbt_model........... [CREATE TABLE (2) in 2.20s]
2020-08-22 15:07:52.620304 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:07:52.621305 (Thread-1): Began running node model.jaffle_shop.customers
2020-08-22 15:07:52.622305 (Thread-1): 10:07:52 | 2 of 3 START view model dbt_alice.customers.......................... [RUN]
2020-08-22 15:07:52.622644 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:07:52.622644 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:07:52.622644 (Thread-1): Compiling model.jaffle_shop.customers
2020-08-22 15:07:52.629657 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-08-22 15:07:52.630690 (Thread-1): finished collecting timing info
2020-08-22 15:07:52.650653 (Thread-1): finished collecting timing info
2020-08-22 15:07:52.650653 (Thread-1): Compilation Error in model customers (models\customers.sql)
  Trying to create view `quick-asset-287211`.`dbt_alice`.`customers`, but it currently exists as a table. Either drop `quick-asset-287211`.`dbt_alice`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro adapter_macro (macros\adapters\common.sql)
  > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model customers (models\customers.sql)
Traceback (most recent call last):
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 29, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\exceptions.py", line 970, in inner
    raise exc
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\exceptions.py", line 967, in inner
    return func(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\exceptions.py", line 638, in relation_wrong_type
    model)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\exceptions.py", line 396, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model customers (models\customers.sql)
  Trying to create view `quick-asset-287211`.`dbt_alice`.`customers`, but it currently exists as a table. Either drop `quick-asset-287211`.`dbt_alice`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro adapter_macro (macros\adapters\common.sql)
  > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model customers (models\customers.sql)
2020-08-22 15:07:52.652662 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b37fb03-b9d3-43b2-9f9d-abd4f2bdf48f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A5DA7448>]}
2020-08-22 15:07:52.653662 (Thread-1): 10:07:52 | 2 of 3 ERROR creating view model dbt_alice.customers................. [ERROR in 0.03s]
2020-08-22 15:07:52.654654 (Thread-1): Finished running node model.jaffle_shop.customers
2020-08-22 15:07:52.654654 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:07:52.655654 (Thread-1): 10:07:52 | 3 of 3 START view model dbt_alice.my_second_dbt_model................ [RUN]
2020-08-22 15:07:52.655654 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:07:52.656654 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:07:52.656654 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-08-22 15:07:52.664664 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:07:52.665657 (Thread-1): finished collecting timing info
2020-08-22 15:07:52.668666 (Thread-1): unclosed <socket.socket fd=848, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64719), raddr=('172.217.9.10', 443)>
2020-08-22 15:07:52.668666 (Thread-1): unclosed <socket.socket fd=484, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64718), raddr=('172.217.9.138', 443)>
2020-08-22 15:07:52.675668 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:07:52.676659 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
where id = 1;


2020-08-22 15:07:53.607995 (Thread-1): finished collecting timing info
2020-08-22 15:07:53.607995 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b37fb03-b9d3-43b2-9f9d-abd4f2bdf48f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A5E6AFC8>]}
2020-08-22 15:07:53.608995 (Thread-1): 10:07:53 | 3 of 3 OK created view model dbt_alice.my_second_dbt_model........... [CREATE VIEW in 0.95s]
2020-08-22 15:07:53.610039 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:07:53.693254 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:07:53.693254 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:07:53.694257 (MainThread): 10:07:53 | 
2020-08-22 15:07:53.694561 (MainThread): 10:07:53 | Finished running 1 table model, 2 view models in 3.96s.
2020-08-22 15:07:53.695567 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:07:53.695567 (MainThread): Connection 'list_quick-asset-287211' was properly closed.
2020-08-22 15:07:53.695567 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:07:53.695567 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2020-08-22 15:07:53.705640 (MainThread): 
2020-08-22 15:07:53.705640 (MainThread): Completed with 1 error and 0 warnings:
2020-08-22 15:07:53.706566 (MainThread): 
2020-08-22 15:07:53.706566 (MainThread): Compilation Error in model customers (models\customers.sql)
2020-08-22 15:07:53.707567 (MainThread):   Trying to create view `quick-asset-287211`.`dbt_alice`.`customers`, but it currently exists as a table. Either drop `quick-asset-287211`.`dbt_alice`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
2020-08-22 15:07:53.707567 (MainThread):   
2020-08-22 15:07:53.707567 (MainThread):   > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
2020-08-22 15:07:53.708567 (MainThread):   > called by macro adapter_macro (macros\adapters\common.sql)
2020-08-22 15:07:53.710568 (MainThread):   > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
2020-08-22 15:07:53.710568 (MainThread):   > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
2020-08-22 15:07:53.711568 (MainThread):   > called by macro materialization_view_bigquery (macros\materializations\view.sql)
2020-08-22 15:07:53.711568 (MainThread):   > called by model customers (models\customers.sql)
2020-08-22 15:07:53.712568 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2020-08-22 15:07:53.712568 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A5E77648>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A5D429C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A5EF0D88>]}
2020-08-22 15:07:53.713568 (MainThread): Flushing usage events
2020-08-22 15:08:07.085106 (MainThread): Running with dbt=0.17.2
2020-08-22 15:08:07.405187 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 15:08:07.405187 (MainThread): Tracking: tracking
2020-08-22 15:08:07.406189 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021348699648>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021348699D08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021348699C88>]}
2020-08-22 15:08:07.455200 (MainThread): Partial parsing not enabled
2020-08-22 15:08:07.458199 (MainThread): Parsing macros\core.sql
2020-08-22 15:08:07.464191 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:08:07.529216 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:08:07.543218 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:08:07.544209 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:08:07.546219 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:08:07.549220 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:08:07.552220 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:08:07.553221 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:08:07.564223 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:08:07.583227 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:08:07.586228 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:08:07.594229 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:08:07.623412 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:08:07.661244 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:08:07.664236 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:08:07.685249 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:08:07.694252 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:08:07.700253 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:08:07.708255 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:08:07.711255 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:08:07.712256 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:08:07.713256 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:08:07.716257 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:08:07.736261 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:08:07.744263 (MainThread): Parsing macros\etc.sql
2020-08-22 15:08:07.745263 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:08:07.762267 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:08:07.765267 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:08:07.767260 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:08:07.780271 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:08:07.805276 (MainThread): Partial parsing not enabled
2020-08-22 15:08:07.845286 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:08:07.846286 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:08:07.879285 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:08:07.879285 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:08:07.892296 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:08:07.892296 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:08:08.138344 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:08:08.138344 (MainThread): 
2020-08-22 15:08:08.139344 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:08:08.139344 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:08:08.144354 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211".
2020-08-22 15:08:08.144354 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 15:08:08.491078 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:08:08.492001 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:08:08.492001 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:08:08.823515 (MainThread): 10:08:08 | Concurrency: 1 threads (target='dev')
2020-08-22 15:08:08.823515 (MainThread): 10:08:08 | 
2020-08-22 15:08:08.827430 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:08:08.828431 (Thread-1): 10:08:08 | 1 of 3 START table model dbt_alice.my_first_dbt_model................ [RUN]
2020-08-22 15:08:08.828431 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:08:08.828431 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:08:08.828431 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-08-22 15:08:08.849436 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:08:08.850437 (Thread-1): finished collecting timing info
2020-08-22 15:08:08.877442 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:08:09.231530 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:08:09.231530 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-08-22 15:08:11.053105 (Thread-1): finished collecting timing info
2020-08-22 15:08:11.053105 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12247cb8-a628-47b5-9fe8-89143fb40e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134888F8C8>]}
2020-08-22 15:08:11.055106 (Thread-1): 10:08:11 | 1 of 3 OK created table model dbt_alice.my_first_dbt_model........... [CREATE TABLE (2) in 2.22s]
2020-08-22 15:08:11.055106 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:08:11.055106 (Thread-1): Began running node model.jaffle_shop.customers
2020-08-22 15:08:11.057106 (Thread-1): 10:08:11 | 2 of 3 START view model dbt_alice.customers.......................... [RUN]
2020-08-22 15:08:11.057106 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:08:11.057106 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:08:11.057106 (Thread-1): Compiling model.jaffle_shop.customers
2020-08-22 15:08:11.064109 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-08-22 15:08:11.065118 (Thread-1): finished collecting timing info
2020-08-22 15:08:11.085121 (Thread-1): finished collecting timing info
2020-08-22 15:08:11.085121 (Thread-1): Compilation Error in model customers (models\customers.sql)
  Trying to create view `quick-asset-287211`.`dbt_alice`.`customers`, but it currently exists as a table. Either drop `quick-asset-287211`.`dbt_alice`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro adapter_macro (macros\adapters\common.sql)
  > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model customers (models\customers.sql)
Traceback (most recent call last):
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 29, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\exceptions.py", line 970, in inner
    raise exc
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\exceptions.py", line 967, in inner
    return func(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\exceptions.py", line 638, in relation_wrong_type
    model)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\exceptions.py", line 396, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model customers (models\customers.sql)
  Trying to create view `quick-asset-287211`.`dbt_alice`.`customers`, but it currently exists as a table. Either drop `quick-asset-287211`.`dbt_alice`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro adapter_macro (macros\adapters\common.sql)
  > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model customers (models\customers.sql)
2020-08-22 15:08:11.087123 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12247cb8-a628-47b5-9fe8-89143fb40e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213488BD748>]}
2020-08-22 15:08:11.088123 (Thread-1): 10:08:11 | 2 of 3 ERROR creating view model dbt_alice.customers................. [ERROR in 0.03s]
2020-08-22 15:08:11.089123 (Thread-1): Finished running node model.jaffle_shop.customers
2020-08-22 15:08:11.089123 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:08:11.091114 (Thread-1): 10:08:11 | 3 of 3 START view model dbt_alice.my_second_dbt_model................ [RUN]
2020-08-22 15:08:11.091114 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:08:11.091114 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:08:11.091114 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-08-22 15:08:11.099116 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:08:11.100116 (Thread-1): finished collecting timing info
2020-08-22 15:08:11.103117 (Thread-1): unclosed <socket.socket fd=356, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64731), raddr=('172.217.9.10', 443)>
2020-08-22 15:08:11.103117 (Thread-1): unclosed <socket.socket fd=904, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64730), raddr=('172.217.9.138', 443)>
2020-08-22 15:08:11.110118 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:08:11.111118 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
where id = 1;


2020-08-22 15:08:11.802113 (Thread-1): finished collecting timing info
2020-08-22 15:08:11.802113 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12247cb8-a628-47b5-9fe8-89143fb40e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134893BA48>]}
2020-08-22 15:08:11.803113 (Thread-1): 10:08:11 | 3 of 3 OK created view model dbt_alice.my_second_dbt_model........... [CREATE VIEW in 0.71s]
2020-08-22 15:08:11.804065 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:08:11.884035 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:08:11.885039 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:08:11.885039 (MainThread): 10:08:11 | 
2020-08-22 15:08:11.885459 (MainThread): 10:08:11 | Finished running 1 table model, 2 view models in 3.75s.
2020-08-22 15:08:11.886614 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:08:11.886614 (MainThread): Connection 'list_quick-asset-287211' was properly closed.
2020-08-22 15:08:11.886614 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:08:11.886614 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2020-08-22 15:08:11.896627 (MainThread): 
2020-08-22 15:08:11.896627 (MainThread): Completed with 1 error and 0 warnings:
2020-08-22 15:08:11.897619 (MainThread): 
2020-08-22 15:08:11.897619 (MainThread): Compilation Error in model customers (models\customers.sql)
2020-08-22 15:08:11.898628 (MainThread):   Trying to create view `quick-asset-287211`.`dbt_alice`.`customers`, but it currently exists as a table. Either drop `quick-asset-287211`.`dbt_alice`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
2020-08-22 15:08:11.898628 (MainThread):   
2020-08-22 15:08:11.899628 (MainThread):   > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
2020-08-22 15:08:11.901620 (MainThread):   > called by macro adapter_macro (macros\adapters\common.sql)
2020-08-22 15:08:11.901620 (MainThread):   > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
2020-08-22 15:08:11.901620 (MainThread):   > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
2020-08-22 15:08:11.902629 (MainThread):   > called by macro materialization_view_bigquery (macros\materializations\view.sql)
2020-08-22 15:08:11.902629 (MainThread):   > called by model customers (models\customers.sql)
2020-08-22 15:08:11.903620 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2020-08-22 15:08:11.903620 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213489333C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021344B953C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021348AC4848>]}
2020-08-22 15:08:11.904629 (MainThread): Flushing usage events
2020-08-22 15:08:48.953480 (MainThread): Running with dbt=0.17.2
2020-08-22 15:08:49.292060 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 15:08:49.293070 (MainThread): Tracking: tracking
2020-08-22 15:08:49.293070 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF61BB7C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF61BBC48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF61BBBC8>]}
2020-08-22 15:08:49.342081 (MainThread): Partial parsing not enabled
2020-08-22 15:08:49.346083 (MainThread): Parsing macros\core.sql
2020-08-22 15:08:49.352083 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:08:49.417088 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:08:49.429091 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:08:49.430091 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:08:49.432092 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:08:49.435092 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:08:49.437093 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:08:49.439093 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:08:49.449097 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:08:49.468100 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:08:49.471101 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:08:49.481102 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:08:49.509109 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:08:49.548119 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:08:49.550128 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:08:49.572124 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:08:49.581135 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:08:49.588128 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:08:49.596129 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:08:49.599129 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:08:49.600130 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:08:49.602130 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:08:49.604131 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:08:49.625135 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:08:49.634137 (MainThread): Parsing macros\etc.sql
2020-08-22 15:08:49.635138 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:08:49.652141 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:08:49.656142 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:08:49.658143 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:08:49.672146 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:08:49.698152 (MainThread): Partial parsing not enabled
2020-08-22 15:08:49.740170 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:08:49.740170 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:08:49.780170 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:08:49.780170 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:08:49.795174 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:08:49.796174 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:08:50.044239 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:08:50.045230 (MainThread): 
2020-08-22 15:08:50.046231 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:08:50.046231 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:08:50.052232 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211".
2020-08-22 15:08:50.052232 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 15:08:50.351721 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:08:50.351721 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:08:50.351721 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:08:50.699986 (MainThread): 10:08:50 | Concurrency: 1 threads (target='dev')
2020-08-22 15:08:50.699986 (MainThread): 10:08:50 | 
2020-08-22 15:08:50.704422 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:08:50.705425 (Thread-1): 10:08:50 | 1 of 3 START table model dbt_alice.my_first_dbt_model................ [RUN]
2020-08-22 15:08:50.706064 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:08:50.706064 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:08:50.706064 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-08-22 15:08:50.727079 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:08:50.728079 (Thread-1): finished collecting timing info
2020-08-22 15:08:50.755085 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:08:51.084232 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:08:51.085232 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-08-22 15:08:52.708500 (Thread-1): finished collecting timing info
2020-08-22 15:08:52.709500 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd60a4669-f3c5-42cc-b93f-9b7c7d8aa0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF6371548>]}
2020-08-22 15:08:52.710501 (Thread-1): 10:08:52 | 1 of 3 OK created table model dbt_alice.my_first_dbt_model........... [CREATE TABLE (2) in 2.00s]
2020-08-22 15:08:52.711501 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:08:52.711501 (Thread-1): Began running node model.jaffle_shop.customers
2020-08-22 15:08:52.712501 (Thread-1): 10:08:52 | 2 of 3 START view model dbt_alice.customers.......................... [RUN]
2020-08-22 15:08:52.712501 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:08:52.712501 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:08:52.712501 (Thread-1): Compiling model.jaffle_shop.customers
2020-08-22 15:08:52.719503 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-08-22 15:08:52.720503 (Thread-1): finished collecting timing info
2020-08-22 15:08:52.741507 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-08-22 15:08:52.742508 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`customers`
  OPTIONS()
  as 


with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2020-08-22 15:08:53.585942 (Thread-1): finished collecting timing info
2020-08-22 15:08:53.586934 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd60a4669-f3c5-42cc-b93f-9b7c7d8aa0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF63AD748>]}
2020-08-22 15:08:53.586934 (Thread-1): 10:08:53 | 2 of 3 OK created view model dbt_alice.customers..................... [CREATE VIEW in 0.87s]
2020-08-22 15:08:53.588059 (Thread-1): Finished running node model.jaffle_shop.customers
2020-08-22 15:08:53.588059 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:08:53.588943 (Thread-1): 10:08:53 | 3 of 3 START view model dbt_alice.my_second_dbt_model................ [RUN]
2020-08-22 15:08:53.590143 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:08:53.590143 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:08:53.590143 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-08-22 15:08:53.595154 (Thread-1): unclosed <socket.socket fd=972, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64750), raddr=('172.217.9.10', 443)>
2020-08-22 15:08:53.596155 (Thread-1): unclosed <socket.socket fd=460, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64749), raddr=('172.217.9.138', 443)>
2020-08-22 15:08:53.596155 (Thread-1): unclosed <socket.socket fd=1100, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64752), raddr=('172.217.9.10', 443)>
2020-08-22 15:08:53.596155 (Thread-1): unclosed <socket.socket fd=1096, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64751), raddr=('172.217.9.138', 443)>
2020-08-22 15:08:53.600155 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:08:53.600155 (Thread-1): finished collecting timing info
2020-08-22 15:08:53.605148 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:08:53.606149 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
where id = 1;


2020-08-22 15:08:54.563271 (Thread-1): finished collecting timing info
2020-08-22 15:08:54.564271 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd60a4669-f3c5-42cc-b93f-9b7c7d8aa0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF65CFFC8>]}
2020-08-22 15:08:54.565271 (Thread-1): 10:08:54 | 3 of 3 OK created view model dbt_alice.my_second_dbt_model........... [CREATE VIEW in 0.97s]
2020-08-22 15:08:54.565271 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:08:54.639280 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:08:54.640281 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:08:54.640281 (MainThread): 10:08:54 | 
2020-08-22 15:08:54.640281 (MainThread): 10:08:54 | Finished running 1 table model, 2 view models in 4.59s.
2020-08-22 15:08:54.642289 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:08:54.642289 (MainThread): Connection 'list_quick-asset-287211' was properly closed.
2020-08-22 15:08:54.642289 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:08:54.642289 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2020-08-22 15:08:54.652291 (MainThread): 
2020-08-22 15:08:54.653282 (MainThread): Completed successfully
2020-08-22 15:08:54.653282 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-08-22 15:08:54.654282 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF6507B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF65188C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF663AEC8>]}
2020-08-22 15:08:54.654282 (MainThread): Flushing usage events
2020-08-22 15:09:30.640437 (MainThread): Running with dbt=0.17.2
2020-08-22 15:09:30.965764 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 15:09:30.966765 (MainThread): Tracking: tracking
2020-08-22 15:09:30.966765 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193147CB588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193147CB6C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193147CBF08>]}
2020-08-22 15:09:31.020769 (MainThread): Partial parsing not enabled
2020-08-22 15:09:31.024770 (MainThread): Parsing macros\core.sql
2020-08-22 15:09:31.030774 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:09:31.093789 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:09:31.105791 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:09:31.106792 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:09:31.108792 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:09:31.111792 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:09:31.113793 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:09:31.114793 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:09:31.124796 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:09:31.142799 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:09:31.144800 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:09:31.152802 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:09:31.179808 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:09:31.217817 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:09:31.219817 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:09:31.241822 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:09:31.250824 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:09:31.257826 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:09:31.265828 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:09:31.268828 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:09:31.269837 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:09:31.271829 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:09:31.273829 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:09:31.295835 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:09:31.304837 (MainThread): Parsing macros\etc.sql
2020-08-22 15:09:31.305846 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:09:31.322850 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:09:31.326850 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:09:31.328842 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:09:31.342845 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:09:31.370851 (MainThread): Partial parsing not enabled
2020-08-22 15:09:31.413861 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:09:31.413861 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:09:31.447869 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:09:31.447869 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:09:31.460871 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:09:31.461871 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:09:31.718014 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:09:31.718930 (MainThread): 
2020-08-22 15:09:31.718930 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:09:31.719930 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:09:31.724933 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211".
2020-08-22 15:09:31.724933 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 15:09:32.090968 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:09:32.090968 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:09:32.091969 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:09:32.425175 (MainThread): 10:09:32 | Concurrency: 1 threads (target='dev')
2020-08-22 15:09:32.425175 (MainThread): 10:09:32 | 
2020-08-22 15:09:32.429167 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:09:32.430176 (Thread-1): 10:09:32 | 1 of 3 START table model dbt_alice.my_first_dbt_model................ [RUN]
2020-08-22 15:09:32.430176 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:09:32.430176 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:09:32.431167 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-08-22 15:09:32.451171 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:09:32.452181 (Thread-1): finished collecting timing info
2020-08-22 15:09:32.479186 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:09:32.894441 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:09:32.895441 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-08-22 15:09:34.871308 (Thread-1): finished collecting timing info
2020-08-22 15:09:34.872308 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9626e34-4f50-431b-afe7-adf436e713a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019314977B48>]}
2020-08-22 15:09:34.873300 (Thread-1): 10:09:34 | 1 of 3 OK created table model dbt_alice.my_first_dbt_model........... [CREATE TABLE (2) in 2.44s]
2020-08-22 15:09:34.873300 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:09:34.873300 (Thread-1): Began running node model.jaffle_shop.customers
2020-08-22 15:09:34.875310 (Thread-1): 10:09:34 | 2 of 3 START view model dbt_alice.customers.......................... [RUN]
2020-08-22 15:09:34.875660 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:09:34.875660 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:09:34.875660 (Thread-1): Compiling model.jaffle_shop.customers
2020-08-22 15:09:34.882673 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-08-22 15:09:34.883664 (Thread-1): finished collecting timing info
2020-08-22 15:09:34.908933 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-08-22 15:09:34.910670 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`customers`
  OPTIONS()
  as 


with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2020-08-22 15:09:36.042344 (Thread-1): finished collecting timing info
2020-08-22 15:09:36.042344 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9626e34-4f50-431b-afe7-adf436e713a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019314A8EF48>]}
2020-08-22 15:09:36.043344 (Thread-1): 10:09:36 | 2 of 3 OK created view model dbt_alice.customers..................... [CREATE VIEW in 1.17s]
2020-08-22 15:09:36.044344 (Thread-1): Finished running node model.jaffle_shop.customers
2020-08-22 15:09:36.044344 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:09:36.045345 (Thread-1): 10:09:36 | 3 of 3 START view model dbt_alice.my_second_dbt_model................ [RUN]
2020-08-22 15:09:36.046344 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:09:36.046344 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:09:36.046344 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-08-22 15:09:36.051345 (Thread-1): unclosed <socket.socket fd=480, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64769), raddr=('172.217.9.10', 443)>
2020-08-22 15:09:36.052355 (Thread-1): unclosed <socket.socket fd=864, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64768), raddr=('172.217.9.138', 443)>
2020-08-22 15:09:36.052355 (Thread-1): unclosed <socket.socket fd=1096, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64770), raddr=('172.217.9.138', 443)>
2020-08-22 15:09:36.052355 (Thread-1): unclosed <socket.socket fd=1108, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64771), raddr=('172.217.9.10', 443)>
2020-08-22 15:09:36.056346 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:09:36.056346 (Thread-1): finished collecting timing info
2020-08-22 15:09:36.061357 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:09:36.062348 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
where id = 1;


2020-08-22 15:09:36.727377 (Thread-1): finished collecting timing info
2020-08-22 15:09:36.728377 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9626e34-4f50-431b-afe7-adf436e713a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019314A83A48>]}
2020-08-22 15:09:36.729378 (Thread-1): 10:09:36 | 3 of 3 OK created view model dbt_alice.my_second_dbt_model........... [CREATE VIEW in 0.68s]
2020-08-22 15:09:36.729790 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:09:36.833071 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:09:36.833071 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:09:36.834054 (MainThread): 10:09:36 | 
2020-08-22 15:09:36.834054 (MainThread): 10:09:36 | Finished running 1 table model, 2 view models in 5.12s.
2020-08-22 15:09:36.835063 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:09:36.835063 (MainThread): Connection 'list_quick-asset-287211' was properly closed.
2020-08-22 15:09:36.835063 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:09:36.835063 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2020-08-22 15:09:36.845065 (MainThread): 
2020-08-22 15:09:36.845065 (MainThread): Completed successfully
2020-08-22 15:09:36.846057 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-08-22 15:09:36.846057 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019314B3C488>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019314B0C7C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019314BC9B88>]}
2020-08-22 15:09:36.847057 (MainThread): Flushing usage events
2020-08-22 15:15:42.349547 (MainThread): Running with dbt=0.17.2
2020-08-22 15:15:42.671016 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 15:15:42.672017 (MainThread): Tracking: tracking
2020-08-22 15:15:42.673017 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB54FAC848>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB54FAE308>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB54FAE348>]}
2020-08-22 15:15:42.721028 (MainThread): Partial parsing not enabled
2020-08-22 15:15:42.725028 (MainThread): Parsing macros\core.sql
2020-08-22 15:15:42.731030 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:15:42.793044 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:15:42.805047 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:15:42.806047 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:15:42.808048 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:15:42.811049 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:15:42.813049 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:15:42.815049 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:15:42.825052 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:15:42.843056 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:15:42.846047 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:15:42.855049 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:15:42.887057 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:15:42.929066 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:15:42.932067 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:15:42.954073 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:15:42.963074 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:15:42.970075 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:15:42.979077 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:15:42.982079 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:15:42.983078 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:15:42.985088 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:15:42.988079 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:15:43.012094 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:15:43.021087 (MainThread): Parsing macros\etc.sql
2020-08-22 15:15:43.022089 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:15:43.040092 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:15:43.043092 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:15:43.046093 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:15:43.059096 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:15:43.086102 (MainThread): Partial parsing not enabled
2020-08-22 15:15:43.127111 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:15:43.128112 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:15:43.162119 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:15:43.162119 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:15:43.173121 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:15:43.173121 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:15:43.183123 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:15:43.184123 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:15:43.197126 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:15:43.197126 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:15:43.441190 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:15:43.442182 (MainThread): 
2020-08-22 15:15:43.443182 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:15:43.443182 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:15:43.451184 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211".
2020-08-22 15:15:43.451184 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 15:15:43.908913 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:15:43.909913 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:15:43.909913 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:15:44.250990 (MainThread): 10:15:44 | Concurrency: 1 threads (target='dev')
2020-08-22 15:15:44.250990 (MainThread): 10:15:44 | 
2020-08-22 15:15:44.254000 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:15:44.256089 (Thread-1): 10:15:44 | 1 of 5 START table model dbt_alice.my_first_dbt_model................ [RUN]
2020-08-22 15:15:44.256089 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:15:44.256089 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:15:44.256089 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-08-22 15:15:44.276996 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:15:44.277996 (Thread-1): finished collecting timing info
2020-08-22 15:15:44.305272 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:15:44.689765 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:15:44.690765 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-08-22 15:15:46.626705 (Thread-1): finished collecting timing info
2020-08-22 15:15:46.627715 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42976ccb-d18a-413e-9c29-989662285f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB5500BCC8>]}
2020-08-22 15:15:46.628715 (Thread-1): 10:15:46 | 1 of 5 OK created table model dbt_alice.my_first_dbt_model........... [CREATE TABLE (2) in 2.37s]
2020-08-22 15:15:46.629510 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:15:46.629510 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-08-22 15:15:46.630515 (Thread-1): 10:15:46 | 2 of 5 START table model dbt_alice.stg_customers..................... [RUN]
2020-08-22 15:15:46.631513 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:15:46.631513 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:15:46.631513 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-08-22 15:15:46.636515 (Thread-1): unclosed <socket.socket fd=1020, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64873), raddr=('216.58.194.74', 443)>
2020-08-22 15:15:46.636515 (Thread-1): unclosed <socket.socket fd=1008, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64872), raddr=('172.217.9.138', 443)>
2020-08-22 15:15:46.637525 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-08-22 15:15:46.638525 (Thread-1): finished collecting timing info
2020-08-22 15:15:46.643526 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2020-08-22 15:15:46.644517 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`stg_customers`
  
  
  OPTIONS()
  as (
    select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers
  );
    
2020-08-22 15:15:49.359488 (Thread-1): finished collecting timing info
2020-08-22 15:15:49.360479 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42976ccb-d18a-413e-9c29-989662285f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB551AF388>]}
2020-08-22 15:15:49.361489 (Thread-1): 10:15:49 | 2 of 5 OK created table model dbt_alice.stg_customers................ [CREATE TABLE (100) in 2.73s]
2020-08-22 15:15:49.362489 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-08-22 15:15:49.362489 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-08-22 15:15:49.363489 (Thread-1): 10:15:49 | 3 of 5 START table model dbt_alice.stg_orders........................ [RUN]
2020-08-22 15:15:49.364489 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:15:49.364489 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:15:49.364489 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-08-22 15:15:49.370482 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:15:49.371492 (Thread-1): finished collecting timing info
2020-08-22 15:15:49.376492 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:15:49.377484 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`stg_orders`
  
  
  OPTIONS()
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders
  );
    
2020-08-22 15:15:52.222866 (Thread-1): finished collecting timing info
2020-08-22 15:15:52.222866 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42976ccb-d18a-413e-9c29-989662285f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB55241D08>]}
2020-08-22 15:15:52.223857 (Thread-1): 10:15:52 | 3 of 5 OK created table model dbt_alice.stg_orders................... [CREATE TABLE (99) in 2.86s]
2020-08-22 15:15:52.224866 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-08-22 15:15:52.224866 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:15:52.226867 (Thread-1): 10:15:52 | 4 of 5 START view model dbt_alice.my_second_dbt_model................ [RUN]
2020-08-22 15:15:52.227059 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:15:52.227059 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:15:52.227059 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-08-22 15:15:52.235073 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:15:52.236072 (Thread-1): finished collecting timing info
2020-08-22 15:15:52.257078 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:15:52.258077 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
where id = 1;


2020-08-22 15:15:53.062766 (Thread-1): finished collecting timing info
2020-08-22 15:15:53.063766 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42976ccb-d18a-413e-9c29-989662285f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB552DEB08>]}
2020-08-22 15:15:53.064767 (Thread-1): 10:15:53 | 4 of 5 OK created view model dbt_alice.my_second_dbt_model........... [CREATE VIEW in 0.84s]
2020-08-22 15:15:53.065156 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:15:53.065156 (Thread-1): Began running node model.jaffle_shop.customers
2020-08-22 15:15:53.066160 (Thread-1): 10:15:53 | 5 of 5 START table model dbt_alice.customers......................... [RUN]
2020-08-22 15:15:53.066160 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:15:53.067159 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:15:53.067159 (Thread-1): Compiling model.jaffle_shop.customers
2020-08-22 15:15:53.076170 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-08-22 15:15:53.077160 (Thread-1): finished collecting timing info
2020-08-22 15:15:53.081171 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:15:53.421272 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:15:53.540767 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-08-22 15:15:53.541794 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select * from `quick-asset-287211`.`dbt_alice`.`stg_customers`

),

orders as (

    select * from `quick-asset-287211`.`dbt_alice`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2020-08-22 15:15:55.579293 (Thread-1): finished collecting timing info
2020-08-22 15:15:55.579293 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42976ccb-d18a-413e-9c29-989662285f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB553BBAC8>]}
2020-08-22 15:15:55.580293 (Thread-1): 10:15:55 | 5 of 5 OK created table model dbt_alice.customers.................... [CREATE TABLE (100) in 2.51s]
2020-08-22 15:15:55.581296 (Thread-1): Finished running node model.jaffle_shop.customers
2020-08-22 15:15:55.646827 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:15:55.646827 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:15:55.647829 (MainThread): 10:15:55 | 
2020-08-22 15:15:55.647829 (MainThread): 10:15:55 | Finished running 4 table models, 1 view model in 12.20s.
2020-08-22 15:15:55.648828 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:15:55.648828 (MainThread): Connection 'list_quick-asset-287211' was properly closed.
2020-08-22 15:15:55.649391 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:15:55.649391 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2020-08-22 15:15:55.664833 (MainThread): 
2020-08-22 15:15:55.664833 (MainThread): Completed successfully
2020-08-22 15:15:55.665832 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2020-08-22 15:15:55.665832 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB55431B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB554319C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB552CFBC8>]}
2020-08-22 15:15:55.665832 (MainThread): Flushing usage events
2020-08-22 15:17:29.053788 (MainThread): Running with dbt=0.17.2
2020-08-22 15:17:29.370217 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 15:17:29.371217 (MainThread): Tracking: tracking
2020-08-22 15:17:29.371217 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211359ABD08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211359AD408>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211359AD108>]}
2020-08-22 15:17:29.419228 (MainThread): Partial parsing not enabled
2020-08-22 15:17:29.423229 (MainThread): Parsing macros\core.sql
2020-08-22 15:17:29.429230 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:17:29.492245 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:17:29.505248 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:17:29.506248 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:17:29.508248 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:17:29.511249 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:17:29.513249 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:17:29.515250 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:17:29.526252 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:17:29.545257 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:17:29.548257 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:17:29.557260 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:17:29.585266 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:17:29.623275 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:17:29.625275 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:17:29.648271 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:17:29.657283 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:17:29.664284 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:17:29.672285 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:17:29.675286 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:17:29.676286 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:17:29.678287 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:17:29.680287 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:17:29.702292 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:17:29.710294 (MainThread): Parsing macros\etc.sql
2020-08-22 15:17:29.711294 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:17:29.728290 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:17:29.732290 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:17:29.734290 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:17:29.748294 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:17:29.774309 (MainThread): Partial parsing not enabled
2020-08-22 15:17:29.816318 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:17:29.817318 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:17:29.851316 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:17:29.851316 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:17:29.862329 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:17:29.862329 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:17:29.873331 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:17:29.873331 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:17:29.886334 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:17:29.887334 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:17:30.132380 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:17:30.133380 (MainThread): 
2020-08-22 15:17:30.134381 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:17:30.134381 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:17:30.142382 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211".
2020-08-22 15:17:30.142382 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 15:17:30.534456 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:17:30.534456 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:17:30.535459 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:17:30.864035 (MainThread): 10:17:30 | Concurrency: 1 threads (target='dev')
2020-08-22 15:17:30.865035 (MainThread): 10:17:30 | 
2020-08-22 15:17:30.869027 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:17:30.870037 (Thread-1): 10:17:30 | 1 of 5 START table model dbt_alice.my_first_dbt_model................ [RUN]
2020-08-22 15:17:30.870662 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:17:30.870662 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:17:30.870662 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-08-22 15:17:30.890678 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:17:30.891679 (Thread-1): finished collecting timing info
2020-08-22 15:17:30.918685 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:17:31.284107 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:17:31.285107 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-08-22 15:17:33.030861 (Thread-1): finished collecting timing info
2020-08-22 15:17:33.031862 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0f276ef-52e1-4b16-ad68-c331c8a21ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021135BE3348>]}
2020-08-22 15:17:33.032853 (Thread-1): 10:17:33 | 1 of 5 OK created table model dbt_alice.my_first_dbt_model........... [CREATE TABLE (2) in 2.16s]
2020-08-22 15:17:33.033470 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:17:33.033470 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-08-22 15:17:33.034474 (Thread-1): 10:17:33 | 2 of 5 START view model dbt_alice.stg_customers...................... [RUN]
2020-08-22 15:17:33.035473 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:17:33.035473 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:17:33.035473 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-08-22 15:17:33.040484 (Thread-1): unclosed <socket.socket fd=944, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64906), raddr=('216.58.194.74', 443)>
2020-08-22 15:17:33.040484 (Thread-1): unclosed <socket.socket fd=956, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64905), raddr=('172.217.9.138', 443)>
2020-08-22 15:17:33.041484 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-08-22 15:17:33.042484 (Thread-1): finished collecting timing info
2020-08-22 15:17:33.062488 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2020-08-22 15:17:33.064480 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


2020-08-22 15:17:33.837347 (Thread-1): finished collecting timing info
2020-08-22 15:17:33.837347 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0f276ef-52e1-4b16-ad68-c331c8a21ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021135C3A588>]}
2020-08-22 15:17:33.839348 (Thread-1): 10:17:33 | 2 of 5 OK created view model dbt_alice.stg_customers................. [CREATE VIEW in 0.80s]
2020-08-22 15:17:33.839348 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-08-22 15:17:33.839348 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-08-22 15:17:33.840339 (Thread-1): 10:17:33 | 3 of 5 START view model dbt_alice.stg_orders......................... [RUN]
2020-08-22 15:17:33.841453 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:17:33.841453 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:17:33.841453 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-08-22 15:17:33.847458 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:17:33.848458 (Thread-1): finished collecting timing info
2020-08-22 15:17:33.852459 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:17:33.854460 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


2020-08-22 15:17:34.920481 (Thread-1): finished collecting timing info
2020-08-22 15:17:34.920481 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0f276ef-52e1-4b16-ad68-c331c8a21ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021135BBC408>]}
2020-08-22 15:17:34.922752 (Thread-1): 10:17:34 | 3 of 5 OK created view model dbt_alice.stg_orders.................... [CREATE VIEW in 1.08s]
2020-08-22 15:17:34.922752 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-08-22 15:17:34.923490 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:17:34.924491 (Thread-1): 10:17:34 | 4 of 5 START view model dbt_alice.my_second_dbt_model................ [RUN]
2020-08-22 15:17:34.924491 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:17:34.924491 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:17:34.924491 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-08-22 15:17:34.932484 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:17:34.933492 (Thread-1): finished collecting timing info
2020-08-22 15:17:34.938493 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:17:34.939485 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
where id = 1;


2020-08-22 15:17:35.636712 (Thread-1): finished collecting timing info
2020-08-22 15:17:35.636712 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0f276ef-52e1-4b16-ad68-c331c8a21ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021135DDE1C8>]}
2020-08-22 15:17:35.637713 (Thread-1): 10:17:35 | 4 of 5 OK created view model dbt_alice.my_second_dbt_model........... [CREATE VIEW in 0.71s]
2020-08-22 15:17:35.638909 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:17:35.638909 (Thread-1): Began running node model.jaffle_shop.customers
2020-08-22 15:17:35.639913 (Thread-1): 10:17:35 | 5 of 5 START view model dbt_alice.customers.......................... [RUN]
2020-08-22 15:17:35.639913 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:17:35.640912 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:17:35.640912 (Thread-1): Compiling model.jaffle_shop.customers
2020-08-22 15:17:35.643921 (Thread-1): unclosed <socket.socket fd=1180, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64911), raddr=('172.217.9.138', 443)>
2020-08-22 15:17:35.643921 (Thread-1): unclosed <socket.socket fd=1192, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64912), raddr=('216.58.194.74', 443)>
2020-08-22 15:17:35.649924 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-08-22 15:17:35.650923 (Thread-1): finished collecting timing info
2020-08-22 15:17:35.655924 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-08-22 15:17:35.656916 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`customers`
  OPTIONS()
  as with customers as (

    select * from `quick-asset-287211`.`dbt_alice`.`stg_customers`

),

orders as (

    select * from `quick-asset-287211`.`dbt_alice`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2020-08-22 15:17:36.458781 (Thread-1): finished collecting timing info
2020-08-22 15:17:36.458781 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0f276ef-52e1-4b16-ad68-c331c8a21ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021135D9D188>]}
2020-08-22 15:17:36.459705 (Thread-1): 10:17:36 | 5 of 5 OK created view model dbt_alice.customers..................... [CREATE VIEW in 0.82s]
2020-08-22 15:17:36.460745 (Thread-1): Finished running node model.jaffle_shop.customers
2020-08-22 15:17:36.560711 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:17:36.560711 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:17:36.561711 (MainThread): 10:17:36 | 
2020-08-22 15:17:36.561909 (MainThread): 10:17:36 | Finished running 1 table model, 4 view models in 6.43s.
2020-08-22 15:17:36.562915 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:17:36.562915 (MainThread): Connection 'list_quick-asset-287211' was properly closed.
2020-08-22 15:17:36.562915 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:17:36.562915 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2020-08-22 15:17:36.577915 (MainThread): 
2020-08-22 15:17:36.578916 (MainThread): Completed successfully
2020-08-22 15:17:36.578916 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2020-08-22 15:17:36.579917 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021135C91F88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021135CD9DC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021135B59448>]}
2020-08-22 15:17:36.579917 (MainThread): Flushing usage events
2020-08-22 15:20:17.926105 (MainThread): Running with dbt=0.17.2
2020-08-22 15:20:18.254186 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 15:20:18.255187 (MainThread): Tracking: tracking
2020-08-22 15:20:18.256178 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2B612C708>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2B612CA08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2B612C888>]}
2020-08-22 15:20:18.304197 (MainThread): Partial parsing not enabled
2020-08-22 15:20:18.308194 (MainThread): Parsing macros\core.sql
2020-08-22 15:20:18.313481 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:20:18.375495 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:20:18.387498 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:20:18.388498 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:20:18.390499 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:20:18.393499 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:20:18.395500 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:20:18.396500 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:20:18.406502 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:20:18.424508 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:20:18.426508 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:20:18.434509 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:20:18.460515 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:20:18.497524 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:20:18.499524 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:20:18.520537 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:20:18.529539 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:20:18.535532 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:20:18.544533 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:20:18.546534 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:20:18.548534 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:20:18.549535 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:20:18.551535 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:20:18.572540 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:20:18.580541 (MainThread): Parsing macros\etc.sql
2020-08-22 15:20:18.581542 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:20:18.598546 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:20:18.602547 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:20:18.604547 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:20:18.617550 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:20:18.643556 (MainThread): Partial parsing not enabled
2020-08-22 15:20:18.682564 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:20:18.683565 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:20:18.716572 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:20:18.716572 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:20:18.726575 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:20:18.726575 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:20:18.736577 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:20:18.736577 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:20:18.749580 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:20:18.749580 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:20:18.908891 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2B6427088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2B63EFA48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2B6411888>]}
2020-08-22 15:20:18.909754 (MainThread): Flushing usage events
2020-08-22 15:20:19.220790 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2020-08-22 15:20:19.221790 (MainThread): Encountered an error:
2020-08-22 15:20:19.222067 (MainThread): Compilation Error in model customers (models\customers.sql)
  Model 'model.jaffle_shop.customers' (models\customers.sql) depends on a node named 'stg_orders2' which was not found
2020-08-22 15:20:19.248271 (MainThread): Traceback (most recent call last):
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\main.py", line 212, in run_from_args
    results = task.run()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\task\runnable.py", line 390, in run
    self._runtime_initialize()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\task\runnable.py", line 103, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\task\runnable.py", line 71, in _runtime_initialize
    self.load_manifest()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\task\runnable.py", line 60, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\parser\manifest.py", line 641, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\parser\manifest.py", line 358, in load_all
    manifest = loader.create_manifest()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\parser\manifest.py", line 334, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\parser\manifest.py", line 306, in process_manifest
    process_refs(manifest, project_name)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\parser\manifest.py", line 564, in process_refs
    _process_refs_for_node(manifest, current_project, node)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\parser\manifest.py", line 548, in _process_refs_for_node
    disabled=(isinstance(target_model, Disabled))
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\utils.py", line 318, in invalid_ref_fail_unless_test
    disabled=disabled,
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\exceptions.py", line 527, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\exceptions.py", line 396, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model customers (models\customers.sql)
  Model 'model.jaffle_shop.customers' (models\customers.sql) depends on a node named 'stg_orders2' which was not found

2020-08-22 15:20:34.853891 (MainThread): Running with dbt=0.17.2
2020-08-22 15:20:35.175711 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 15:20:35.176710 (MainThread): Tracking: tracking
2020-08-22 15:20:35.177711 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F2214BCC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F2214D448>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F2214D148>]}
2020-08-22 15:20:35.225721 (MainThread): Partial parsing not enabled
2020-08-22 15:20:35.228722 (MainThread): Parsing macros\core.sql
2020-08-22 15:20:35.234724 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:20:35.294737 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:20:35.305739 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:20:35.306740 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:20:35.308740 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:20:35.311741 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:20:35.313742 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:20:35.315742 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:20:35.325744 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:20:35.344748 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:20:35.347751 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:20:35.357752 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:20:35.385758 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:20:35.422779 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:20:35.424767 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:20:35.445771 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:20:35.454773 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:20:35.460774 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:20:35.468776 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:20:35.471769 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:20:35.472768 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:20:35.474769 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:20:35.476911 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:20:35.498783 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:20:35.507785 (MainThread): Parsing macros\etc.sql
2020-08-22 15:20:35.508785 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:20:35.526790 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:20:35.529790 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:20:35.531791 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:20:35.544794 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:20:35.570800 (MainThread): Partial parsing not enabled
2020-08-22 15:20:35.611809 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:20:35.611809 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:20:35.646817 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:20:35.646817 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:20:35.657819 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:20:35.657819 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:20:35.669822 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:20:35.669822 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:20:35.684825 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:20:35.684825 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:20:35.947885 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:20:35.948876 (MainThread): 
2020-08-22 15:20:35.949876 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:20:35.949876 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:20:35.957887 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211".
2020-08-22 15:20:35.957887 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 15:20:36.355068 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:20:36.355068 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:20:36.356082 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:20:36.713821 (MainThread): 10:20:36 | Concurrency: 1 threads (target='dev')
2020-08-22 15:20:36.714822 (MainThread): 10:20:36 | 
2020-08-22 15:20:36.717448 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:20:36.718450 (Thread-1): 10:20:36 | 1 of 5 START table model dbt_alice.my_first_dbt_model................ [RUN]
2020-08-22 15:20:36.719450 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:20:36.719450 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:20:36.719450 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-08-22 15:20:36.739465 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:20:36.740464 (Thread-1): finished collecting timing info
2020-08-22 15:20:36.766566 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:20:37.137681 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:20:37.138682 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-08-22 15:20:38.805025 (Thread-1): finished collecting timing info
2020-08-22 15:20:38.806025 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9133fa1d-a215-41e3-92e2-f94867f2894f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F22338108>]}
2020-08-22 15:20:38.807025 (Thread-1): 10:20:38 | 1 of 5 OK created table model dbt_alice.my_first_dbt_model........... [CREATE TABLE (2) in 2.09s]
2020-08-22 15:20:38.807325 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:20:38.807325 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-08-22 15:20:38.808329 (Thread-1): 10:20:38 | 2 of 5 START view model dbt_alice.stg_customers...................... [RUN]
2020-08-22 15:20:38.809402 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:20:38.809402 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:20:38.809402 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-08-22 15:20:38.815338 (Thread-1): unclosed <socket.socket fd=888, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64985), raddr=('216.58.194.74', 443)>
2020-08-22 15:20:38.815338 (Thread-1): unclosed <socket.socket fd=448, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64984), raddr=('172.217.14.170', 443)>
2020-08-22 15:20:38.816340 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-08-22 15:20:38.817339 (Thread-1): finished collecting timing info
2020-08-22 15:20:38.837343 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2020-08-22 15:20:38.838343 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


2020-08-22 15:20:39.768231 (Thread-1): finished collecting timing info
2020-08-22 15:20:39.769231 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9133fa1d-a215-41e3-92e2-f94867f2894f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F2248B448>]}
2020-08-22 15:20:39.770232 (Thread-1): 10:20:39 | 2 of 5 OK created view model dbt_alice.stg_customers................. [CREATE VIEW in 0.96s]
2020-08-22 15:20:39.771224 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-08-22 15:20:39.771224 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-08-22 15:20:39.772224 (Thread-1): 10:20:39 | 3 of 5 START view model dbt_alice.stg_orders......................... [RUN]
2020-08-22 15:20:39.772224 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:20:39.772224 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:20:39.772224 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-08-22 15:20:39.778234 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:20:39.779294 (Thread-1): finished collecting timing info
2020-08-22 15:20:39.783235 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:20:39.784319 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


2020-08-22 15:20:40.654047 (Thread-1): finished collecting timing info
2020-08-22 15:20:40.655048 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9133fa1d-a215-41e3-92e2-f94867f2894f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F1DDC0C08>]}
2020-08-22 15:20:40.656047 (Thread-1): 10:20:40 | 3 of 5 OK created view model dbt_alice.stg_orders.................... [CREATE VIEW in 0.88s]
2020-08-22 15:20:40.657039 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-08-22 15:20:40.657039 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:20:40.658040 (Thread-1): 10:20:40 | 4 of 5 START view model dbt_alice.my_second_dbt_model................ [RUN]
2020-08-22 15:20:40.658542 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:20:40.658542 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:20:40.658542 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-08-22 15:20:40.666556 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:20:40.667556 (Thread-1): finished collecting timing info
2020-08-22 15:20:40.671557 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:20:40.672548 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
where id = 1;


2020-08-22 15:20:41.654214 (Thread-1): finished collecting timing info
2020-08-22 15:20:41.654214 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9133fa1d-a215-41e3-92e2-f94867f2894f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F222CA788>]}
2020-08-22 15:20:41.656215 (Thread-1): 10:20:41 | 4 of 5 OK created view model dbt_alice.my_second_dbt_model........... [CREATE VIEW in 1.00s]
2020-08-22 15:20:41.656440 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:20:41.656440 (Thread-1): Began running node model.jaffle_shop.customers
2020-08-22 15:20:41.657451 (Thread-1): 10:20:41 | 5 of 5 START view model dbt_alice.customers.......................... [RUN]
2020-08-22 15:20:41.658442 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:20:41.658442 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:20:41.658442 (Thread-1): Compiling model.jaffle_shop.customers
2020-08-22 15:20:41.661452 (Thread-1): unclosed <socket.socket fd=1180, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64991), raddr=('172.217.14.170', 443)>
2020-08-22 15:20:41.661452 (Thread-1): unclosed <socket.socket fd=1176, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 64992), raddr=('216.58.194.74', 443)>
2020-08-22 15:20:41.666746 (Thread-1): finished collecting timing info
2020-08-22 15:20:41.667759 (Thread-1): Compilation Error in model customers (models\customers.sql)
  'r2ef' is undefined
Traceback (most recent call last):
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 496, in catch_jinja
    yield
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 528, in render_template
    return template.render(ctx)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\environment.py", line 1090, in render
    self.environment.handle_exception()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 9, in top-level template code
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'r2ef' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 165, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 340, in compile
    return compile_node(self.adapter, self.config, self.node, manifest, {})
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\compilation.py", line 255, in compile_node
    node = compiler.compile_node(node, manifest, extra_context)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\compilation.py", line 179, in compile_node
    node)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 528, in render_template
    return template.render(ctx)
  File "c:\users\bhala\.conda\envs\dbt\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 501, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model customers (models\customers.sql)
  'r2ef' is undefined
2020-08-22 15:20:41.694764 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9133fa1d-a215-41e3-92e2-f94867f2894f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F2256BF88>]}
2020-08-22 15:20:41.695764 (Thread-1): 10:20:41 | 5 of 5 ERROR creating view model dbt_alice.customers................. [ERROR in 0.04s]
2020-08-22 15:20:41.696755 (Thread-1): Finished running node model.jaffle_shop.customers
2020-08-22 15:20:41.766056 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:20:41.766056 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:20:41.767057 (MainThread): 10:20:41 | 
2020-08-22 15:20:41.767237 (MainThread): 10:20:41 | Finished running 1 table model, 4 view models in 5.82s.
2020-08-22 15:20:41.768241 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:20:41.768241 (MainThread): Connection 'list_quick-asset-287211' was properly closed.
2020-08-22 15:20:41.768241 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:20:41.768241 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2020-08-22 15:20:41.783252 (MainThread): 
2020-08-22 15:20:41.784242 (MainThread): Completed with 1 error and 0 warnings:
2020-08-22 15:20:41.784242 (MainThread): 
2020-08-22 15:20:41.785243 (MainThread): Compilation Error in model customers (models\customers.sql)
2020-08-22 15:20:41.785243 (MainThread):   'r2ef' is undefined
2020-08-22 15:20:41.786243 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2020-08-22 15:20:41.786243 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F22468E88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F22325448>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F22580BC8>]}
2020-08-22 15:20:41.786243 (MainThread): Flushing usage events
2020-08-22 15:21:13.327152 (MainThread): Running with dbt=0.17.2
2020-08-22 15:21:13.655236 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 15:21:13.656236 (MainThread): Tracking: tracking
2020-08-22 15:21:13.656236 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F6402CA48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F64033648>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F64033608>]}
2020-08-22 15:21:13.705247 (MainThread): Partial parsing not enabled
2020-08-22 15:21:13.709248 (MainThread): Parsing macros\core.sql
2020-08-22 15:21:13.715249 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:21:13.778340 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:21:13.790344 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:21:13.791341 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:21:13.793268 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:21:13.796258 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:21:13.798346 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:21:13.799347 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:21:13.809271 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:21:13.827274 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:21:13.830275 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:21:13.838279 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:21:13.866386 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:21:13.904292 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:21:13.906458 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:21:13.928297 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:21:13.937299 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:21:13.943300 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:21:13.951302 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:21:13.954303 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:21:13.955303 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:21:13.957304 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:21:13.959304 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:21:13.980309 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:21:13.988310 (MainThread): Parsing macros\etc.sql
2020-08-22 15:21:13.989311 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:21:14.007315 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:21:14.011316 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:21:14.013316 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:21:14.026319 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:21:14.051325 (MainThread): Partial parsing not enabled
2020-08-22 15:21:14.097326 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:21:14.097326 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:21:14.135343 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:21:14.135343 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:21:14.145337 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:21:14.145337 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:21:14.155348 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:21:14.155348 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:21:14.169351 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:21:14.169351 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:21:14.412398 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:21:14.413398 (MainThread): 
2020-08-22 15:21:14.414398 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:21:14.414398 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:21:14.421399 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211".
2020-08-22 15:21:14.421399 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 15:21:14.812344 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:21:14.812344 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:21:14.813358 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:21:15.206919 (MainThread): 10:21:15 | Concurrency: 1 threads (target='dev')
2020-08-22 15:21:15.206919 (MainThread): 10:21:15 | 
2020-08-22 15:21:15.210323 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:21:15.212332 (Thread-1): 10:21:15 | 1 of 5 START table model dbt_alice.my_first_dbt_model................ [RUN]
2020-08-22 15:21:15.212559 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:21:15.212559 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:21:15.212559 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-08-22 15:21:15.235574 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:21:15.236574 (Thread-1): finished collecting timing info
2020-08-22 15:21:15.262581 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:21:15.658386 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:21:15.659387 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-08-22 15:21:17.166402 (Thread-1): finished collecting timing info
2020-08-22 15:21:17.167403 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc2d6167-1a49-4e48-9e93-7b2e78b98dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F6424D048>]}
2020-08-22 15:21:17.168394 (Thread-1): 10:21:17 | 1 of 5 OK created table model dbt_alice.my_first_dbt_model........... [CREATE TABLE (2) in 1.95s]
2020-08-22 15:21:17.185093 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:21:17.186101 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-08-22 15:21:17.187106 (Thread-1): 10:21:17 | 2 of 5 START view model dbt_alice.stg_customers...................... [RUN]
2020-08-22 15:21:17.187106 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:21:17.187106 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:21:17.188097 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-08-22 15:21:17.192107 (Thread-1): unclosed <socket.socket fd=836, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65007), raddr=('172.217.9.10', 443)>
2020-08-22 15:21:17.193107 (Thread-1): unclosed <socket.socket fd=848, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65006), raddr=('172.217.14.170', 443)>
2020-08-22 15:21:17.194107 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-08-22 15:21:17.195107 (Thread-1): finished collecting timing info
2020-08-22 15:21:17.216112 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2020-08-22 15:21:17.217112 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


2020-08-22 15:21:17.951907 (Thread-1): finished collecting timing info
2020-08-22 15:21:17.951907 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc2d6167-1a49-4e48-9e93-7b2e78b98dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F643E1A08>]}
2020-08-22 15:21:17.952908 (Thread-1): 10:21:17 | 2 of 5 OK created view model dbt_alice.stg_customers................. [CREATE VIEW in 0.76s]
2020-08-22 15:21:17.954095 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-08-22 15:21:17.954095 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-08-22 15:21:17.955107 (Thread-1): 10:21:17 | 3 of 5 START view model dbt_alice.stg_orders......................... [RUN]
2020-08-22 15:21:17.956097 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:21:17.956097 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:21:17.956097 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-08-22 15:21:17.961107 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:21:17.962107 (Thread-1): finished collecting timing info
2020-08-22 15:21:17.966109 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:21:17.968100 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


2020-08-22 15:21:18.717712 (Thread-1): finished collecting timing info
2020-08-22 15:21:18.717712 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc2d6167-1a49-4e48-9e93-7b2e78b98dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F641C8248>]}
2020-08-22 15:21:18.719704 (Thread-1): 10:21:18 | 3 of 5 OK created view model dbt_alice.stg_orders.................... [CREATE VIEW in 0.76s]
2020-08-22 15:21:18.719902 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-08-22 15:21:18.719902 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:21:18.720906 (Thread-1): 10:21:18 | 4 of 5 START view model dbt_alice.my_second_dbt_model................ [RUN]
2020-08-22 15:21:18.721907 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:21:18.721907 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:21:18.721907 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-08-22 15:21:18.729916 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:21:18.730916 (Thread-1): finished collecting timing info
2020-08-22 15:21:18.734908 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:21:18.735917 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
where id = 1;


2020-08-22 15:21:19.699702 (Thread-1): finished collecting timing info
2020-08-22 15:21:19.699702 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc2d6167-1a49-4e48-9e93-7b2e78b98dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F64405688>]}
2020-08-22 15:21:19.701703 (Thread-1): 10:21:19 | 4 of 5 OK created view model dbt_alice.my_second_dbt_model........... [CREATE VIEW in 0.98s]
2020-08-22 15:21:19.702032 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:21:19.702032 (Thread-1): Began running node model.jaffle_shop.customers
2020-08-22 15:21:19.703044 (Thread-1): 10:21:19 | 5 of 5 START view model dbt_alice.customers.......................... [RUN]
2020-08-22 15:21:19.703044 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:21:19.704034 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:21:19.704034 (Thread-1): Compiling model.jaffle_shop.customers
2020-08-22 15:21:19.707043 (Thread-1): unclosed <socket.socket fd=1204, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65012), raddr=('172.217.14.170', 443)>
2020-08-22 15:21:19.707043 (Thread-1): unclosed <socket.socket fd=1212, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65013), raddr=('172.217.9.10', 443)>
2020-08-22 15:21:19.713045 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-08-22 15:21:19.714045 (Thread-1): finished collecting timing info
2020-08-22 15:21:19.718046 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-08-22 15:21:19.719046 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`customers`
  OPTIONS()
  as with customers as (

    select * from `quick-asset-287211`.`dbt_alice`.`stg_customers`

),

orders as (

    select * from `quick-asset-287211`.`dbt_alice`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders1

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2020-08-22 15:21:20.344810 (Thread-1): finished collecting timing info
2020-08-22 15:21:20.344810 (Thread-1): Database Error in model customers (models\customers.sql)
  Name number_of_orders not found inside customer_orders at [42:34]
  compiled SQL at target\run\jaffle_shop\models\customers.sql
Traceback (most recent call last):
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 85, in exception_handler
    yield
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 364, in _retry_and_handle
    deadline=None)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 226, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 353, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\future\polling.py", line 122, in result
    self._blocking_poll(timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\job.py", line 3098, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\future\polling.py", line 101, in _blocking_poll
    retry_(self._done_or_raise)()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\future\polling.py", line 80, in _done_or_raise
    if not self.done():
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\job.py", line 3085, in done
    timeout=timeout,
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\client.py", line 1287, in _get_query_results
    retry, method="GET", path=path, query_params=extra_params, timeout=timeout
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\client.py", line 556, in _call_api
    return call()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\_http.py", line 423, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/quick-asset-287211/queries/8c15d786-8729-4393-b5ca-7394c870e6d5?maxResults=0&location=US: Name number_of_orders not found inside customer_orders at [42:34]

(job ID: 8c15d786-8729-4393-b5ca-7394c870e6d5)

                                                         -----Query Job SQL Follows-----                                                         

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
   2:
   3:
   4:  create or replace view `quick-asset-287211`.`dbt_alice`.`customers`
   5:  OPTIONS()
   6:  as with customers as (
   7:
   8:    select * from `quick-asset-287211`.`dbt_alice`.`stg_customers`
   9:
  10:),
  11:
  12:orders as (
  13:
  14:    select * from `quick-asset-287211`.`dbt_alice`.`stg_orders`
  15:
  16:),
  17:
  18:customer_orders as (
  19:
  20:    select
  21:        customer_id,
  22:
  23:        min(order_date) as first_order_date,
  24:        max(order_date) as most_recent_order_date,
  25:        count(order_id) as number_of_orders1
  26:
  27:    from orders
  28:
  29:    group by 1
  30:
  31:),
  32:
  33:
  34:final as (
  35:
  36:    select
  37:        customers.customer_id,
  38:        customers.first_name,
  39:        customers.last_name,
  40:        customer_orders.first_order_date,
  41:        customer_orders.most_recent_order_date,
  42:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  43:
  44:    from customers
  45:
  46:    left join customer_orders using (customer_id)
  47:
  48:)
  49:
  50:select * from final;
  51:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\base\impl.py", line 228, in execute
    fetch=fetch
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 235, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 228, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 364, in _retry_and_handle
    deadline=None)
  File "c:\users\bhala\.conda\envs\dbt\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 89, in exception_handler
    self.handle_error(e, message)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 77, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models\customers.sql)
  Name number_of_orders not found inside customer_orders at [42:34]
  compiled SQL at target\run\jaffle_shop\models\customers.sql
2020-08-22 15:21:20.389830 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc2d6167-1a49-4e48-9e93-7b2e78b98dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F6423BA88>]}
2020-08-22 15:21:20.391822 (Thread-1): 10:21:20 | 5 of 5 ERROR creating view model dbt_alice.customers................. [ERROR in 0.69s]
2020-08-22 15:21:20.391822 (Thread-1): Finished running node model.jaffle_shop.customers
2020-08-22 15:21:20.485504 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:21:20.485504 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:21:20.486507 (MainThread): 10:21:20 | 
2020-08-22 15:21:20.486507 (MainThread): 10:21:20 | Finished running 1 table model, 4 view models in 6.07s.
2020-08-22 15:21:20.487515 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:21:20.487515 (MainThread): Connection 'list_quick-asset-287211' was properly closed.
2020-08-22 15:21:20.487515 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:21:20.487515 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2020-08-22 15:21:20.502519 (MainThread): 
2020-08-22 15:21:20.502519 (MainThread): Completed with 1 error and 0 warnings:
2020-08-22 15:21:20.503519 (MainThread): 
2020-08-22 15:21:20.503519 (MainThread): Database Error in model customers (models\customers.sql)
2020-08-22 15:21:20.504510 (MainThread):   Name number_of_orders not found inside customer_orders at [42:34]
2020-08-22 15:21:20.504510 (MainThread):   compiled SQL at target\run\jaffle_shop\models\customers.sql
2020-08-22 15:21:20.505510 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2020-08-22 15:21:20.505510 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F642CFD48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F64357E88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F641DD308>]}
2020-08-22 15:21:20.505510 (MainThread): Flushing usage events
2020-08-22 15:22:16.698690 (MainThread): Running with dbt=0.17.2
2020-08-22 15:22:17.019039 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 15:22:17.019039 (MainThread): Tracking: tracking
2020-08-22 15:22:17.020040 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218A941C588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218A941C6C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218A941CF08>]}
2020-08-22 15:22:17.068050 (MainThread): Partial parsing not enabled
2020-08-22 15:22:17.072051 (MainThread): Parsing macros\core.sql
2020-08-22 15:22:17.077587 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:22:17.139601 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:22:17.151603 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:22:17.152604 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:22:17.154604 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:22:17.157605 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:22:17.159605 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:22:17.160605 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:22:17.170608 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:22:17.187611 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:22:17.189918 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:22:17.198941 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:22:17.226975 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:22:17.264785 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:22:17.267982 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:22:17.290018 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:22:17.298793 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:22:17.304794 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:22:17.313796 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:22:17.316797 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:22:17.317790 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:22:17.319798 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:22:17.321798 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:22:17.342803 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:22:17.350805 (MainThread): Parsing macros\etc.sql
2020-08-22 15:22:17.351805 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:22:17.368802 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:22:17.372810 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:22:17.374810 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:22:17.387813 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:22:17.413819 (MainThread): Partial parsing not enabled
2020-08-22 15:22:17.453828 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:22:17.454820 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:22:17.486835 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:22:17.487835 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:22:17.496838 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:22:17.496838 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:22:17.507840 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:22:17.508840 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:22:17.521843 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:22:17.521843 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:22:17.768890 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:22:17.769899 (MainThread): 
2020-08-22 15:22:17.769899 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:22:17.769899 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:22:17.777892 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211".
2020-08-22 15:22:17.777892 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 15:22:18.193446 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:22:18.193446 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:22:18.193446 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:22:18.531868 (MainThread): 10:22:18 | Concurrency: 1 threads (target='dev')
2020-08-22 15:22:18.531868 (MainThread): 10:22:18 | 
2020-08-22 15:22:18.536180 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:22:18.537184 (Thread-1): 10:22:18 | 1 of 5 START table model dbt_alice.my_first_dbt_model................ [RUN]
2020-08-22 15:22:18.537785 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:22:18.537785 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:22:18.537785 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-08-22 15:22:18.557800 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:22:18.558792 (Thread-1): finished collecting timing info
2020-08-22 15:22:18.584806 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:22:18.948823 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:22:18.949833 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-08-22 15:22:20.636652 (Thread-1): finished collecting timing info
2020-08-22 15:22:20.636652 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbcb4083-1cc1-4564-a54a-a407b9dfea77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218A969D9C8>]}
2020-08-22 15:22:20.637653 (Thread-1): 10:22:20 | 1 of 5 OK created table model dbt_alice.my_first_dbt_model........... [CREATE TABLE (2) in 2.10s]
2020-08-22 15:22:20.638653 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:22:20.638653 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-08-22 15:22:20.639654 (Thread-1): 10:22:20 | 2 of 5 START view model dbt_alice.stg_customers...................... [RUN]
2020-08-22 15:22:20.640653 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:22:20.640653 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:22:20.640653 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-08-22 15:22:20.645663 (Thread-1): unclosed <socket.socket fd=464, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65033), raddr=('172.217.9.10', 443)>
2020-08-22 15:22:20.645663 (Thread-1): unclosed <socket.socket fd=740, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65032), raddr=('172.217.6.170', 443)>
2020-08-22 15:22:20.647664 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-08-22 15:22:20.647664 (Thread-1): finished collecting timing info
2020-08-22 15:22:20.668669 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2020-08-22 15:22:20.669669 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


2020-08-22 15:22:21.529533 (Thread-1): finished collecting timing info
2020-08-22 15:22:21.529533 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbcb4083-1cc1-4564-a54a-a407b9dfea77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218A96317C8>]}
2020-08-22 15:22:21.530540 (Thread-1): 10:22:21 | 2 of 5 OK created view model dbt_alice.stg_customers................. [CREATE VIEW in 0.89s]
2020-08-22 15:22:21.531745 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-08-22 15:22:21.531745 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-08-22 15:22:21.532748 (Thread-1): 10:22:21 | 3 of 5 START view model dbt_alice.stg_orders......................... [RUN]
2020-08-22 15:22:21.533748 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:22:21.533748 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:22:21.533748 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-08-22 15:22:21.538757 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:22:21.539758 (Thread-1): finished collecting timing info
2020-08-22 15:22:21.543758 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:22:21.544750 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


2020-08-22 15:22:22.667938 (Thread-1): finished collecting timing info
2020-08-22 15:22:22.667938 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbcb4083-1cc1-4564-a54a-a407b9dfea77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218A96FA708>]}
2020-08-22 15:22:22.668938 (Thread-1): 10:22:22 | 3 of 5 OK created view model dbt_alice.stg_orders.................... [CREATE VIEW in 1.14s]
2020-08-22 15:22:22.669938 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-08-22 15:22:22.669938 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:22:22.670938 (Thread-1): 10:22:22 | 4 of 5 START view model dbt_alice.my_second_dbt_model................ [RUN]
2020-08-22 15:22:22.671938 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:22:22.671938 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:22:22.671938 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-08-22 15:22:22.679940 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:22:22.680941 (Thread-1): finished collecting timing info
2020-08-22 15:22:22.684941 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:22:22.685942 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
where id = 1;


2020-08-22 15:22:23.685641 (Thread-1): finished collecting timing info
2020-08-22 15:22:23.685641 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbcb4083-1cc1-4564-a54a-a407b9dfea77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218A9655608>]}
2020-08-22 15:22:23.686642 (Thread-1): 10:22:23 | 4 of 5 OK created view model dbt_alice.my_second_dbt_model........... [CREATE VIEW in 1.01s]
2020-08-22 15:22:23.687772 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:22:23.687772 (Thread-1): Began running node model.jaffle_shop.customers
2020-08-22 15:22:23.688642 (Thread-1): 10:22:23 | 5 of 5 START view model dbt_alice.customers.......................... [RUN]
2020-08-22 15:22:23.689642 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:22:23.689642 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:22:23.689642 (Thread-1): Compiling model.jaffle_shop.customers
2020-08-22 15:22:23.692643 (Thread-1): unclosed <socket.socket fd=1140, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65038), raddr=('172.217.6.170', 443)>
2020-08-22 15:22:23.692643 (Thread-1): unclosed <socket.socket fd=1184, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65039), raddr=('172.217.9.10', 443)>
2020-08-22 15:22:23.698644 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-08-22 15:22:23.699831 (Thread-1): finished collecting timing info
2020-08-22 15:22:23.703645 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-08-22 15:22:23.704638 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`customers`
  OPTIONS()
  as with customers as (

    select * from `quick-asset-287211`.`dbt_alice`.`stg_customers`

),

orders as (

    select * from `quick-asset-287211`.`dbt_alice`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        coun1t(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2020-08-22 15:22:24.449547 (Thread-1): finished collecting timing info
2020-08-22 15:22:24.450549 (Thread-1): Database Error in model customers (models\customers.sql)
  Function not found: coun1t; Did you mean count? at [25:9]
  compiled SQL at target\run\jaffle_shop\models\customers.sql
Traceback (most recent call last):
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 85, in exception_handler
    yield
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 364, in _retry_and_handle
    deadline=None)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 226, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 353, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\future\polling.py", line 122, in result
    self._blocking_poll(timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\job.py", line 3098, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\future\polling.py", line 101, in _blocking_poll
    retry_(self._done_or_raise)()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\future\polling.py", line 80, in _done_or_raise
    if not self.done():
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\job.py", line 3085, in done
    timeout=timeout,
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\client.py", line 1287, in _get_query_results
    retry, method="GET", path=path, query_params=extra_params, timeout=timeout
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\client.py", line 556, in _call_api
    return call()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\_http.py", line 423, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/quick-asset-287211/queries/2b368daf-cc8e-4fac-aa13-b4a2fc142dd9?maxResults=0&location=US: Function not found: coun1t; Did you mean count? at [25:9]

(job ID: 2b368daf-cc8e-4fac-aa13-b4a2fc142dd9)

                                                         -----Query Job SQL Follows-----                                                         

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
   2:
   3:
   4:  create or replace view `quick-asset-287211`.`dbt_alice`.`customers`
   5:  OPTIONS()
   6:  as with customers as (
   7:
   8:    select * from `quick-asset-287211`.`dbt_alice`.`stg_customers`
   9:
  10:),
  11:
  12:orders as (
  13:
  14:    select * from `quick-asset-287211`.`dbt_alice`.`stg_orders`
  15:
  16:),
  17:
  18:customer_orders as (
  19:
  20:    select
  21:        customer_id,
  22:
  23:        min(order_date) as first_order_date,
  24:        max(order_date) as most_recent_order_date,
  25:        coun1t(order_id) as number_of_orders
  26:
  27:    from orders
  28:
  29:    group by 1
  30:
  31:),
  32:
  33:
  34:final as (
  35:
  36:    select
  37:        customers.customer_id,
  38:        customers.first_name,
  39:        customers.last_name,
  40:        customer_orders.first_order_date,
  41:        customer_orders.most_recent_order_date,
  42:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  43:
  44:    from customers
  45:
  46:    left join customer_orders using (customer_id)
  47:
  48:)
  49:
  50:select * from final;
  51:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\base\impl.py", line 228, in execute
    fetch=fetch
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 235, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 228, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 364, in _retry_and_handle
    deadline=None)
  File "c:\users\bhala\.conda\envs\dbt\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 89, in exception_handler
    self.handle_error(e, message)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 77, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models\customers.sql)
  Function not found: coun1t; Did you mean count? at [25:9]
  compiled SQL at target\run\jaffle_shop\models\customers.sql
2020-08-22 15:22:24.455549 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbcb4083-1cc1-4564-a54a-a407b9dfea77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218A95AE188>]}
2020-08-22 15:22:24.456550 (Thread-1): 10:22:24 | 5 of 5 ERROR creating view model dbt_alice.customers................. [ERROR in 0.77s]
2020-08-22 15:22:24.457549 (Thread-1): Finished running node model.jaffle_shop.customers
2020-08-22 15:22:24.561634 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:22:24.561634 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:22:24.562634 (MainThread): 10:22:24 | 
2020-08-22 15:22:24.562634 (MainThread): 10:22:24 | Finished running 1 table model, 4 view models in 6.79s.
2020-08-22 15:22:24.563635 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:22:24.563635 (MainThread): Connection 'list_quick-asset-287211' was properly closed.
2020-08-22 15:22:24.563635 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:22:24.563635 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2020-08-22 15:22:24.578638 (MainThread): 
2020-08-22 15:22:24.578638 (MainThread): Completed with 1 error and 0 warnings:
2020-08-22 15:22:24.579638 (MainThread): 
2020-08-22 15:22:24.579638 (MainThread): Database Error in model customers (models\customers.sql)
2020-08-22 15:22:24.580638 (MainThread):   Function not found: coun1t; Did you mean count? at [25:9]
2020-08-22 15:22:24.580638 (MainThread):   compiled SQL at target\run\jaffle_shop\models\customers.sql
2020-08-22 15:22:24.581639 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2020-08-22 15:22:24.581639 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218A962C7C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218A9744B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218A9844A08>]}
2020-08-22 15:22:24.581639 (MainThread): Flushing usage events
2020-08-22 15:22:44.012455 (MainThread): Running with dbt=0.17.2
2020-08-22 15:22:44.326508 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 15:22:44.327508 (MainThread): Tracking: tracking
2020-08-22 15:22:44.328508 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EC67DC748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EC67DC708>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EC67DCB88>]}
2020-08-22 15:22:44.375519 (MainThread): Partial parsing not enabled
2020-08-22 15:22:44.379519 (MainThread): Parsing macros\core.sql
2020-08-22 15:22:44.384520 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:22:44.447535 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:22:44.460538 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:22:44.461538 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:22:44.464538 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:22:44.466539 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:22:44.469540 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:22:44.470540 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:22:44.480542 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:22:44.499547 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:22:44.502547 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:22:44.510549 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:22:44.537556 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:22:44.575564 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:22:44.577565 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:22:44.598569 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:22:44.607572 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:22:44.613572 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:22:44.622575 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:22:44.624575 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:22:44.626576 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:22:44.627576 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:22:44.629576 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:22:44.650581 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:22:44.658583 (MainThread): Parsing macros\etc.sql
2020-08-22 15:22:44.659582 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:22:44.676588 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:22:44.679589 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:22:44.681589 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:22:44.694678 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:22:44.720598 (MainThread): Partial parsing not enabled
2020-08-22 15:22:44.761803 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:22:44.761803 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:22:44.795613 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:22:44.795613 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:22:44.805615 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:22:44.805615 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:22:44.815617 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:22:44.815617 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:22:44.828620 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:22:44.828620 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:22:45.087679 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:22:45.097672 (MainThread): 
2020-08-22 15:22:45.098673 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:22:45.098673 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:22:45.106684 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211".
2020-08-22 15:22:45.106684 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 15:22:45.492771 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:22:45.492771 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:22:45.492771 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:22:45.847058 (MainThread): 10:22:45 | Concurrency: 1 threads (target='dev')
2020-08-22 15:22:45.848058 (MainThread): 10:22:45 | 
2020-08-22 15:22:45.851058 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:22:45.853067 (Thread-1): 10:22:45 | 1 of 5 START table model dbt_alice.my_first_dbt_model................ [RUN]
2020-08-22 15:22:45.853067 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:22:45.853067 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:22:45.854058 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-08-22 15:22:45.874071 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:22:45.875072 (Thread-1): finished collecting timing info
2020-08-22 15:22:45.901069 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:22:46.258368 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:22:46.259367 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-08-22 15:22:47.985747 (Thread-1): finished collecting timing info
2020-08-22 15:22:47.986746 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e94c727-f9f3-486d-9caf-32ff7232631e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EC69CB448>]}
2020-08-22 15:22:47.987747 (Thread-1): 10:22:47 | 1 of 5 OK created table model dbt_alice.my_first_dbt_model........... [CREATE TABLE (2) in 2.13s]
2020-08-22 15:22:47.988187 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:22:47.988187 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-08-22 15:22:47.989192 (Thread-1): 10:22:47 | 2 of 5 START view model dbt_alice.stg_customers...................... [RUN]
2020-08-22 15:22:47.990190 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:22:47.990190 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:22:47.990190 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-08-22 15:22:47.995200 (Thread-1): unclosed <socket.socket fd=752, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65055), raddr=('172.217.9.10', 443)>
2020-08-22 15:22:47.995200 (Thread-1): unclosed <socket.socket fd=380, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65054), raddr=('172.217.6.170', 443)>
2020-08-22 15:22:47.996201 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-08-22 15:22:47.997194 (Thread-1): finished collecting timing info
2020-08-22 15:22:48.018206 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2020-08-22 15:22:48.019206 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


2020-08-22 15:22:48.869056 (Thread-1): finished collecting timing info
2020-08-22 15:22:48.870065 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e94c727-f9f3-486d-9caf-32ff7232631e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EC6A76A48>]}
2020-08-22 15:22:48.871057 (Thread-1): 10:22:48 | 2 of 5 OK created view model dbt_alice.stg_customers................. [CREATE VIEW in 0.88s]
2020-08-22 15:22:48.871676 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-08-22 15:22:48.871676 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-08-22 15:22:48.872681 (Thread-1): 10:22:48 | 3 of 5 START view model dbt_alice.stg_orders......................... [RUN]
2020-08-22 15:22:48.873679 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:22:48.873679 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:22:48.873679 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-08-22 15:22:48.878689 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:22:48.879689 (Thread-1): finished collecting timing info
2020-08-22 15:22:48.883690 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:22:48.884682 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


2020-08-22 15:22:49.619113 (Thread-1): finished collecting timing info
2020-08-22 15:22:49.619113 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e94c727-f9f3-486d-9caf-32ff7232631e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EC69F1C08>]}
2020-08-22 15:22:49.621114 (Thread-1): 10:22:49 | 3 of 5 OK created view model dbt_alice.stg_orders.................... [CREATE VIEW in 0.75s]
2020-08-22 15:22:49.621114 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-08-22 15:22:49.621114 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:22:49.623114 (Thread-1): 10:22:49 | 4 of 5 START view model dbt_alice.my_second_dbt_model................ [RUN]
2020-08-22 15:22:49.623114 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:22:49.623114 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:22:49.623114 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-08-22 15:22:49.631116 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:22:49.632116 (Thread-1): finished collecting timing info
2020-08-22 15:22:49.637117 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:22:49.638118 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
where id = 1;


2020-08-22 15:22:50.658556 (Thread-1): finished collecting timing info
2020-08-22 15:22:50.658556 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e94c727-f9f3-486d-9caf-32ff7232631e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EC6A15F88>]}
2020-08-22 15:22:50.659556 (Thread-1): 10:22:50 | 4 of 5 OK created view model dbt_alice.my_second_dbt_model........... [CREATE VIEW in 1.04s]
2020-08-22 15:22:50.660556 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:22:50.660556 (Thread-1): Began running node model.jaffle_shop.customers
2020-08-22 15:22:50.661548 (Thread-1): 10:22:50 | 5 of 5 START view model dbt_alice.customers.......................... [RUN]
2020-08-22 15:22:50.662548 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:22:50.662548 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:22:50.662548 (Thread-1): Compiling model.jaffle_shop.customers
2020-08-22 15:22:50.665558 (Thread-1): unclosed <socket.socket fd=1204, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65060), raddr=('172.217.6.170', 443)>
2020-08-22 15:22:50.665558 (Thread-1): unclosed <socket.socket fd=1208, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65061), raddr=('172.217.9.10', 443)>
2020-08-22 15:22:50.671559 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-08-22 15:22:50.672559 (Thread-1): finished collecting timing info
2020-08-22 15:22:50.677552 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-08-22 15:22:50.678552 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`customers`
  OPTIONS()
  as with customers as (

    select * from `quick-asset-287211`.`dbt_alice`.`stg_customers`

),

orders as (

    select * from `quick-asset-287211`.`dbt_alice`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(or2der_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2020-08-22 15:22:51.327033 (Thread-1): finished collecting timing info
2020-08-22 15:22:51.327033 (Thread-1): Database Error in model customers (models\customers.sql)
  Unrecognized name: or2der_id; Did you mean order_id? at [25:15]
  compiled SQL at target\run\jaffle_shop\models\customers.sql
Traceback (most recent call last):
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 85, in exception_handler
    yield
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 364, in _retry_and_handle
    deadline=None)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 226, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 353, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\future\polling.py", line 122, in result
    self._blocking_poll(timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\job.py", line 3098, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\future\polling.py", line 101, in _blocking_poll
    retry_(self._done_or_raise)()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\future\polling.py", line 80, in _done_or_raise
    if not self.done():
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\job.py", line 3085, in done
    timeout=timeout,
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\client.py", line 1287, in _get_query_results
    retry, method="GET", path=path, query_params=extra_params, timeout=timeout
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\client.py", line 556, in _call_api
    return call()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\_http.py", line 423, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/quick-asset-287211/queries/2cd44315-aba4-4a36-b3b3-006d90310236?maxResults=0&location=US: Unrecognized name: or2der_id; Did you mean order_id? at [25:15]

(job ID: 2cd44315-aba4-4a36-b3b3-006d90310236)

                                                         -----Query Job SQL Follows-----                                                         

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
   2:
   3:
   4:  create or replace view `quick-asset-287211`.`dbt_alice`.`customers`
   5:  OPTIONS()
   6:  as with customers as (
   7:
   8:    select * from `quick-asset-287211`.`dbt_alice`.`stg_customers`
   9:
  10:),
  11:
  12:orders as (
  13:
  14:    select * from `quick-asset-287211`.`dbt_alice`.`stg_orders`
  15:
  16:),
  17:
  18:customer_orders as (
  19:
  20:    select
  21:        customer_id,
  22:
  23:        min(order_date) as first_order_date,
  24:        max(order_date) as most_recent_order_date,
  25:        count(or2der_id) as number_of_orders
  26:
  27:    from orders
  28:
  29:    group by 1
  30:
  31:),
  32:
  33:
  34:final as (
  35:
  36:    select
  37:        customers.customer_id,
  38:        customers.first_name,
  39:        customers.last_name,
  40:        customer_orders.first_order_date,
  41:        customer_orders.most_recent_order_date,
  42:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  43:
  44:    from customers
  45:
  46:    left join customer_orders using (customer_id)
  47:
  48:)
  49:
  50:select * from final;
  51:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\base\impl.py", line 228, in execute
    fetch=fetch
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 235, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 228, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 364, in _retry_and_handle
    deadline=None)
  File "c:\users\bhala\.conda\envs\dbt\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 89, in exception_handler
    self.handle_error(e, message)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 77, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models\customers.sql)
  Unrecognized name: or2der_id; Did you mean order_id? at [25:15]
  compiled SQL at target\run\jaffle_shop\models\customers.sql
2020-08-22 15:22:51.332033 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e94c727-f9f3-486d-9caf-32ff7232631e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EC6C3A748>]}
2020-08-22 15:22:51.333033 (Thread-1): 10:22:51 | 5 of 5 ERROR creating view model dbt_alice.customers................. [ERROR in 0.67s]
2020-08-22 15:22:51.334033 (Thread-1): Finished running node model.jaffle_shop.customers
2020-08-22 15:22:51.437752 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:22:51.437752 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:22:51.438741 (MainThread): 10:22:51 | 
2020-08-22 15:22:51.438741 (MainThread): 10:22:51 | Finished running 1 table model, 4 view models in 6.34s.
2020-08-22 15:22:51.439751 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:22:51.439751 (MainThread): Connection 'list_quick-asset-287211' was properly closed.
2020-08-22 15:22:51.439751 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:22:51.439751 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2020-08-22 15:22:51.455746 (MainThread): 
2020-08-22 15:22:51.455746 (MainThread): Completed with 1 error and 0 warnings:
2020-08-22 15:22:51.455746 (MainThread): 
2020-08-22 15:22:51.456755 (MainThread): Database Error in model customers (models\customers.sql)
2020-08-22 15:22:51.456755 (MainThread):   Unrecognized name: or2der_id; Did you mean order_id? at [25:15]
2020-08-22 15:22:51.457755 (MainThread):   compiled SQL at target\run\jaffle_shop\models\customers.sql
2020-08-22 15:22:51.457755 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2020-08-22 15:22:51.458755 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EC6A76288>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EC6982F08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EC6BD6E48>]}
2020-08-22 15:22:51.458755 (MainThread): Flushing usage events
2020-08-22 15:23:37.717906 (MainThread): Running with dbt=0.17.2
2020-08-22 15:23:38.038486 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['stg_orders'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 15:23:38.039487 (MainThread): Tracking: tracking
2020-08-22 15:23:38.039487 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539307B988>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539307E4C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539307E1C8>]}
2020-08-22 15:23:38.088497 (MainThread): Partial parsing not enabled
2020-08-22 15:23:38.091498 (MainThread): Parsing macros\core.sql
2020-08-22 15:23:38.098697 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:23:38.160711 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:23:38.172713 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:23:38.173714 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:23:38.175714 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:23:38.178715 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:23:38.180715 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:23:38.181716 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:23:38.191718 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:23:38.209722 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:23:38.212723 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:23:38.221724 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:23:38.248730 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:23:38.286739 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:23:38.289740 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:23:38.313746 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:23:38.323748 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:23:38.330750 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:23:38.338752 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:23:38.340752 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:23:38.342753 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:23:38.343753 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:23:38.346754 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:23:38.367759 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:23:38.375760 (MainThread): Parsing macros\etc.sql
2020-08-22 15:23:38.376760 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:23:38.392764 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:23:38.395764 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:23:38.397765 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:23:38.410768 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:23:38.436775 (MainThread): Partial parsing not enabled
2020-08-22 15:23:38.476783 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:23:38.476783 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:23:38.510791 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:23:38.510791 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:23:38.519792 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:23:38.519792 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:23:38.530795 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:23:38.530795 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:23:38.543798 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:23:38.543798 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:23:38.783852 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:23:38.784852 (MainThread): 
2020-08-22 15:23:38.784852 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:23:38.785852 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:23:38.787853 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211".
2020-08-22 15:23:38.787853 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 15:23:39.158415 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:23:39.158415 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:23:39.159407 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:23:39.542056 (MainThread): 10:23:39 | Concurrency: 1 threads (target='dev')
2020-08-22 15:23:39.542820 (MainThread): 10:23:39 | 
2020-08-22 15:23:39.545823 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-08-22 15:23:39.546833 (Thread-1): 10:23:39 | 1 of 1 START view model dbt_alice.stg_orders......................... [RUN]
2020-08-22 15:23:39.547824 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:23:39.547824 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:23:39.547824 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-08-22 15:23:39.564836 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:23:39.565830 (Thread-1): finished collecting timing info
2020-08-22 15:23:39.601845 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:23:39.602837 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


2020-08-22 15:23:40.446699 (Thread-1): finished collecting timing info
2020-08-22 15:23:40.447699 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33a0a418-a2b9-419c-947c-bdd0b50ed017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253932FC888>]}
2020-08-22 15:23:40.448689 (Thread-1): 10:23:40 | 1 of 1 OK created view model dbt_alice.stg_orders.................... [CREATE VIEW in 0.90s]
2020-08-22 15:23:40.448689 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-08-22 15:23:40.524929 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:23:40.524929 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:23:40.525931 (MainThread): 10:23:40 | 
2020-08-22 15:23:40.525931 (MainThread): 10:23:40 | Finished running 1 view model in 1.74s.
2020-08-22 15:23:40.526941 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:23:40.526941 (MainThread): Connection 'list_quick-asset-287211' was properly closed.
2020-08-22 15:23:40.526941 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:23:40.526941 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2020-08-22 15:23:40.530941 (MainThread): 
2020-08-22 15:23:40.530941 (MainThread): Completed successfully
2020-08-22 15:23:40.531932 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-08-22 15:23:40.531932 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539329BEC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253932B5148>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025393207E08>]}
2020-08-22 15:23:40.532933 (MainThread): Flushing usage events
2020-08-22 15:24:49.808883 (MainThread): Running with dbt=0.17.2
2020-08-22 15:24:50.134947 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 15:24:50.135956 (MainThread): Tracking: tracking
2020-08-22 15:24:50.135956 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9EBBCA648>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9EBBCAFC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9EBBCACC8>]}
2020-08-22 15:24:50.184967 (MainThread): Partial parsing not enabled
2020-08-22 15:24:50.187968 (MainThread): Parsing macros\core.sql
2020-08-22 15:24:50.193969 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:24:50.254983 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:24:50.265985 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:24:50.266986 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:24:50.268986 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:24:50.271987 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:24:50.273987 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:24:50.274988 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:24:50.283990 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:24:50.301994 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:24:50.303994 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:24:50.311996 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:24:50.339002 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:24:50.376011 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:24:50.378002 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:24:50.399016 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:24:50.408017 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:24:50.415019 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:24:50.422021 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:24:50.425022 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:24:50.426022 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:24:50.428022 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:24:50.430022 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:24:50.450027 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:24:50.458029 (MainThread): Parsing macros\etc.sql
2020-08-22 15:24:50.459029 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:24:50.475033 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:24:50.478034 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:24:50.481034 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:24:50.493037 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:24:50.518042 (MainThread): Partial parsing not enabled
2020-08-22 15:24:50.559052 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:24:50.559052 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:24:50.592059 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:24:50.593061 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:24:50.605184 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:24:50.605184 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:24:50.618066 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:24:50.618066 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:24:50.629068 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:24:50.629068 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:24:50.867122 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:24:50.868113 (MainThread): 
2020-08-22 15:24:50.869113 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:24:50.869113 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:24:50.877115 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211".
2020-08-22 15:24:50.877115 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 15:24:51.246531 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:24:51.246531 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:24:51.247522 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:24:51.621443 (MainThread): 10:24:51 | Concurrency: 1 threads (target='dev')
2020-08-22 15:24:51.621443 (MainThread): 10:24:51 | 
2020-08-22 15:24:51.625446 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:24:51.626445 (Thread-1): 10:24:51 | 1 of 5 START table model dbt_alice.my_first_dbt_model................ [RUN]
2020-08-22 15:24:51.627446 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:24:51.627446 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:24:51.627446 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-08-22 15:24:51.647459 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:24:51.648450 (Thread-1): finished collecting timing info
2020-08-22 15:24:51.674456 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:24:52.062462 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:24:52.063463 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-08-22 15:24:53.764224 (Thread-1): finished collecting timing info
2020-08-22 15:24:53.765225 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1339cc79-76cd-4af5-9470-f9f1e3f5349f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9EBD71188>]}
2020-08-22 15:24:53.766224 (Thread-1): 10:24:53 | 1 of 5 OK created table model dbt_alice.my_first_dbt_model........... [CREATE TABLE (2) in 2.14s]
2020-08-22 15:24:53.766957 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:24:53.766957 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-08-22 15:24:53.767962 (Thread-1): 10:24:53 | 2 of 5 START view model dbt_alice.stg_customers...................... [RUN]
2020-08-22 15:24:53.768991 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:24:53.768991 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:24:53.768991 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-08-22 15:24:53.773972 (Thread-1): unclosed <socket.socket fd=776, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65099), raddr=('172.217.9.10', 443)>
2020-08-22 15:24:53.773972 (Thread-1): unclosed <socket.socket fd=368, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65098), raddr=('172.217.6.170', 443)>
2020-08-22 15:24:53.775972 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-08-22 15:24:53.776962 (Thread-1): finished collecting timing info
2020-08-22 15:24:53.797976 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2020-08-22 15:24:53.799967 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


2020-08-22 15:24:54.646697 (Thread-1): finished collecting timing info
2020-08-22 15:24:54.646697 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1339cc79-76cd-4af5-9470-f9f1e3f5349f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9EBDB3048>]}
2020-08-22 15:24:54.647697 (Thread-1): 10:24:54 | 2 of 5 OK created view model dbt_alice.stg_customers................. [CREATE VIEW in 0.88s]
2020-08-22 15:24:54.648749 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-08-22 15:24:54.648749 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-08-22 15:24:54.649698 (Thread-1): 10:24:54 | 3 of 5 START view model dbt_alice.stg_orders......................... [RUN]
2020-08-22 15:24:54.650689 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:24:54.650689 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:24:54.650689 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-08-22 15:24:54.655698 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:24:54.657169 (Thread-1): finished collecting timing info
2020-08-22 15:24:54.661171 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:24:54.663172 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


2020-08-22 15:24:55.465333 (Thread-1): finished collecting timing info
2020-08-22 15:24:55.465333 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1339cc79-76cd-4af5-9470-f9f1e3f5349f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9EBE624C8>]}
2020-08-22 15:24:55.466334 (Thread-1): 10:24:55 | 3 of 5 OK created view model dbt_alice.stg_orders.................... [CREATE VIEW in 0.82s]
2020-08-22 15:24:55.467442 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-08-22 15:24:55.467442 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:24:55.468447 (Thread-1): 10:24:55 | 4 of 5 START view model dbt_alice.my_second_dbt_model................ [RUN]
2020-08-22 15:24:55.469446 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:24:55.469446 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:24:55.469446 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-08-22 15:24:55.477457 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:24:55.478457 (Thread-1): finished collecting timing info
2020-08-22 15:24:55.482458 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:24:55.483458 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
where id = 1;


2020-08-22 15:24:56.451147 (Thread-1): finished collecting timing info
2020-08-22 15:24:56.451147 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1339cc79-76cd-4af5-9470-f9f1e3f5349f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9EBE3F408>]}
2020-08-22 15:24:56.452147 (Thread-1): 10:24:56 | 4 of 5 OK created view model dbt_alice.my_second_dbt_model........... [CREATE VIEW in 0.98s]
2020-08-22 15:24:56.453251 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:24:56.453251 (Thread-1): Began running node model.jaffle_shop.customers
2020-08-22 15:24:56.454256 (Thread-1): 10:24:56 | 5 of 5 START view model dbt_alice.customers.......................... [RUN]
2020-08-22 15:24:56.454256 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:24:56.455255 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:24:56.455255 (Thread-1): Compiling model.jaffle_shop.customers
2020-08-22 15:24:56.458264 (Thread-1): unclosed <socket.socket fd=1192, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65104), raddr=('172.217.6.170', 443)>
2020-08-22 15:24:56.458264 (Thread-1): unclosed <socket.socket fd=1204, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65105), raddr=('172.217.9.10', 443)>
2020-08-22 15:24:56.464265 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-08-22 15:24:56.465265 (Thread-1): finished collecting timing info
2020-08-22 15:24:56.469267 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-08-22 15:24:56.470268 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`customers`
  OPTIONS()
  as with customers as (

    select * from `quick-asset-287211`.`dbt_alice`.`stg_customers`

),

orders as (

    select * from `quick-asset-287211`.`dbt_alice`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2020-08-22 15:24:57.403708 (Thread-1): finished collecting timing info
2020-08-22 15:24:57.403708 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1339cc79-76cd-4af5-9470-f9f1e3f5349f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9EBE85308>]}
2020-08-22 15:24:57.404708 (Thread-1): 10:24:57 | 5 of 5 OK created view model dbt_alice.customers..................... [CREATE VIEW in 0.95s]
2020-08-22 15:24:57.405908 (Thread-1): Finished running node model.jaffle_shop.customers
2020-08-22 15:24:57.429670 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:24:57.429670 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:24:57.430671 (MainThread): 10:24:57 | 
2020-08-22 15:24:57.430947 (MainThread): 10:24:57 | Finished running 1 table model, 4 view models in 6.56s.
2020-08-22 15:24:57.431953 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:24:57.431953 (MainThread): Connection 'list_quick-asset-287211' was properly closed.
2020-08-22 15:24:57.431953 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:24:57.431953 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2020-08-22 15:24:57.447084 (MainThread): 
2020-08-22 15:24:57.447084 (MainThread): Completed successfully
2020-08-22 15:24:57.447954 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2020-08-22 15:24:57.447954 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9EBE6F208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9EBE8B988>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9EBE87548>]}
2020-08-22 15:24:57.447954 (MainThread): Flushing usage events
2020-08-22 15:26:48.149402 (MainThread): Running with dbt=0.17.2
2020-08-22 15:26:48.474474 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['models\\staging'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 15:26:48.475475 (MainThread): Tracking: tracking
2020-08-22 15:26:48.475475 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F9E90CE48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F9E90D288>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F9E90D488>]}
2020-08-22 15:26:48.525477 (MainThread): Partial parsing not enabled
2020-08-22 15:26:48.529487 (MainThread): Parsing macros\core.sql
2020-08-22 15:26:48.535488 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:26:48.598494 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:26:48.609497 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:26:48.611498 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:26:48.613498 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:26:48.615498 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:26:48.618499 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:26:48.619626 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:26:48.629509 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:26:48.647591 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:26:48.650515 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:26:48.658516 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:26:48.685523 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:26:48.723531 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:26:48.725532 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:26:48.747527 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:26:48.756538 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:26:48.763540 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:26:48.771541 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:26:48.773533 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:26:48.775760 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:26:48.776767 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:26:48.778782 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:26:48.800548 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:26:48.808550 (MainThread): Parsing macros\etc.sql
2020-08-22 15:26:48.809550 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:26:48.826554 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:26:48.829554 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:26:48.832555 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:26:48.845549 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:26:48.871564 (MainThread): Partial parsing not enabled
2020-08-22 15:26:48.913573 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:26:48.913573 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:26:48.948581 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:26:48.948581 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:26:48.962584 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:26:48.962584 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:26:48.975588 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:26:48.975588 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:26:48.986581 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:26:48.986581 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:26:49.234648 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:26:49.236638 (MainThread): 
2020-08-22 15:26:49.236638 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:26:49.237638 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:26:49.240638 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211".
2020-08-22 15:26:49.241639 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 15:26:49.635836 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:26:49.635836 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:26:49.636848 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:26:49.988846 (MainThread): 10:26:49 | Concurrency: 1 threads (target='dev')
2020-08-22 15:26:49.988846 (MainThread): 10:26:49 | 
2020-08-22 15:26:49.991811 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-08-22 15:26:49.993822 (Thread-1): 10:26:49 | 1 of 2 START view model dbt_alice.stg_customers...................... [RUN]
2020-08-22 15:26:49.993822 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:26:49.993822 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:26:49.993822 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-08-22 15:26:50.010821 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-08-22 15:26:50.011822 (Thread-1): finished collecting timing info
2020-08-22 15:26:50.045834 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2020-08-22 15:26:50.047826 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


2020-08-22 15:26:50.862609 (Thread-1): finished collecting timing info
2020-08-22 15:26:50.863610 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '568530ea-b08f-485d-9a91-e8a7f1ef2481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F9EAFE4C8>]}
2020-08-22 15:26:50.864611 (Thread-1): 10:26:50 | 1 of 2 OK created view model dbt_alice.stg_customers................. [CREATE VIEW in 0.87s]
2020-08-22 15:26:50.865602 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-08-22 15:26:50.865602 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-08-22 15:26:50.866602 (Thread-1): 10:26:50 | 2 of 2 START view model dbt_alice.stg_orders......................... [RUN]
2020-08-22 15:26:50.867208 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:26:50.867208 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:26:50.867208 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-08-22 15:26:50.873220 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:26:50.873220 (Thread-1): finished collecting timing info
2020-08-22 15:26:50.878221 (Thread-1): unclosed <socket.socket fd=1032, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65128), raddr=('172.217.9.10', 443)>
2020-08-22 15:26:50.878221 (Thread-1): unclosed <socket.socket fd=1028, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65127), raddr=('216.58.193.138', 443)>
2020-08-22 15:26:50.879222 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:26:50.880214 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


2020-08-22 15:26:51.627893 (Thread-1): finished collecting timing info
2020-08-22 15:26:51.628893 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '568530ea-b08f-485d-9a91-e8a7f1ef2481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F9EAEE488>]}
2020-08-22 15:26:51.629893 (Thread-1): 10:26:51 | 2 of 2 OK created view model dbt_alice.stg_orders.................... [CREATE VIEW in 0.76s]
2020-08-22 15:26:51.630896 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-08-22 15:26:51.632894 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:26:51.632894 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:26:51.633885 (MainThread): 10:26:51 | 
2020-08-22 15:26:51.633885 (MainThread): 10:26:51 | Finished running 2 view models in 2.40s.
2020-08-22 15:26:51.633885 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:26:51.634886 (MainThread): Connection 'list_quick-asset-287211' was properly closed.
2020-08-22 15:26:51.634886 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:26:51.634886 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2020-08-22 15:26:51.640896 (MainThread): 
2020-08-22 15:26:51.641887 (MainThread): Completed successfully
2020-08-22 15:26:51.641887 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-08-22 15:26:51.642887 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F9A6633C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F9EA211C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F9EB39F88>]}
2020-08-22 15:26:51.642887 (MainThread): Flushing usage events
2020-08-22 15:27:12.160765 (MainThread): Running with dbt=0.17.2
2020-08-22 15:27:12.487721 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-08-22 15:27:12.488721 (MainThread): Tracking: tracking
2020-08-22 15:27:12.488721 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F5659B9C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F5659D488>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F5659D4C8>]}
2020-08-22 15:27:12.538732 (MainThread): Partial parsing not enabled
2020-08-22 15:27:12.541733 (MainThread): Parsing macros\core.sql
2020-08-22 15:27:12.547734 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:27:12.609749 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:27:12.621751 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:27:12.622752 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:27:12.624753 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:27:12.627752 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:27:12.629752 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:27:12.630753 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:27:12.639756 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:27:12.657760 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:27:12.659759 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:27:12.668762 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:27:12.694768 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:27:12.731777 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:27:12.733777 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:27:12.754782 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:27:12.763783 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:27:12.769784 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:27:12.777786 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:27:12.779786 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:27:12.781787 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:27:12.782787 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:27:12.784788 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:27:12.805784 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:27:12.813794 (MainThread): Parsing macros\etc.sql
2020-08-22 15:27:12.814794 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:27:12.830798 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:27:12.833899 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:27:12.836799 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:27:12.849793 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:27:12.874808 (MainThread): Partial parsing not enabled
2020-08-22 15:27:12.914817 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:27:12.914817 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:27:12.948816 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:27:12.948816 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:27:12.961827 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:27:12.961827 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:27:12.973830 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:27:12.973830 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:27:12.983832 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:27:12.983832 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:27:13.241891 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:27:13.242882 (MainThread): 
2020-08-22 15:27:13.243883 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:27:13.243883 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:27:13.256977 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:27:13.257896 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:27:13.257896 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:27:13.579109 (MainThread): 10:27:13 | Concurrency: 1 threads (target='dev')
2020-08-22 15:27:13.579372 (MainThread): 10:27:13 | 
2020-08-22 15:27:13.581893 (Thread-1): Began running node test.jaffle_shop.not_null_my_first_dbt_model_id
2020-08-22 15:27:13.581893 (Thread-1): 10:27:13 | 1 of 4 START test not_null_my_first_dbt_model_id..................... [RUN]
2020-08-22 15:27:13.582894 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_my_first_dbt_model_id".
2020-08-22 15:27:13.582894 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:27:13.582894 (Thread-1): Compiling test.jaffle_shop.not_null_my_first_dbt_model_id
2020-08-22 15:27:13.603908 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_my_first_dbt_model_id"
2020-08-22 15:27:13.605900 (Thread-1): finished collecting timing info
2020-08-22 15:27:13.606900 (Thread-1): On test.jaffle_shop.not_null_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_my_first_dbt_model_id"} */




select count(*) as validation_errors
from `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
where id is null


2020-08-22 15:27:14.851583 (Thread-1): finished collecting timing info
2020-08-22 15:27:14.852592 (Thread-1): 10:27:14 | 1 of 4 FAIL 1 not_null_my_first_dbt_model_id......................... [FAIL 1 in 1.27s]
2020-08-22 15:27:14.853592 (Thread-1): Finished running node test.jaffle_shop.not_null_my_first_dbt_model_id
2020-08-22 15:27:14.853592 (Thread-1): Began running node test.jaffle_shop.not_null_my_second_dbt_model_id
2020-08-22 15:27:14.853592 (Thread-1): 10:27:14 | 2 of 4 START test not_null_my_second_dbt_model_id.................... [RUN]
2020-08-22 15:27:14.853592 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_my_second_dbt_model_id".
2020-08-22 15:27:14.853592 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:27:14.854583 (Thread-1): Compiling test.jaffle_shop.not_null_my_second_dbt_model_id
2020-08-22 15:27:14.854583 (Thread-1): unclosed <socket.socket fd=676, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65142), raddr=('216.58.193.138', 443)>
2020-08-22 15:27:14.855584 (Thread-1): unclosed <socket.socket fd=908, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65143), raddr=('172.217.9.10', 443)>
2020-08-22 15:27:14.864594 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_my_second_dbt_model_id"
2020-08-22 15:27:14.865595 (Thread-1): finished collecting timing info
2020-08-22 15:27:14.866587 (Thread-1): On test.jaffle_shop.not_null_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_my_second_dbt_model_id"} */




select count(*) as validation_errors
from `quick-asset-287211`.`dbt_alice`.`my_second_dbt_model`
where id is null


2020-08-22 15:27:16.131197 (Thread-1): finished collecting timing info
2020-08-22 15:27:16.132198 (Thread-1): 10:27:16 | 2 of 4 PASS not_null_my_second_dbt_model_id.......................... [PASS in 1.28s]
2020-08-22 15:27:16.133198 (Thread-1): Finished running node test.jaffle_shop.not_null_my_second_dbt_model_id
2020-08-22 15:27:16.133198 (Thread-1): Began running node test.jaffle_shop.unique_my_first_dbt_model_id
2020-08-22 15:27:16.133198 (Thread-1): 10:27:16 | 3 of 4 START test unique_my_first_dbt_model_id....................... [RUN]
2020-08-22 15:27:16.133198 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_my_first_dbt_model_id".
2020-08-22 15:27:16.133198 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:27:16.134198 (Thread-1): Compiling test.jaffle_shop.unique_my_first_dbt_model_id
2020-08-22 15:27:16.139208 (Thread-1): unclosed <socket.socket fd=948, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65144), raddr=('216.58.193.138', 443)>
2020-08-22 15:27:16.139208 (Thread-1): unclosed <socket.socket fd=1028, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65145), raddr=('172.217.9.10', 443)>
2020-08-22 15:27:16.144209 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_my_first_dbt_model_id"
2020-08-22 15:27:16.145200 (Thread-1): finished collecting timing info
2020-08-22 15:27:16.146205 (Thread-1): On test.jaffle_shop.unique_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_my_first_dbt_model_id"} */




select count(*) as validation_errors
from (

    select
        id

    from `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
    where id is not null
    group by id
    having count(*) > 1

) validation_errors


2020-08-22 15:27:17.508135 (Thread-1): finished collecting timing info
2020-08-22 15:27:17.508135 (Thread-1): 10:27:17 | 3 of 4 PASS unique_my_first_dbt_model_id............................. [PASS in 1.37s]
2020-08-22 15:27:17.509127 (Thread-1): Finished running node test.jaffle_shop.unique_my_first_dbt_model_id
2020-08-22 15:27:17.509127 (Thread-1): Began running node test.jaffle_shop.unique_my_second_dbt_model_id
2020-08-22 15:27:17.509127 (Thread-1): 10:27:17 | 4 of 4 START test unique_my_second_dbt_model_id...................... [RUN]
2020-08-22 15:27:17.509127 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_my_second_dbt_model_id".
2020-08-22 15:27:17.510127 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:27:17.510127 (Thread-1): Compiling test.jaffle_shop.unique_my_second_dbt_model_id
2020-08-22 15:27:17.519137 (Thread-1): unclosed <socket.socket fd=1076, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65146), raddr=('216.58.193.138', 443)>
2020-08-22 15:27:17.519137 (Thread-1): unclosed <socket.socket fd=696, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65147), raddr=('172.217.9.10', 443)>
2020-08-22 15:27:17.524138 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_my_second_dbt_model_id"
2020-08-22 15:27:17.525131 (Thread-1): finished collecting timing info
2020-08-22 15:27:17.525131 (Thread-1): On test.jaffle_shop.unique_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_my_second_dbt_model_id"} */




select count(*) as validation_errors
from (

    select
        id

    from `quick-asset-287211`.`dbt_alice`.`my_second_dbt_model`
    where id is not null
    group by id
    having count(*) > 1

) validation_errors


2020-08-22 15:27:18.727283 (Thread-1): finished collecting timing info
2020-08-22 15:27:18.727283 (Thread-1): 10:27:18 | 4 of 4 PASS unique_my_second_dbt_model_id............................ [PASS in 1.22s]
2020-08-22 15:27:18.728027 (Thread-1): Finished running node test.jaffle_shop.unique_my_second_dbt_model_id
2020-08-22 15:27:18.730907 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:27:18.730907 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:27:18.731912 (MainThread): 10:27:18 | 
2020-08-22 15:27:18.732123 (MainThread): 10:27:18 | Finished running 4 tests in 5.49s.
2020-08-22 15:27:18.732123 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:27:18.732123 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:27:18.732123 (MainThread): Connection 'test.jaffle_shop.unique_my_second_dbt_model_id' was properly closed.
2020-08-22 15:27:18.745137 (MainThread): 
2020-08-22 15:27:18.745137 (MainThread): Completed with 1 error and 0 warnings:
2020-08-22 15:27:18.747130 (MainThread): 
2020-08-22 15:27:18.747130 (MainThread): Failure in test not_null_my_first_dbt_model_id (models\example\schema.yml)
2020-08-22 15:27:18.748129 (MainThread):   Got 1 result, expected 0.
2020-08-22 15:27:18.748129 (MainThread): 
2020-08-22 15:27:18.749130 (MainThread):   compiled SQL at target\compiled\jaffle_shop\models\example\schema.yml\schema_test\not_null_my_first_dbt_model_id.sql
2020-08-22 15:27:18.749130 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2020-08-22 15:27:18.750130 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F568AB988>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F56607B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F56719408>]}
2020-08-22 15:27:18.750130 (MainThread): Flushing usage events
2020-08-22 15:27:18.944188 (MainThread): unclosed <socket.socket fd=776, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65148), raddr=('216.58.193.138', 443)>
2020-08-22 15:27:18.945190 (MainThread): unclosed <socket.socket fd=1028, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65149), raddr=('172.217.9.10', 443)>
2020-08-22 15:30:12.436617 (MainThread): Running with dbt=0.17.2
2020-08-22 15:30:12.769378 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.clean.CleanTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='clean', write_json=True)
2020-08-22 15:30:12.769378 (MainThread): Tracking: tracking
2020-08-22 15:30:12.770498 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C18DA93D08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C190005AC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1914F1348>]}
2020-08-22 15:30:12.770498 (MainThread): Checking target/*
2020-08-22 15:30:12.778310 (MainThread):  Cleaned target/*
2020-08-22 15:30:12.778310 (MainThread): Checking dbt_modules/*
2020-08-22 15:30:12.779310 (MainThread):  Cleaned dbt_modules/*
2020-08-22 15:30:12.779310 (MainThread): Finished cleaning all paths.
2020-08-22 15:30:12.780311 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C19001A408>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C18FFFCAC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C18DA93D08>]}
2020-08-22 15:30:12.780311 (MainThread): Flushing usage events
2020-08-22 15:30:25.946621 (MainThread): Running with dbt=0.17.2
2020-08-22 15:30:26.264964 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 15:30:26.265966 (MainThread): Tracking: tracking
2020-08-22 15:30:26.265966 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F72ECFA388>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F72ECE7C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7301DAD88>]}
2020-08-22 15:30:26.314976 (MainThread): Partial parsing not enabled
2020-08-22 15:30:26.317976 (MainThread): Parsing macros\core.sql
2020-08-22 15:30:26.323978 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:30:26.384992 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:30:26.395993 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:30:26.396993 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:30:26.398995 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:30:26.401995 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:30:26.403995 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:30:26.404996 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:30:26.414998 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:30:26.433002 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:30:26.436002 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:30:26.444006 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:30:26.470010 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:30:26.507019 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:30:26.509018 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:30:26.530239 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:30:26.540026 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:30:26.547018 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:30:26.555020 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:30:26.557020 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:30:26.559021 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:30:26.560021 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:30:26.562022 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:30:26.582026 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:30:26.590028 (MainThread): Parsing macros\etc.sql
2020-08-22 15:30:26.591028 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:30:26.607032 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:30:26.611033 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:30:26.613033 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:30:26.626036 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:30:26.651042 (MainThread): Partial parsing not enabled
2020-08-22 15:30:26.691060 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:30:26.691060 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:30:26.725067 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:30:26.725067 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:30:26.738070 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:30:26.738070 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:30:26.750073 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:30:26.750073 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:30:26.760076 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:30:26.760076 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:30:27.009122 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:30:27.010123 (MainThread): 
2020-08-22 15:30:27.011124 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:30:27.011124 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:30:27.019125 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211".
2020-08-22 15:30:27.019125 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 15:30:27.401874 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:30:27.402876 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:30:27.402876 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:30:27.791968 (MainThread): 10:30:27 | Concurrency: 1 threads (target='dev')
2020-08-22 15:30:27.791968 (MainThread): 10:30:27 | 
2020-08-22 15:30:27.796472 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:30:27.797475 (Thread-1): 10:30:27 | 1 of 5 START table model dbt_alice.my_first_dbt_model................ [RUN]
2020-08-22 15:30:27.798001 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:30:27.798001 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:30:27.798001 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-08-22 15:30:27.818016 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:30:27.820009 (Thread-1): finished collecting timing info
2020-08-22 15:30:27.847015 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:30:28.233850 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:30:28.235851 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-08-22 15:30:29.985653 (Thread-1): finished collecting timing info
2020-08-22 15:30:29.986654 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a5f8d4e-a646-4e69-a004-315639e0d801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7304186C8>]}
2020-08-22 15:30:29.987837 (Thread-1): 10:30:29 | 1 of 5 OK created table model dbt_alice.my_first_dbt_model........... [CREATE TABLE (2) in 2.19s]
2020-08-22 15:30:29.988727 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:30:29.988727 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-08-22 15:30:29.989653 (Thread-1): 10:30:29 | 2 of 5 START view model dbt_alice.stg_customers...................... [RUN]
2020-08-22 15:30:29.990645 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:30:29.990645 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:30:29.990645 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-08-22 15:30:29.995655 (Thread-1): unclosed <socket.socket fd=740, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65182), raddr=('172.217.9.10', 443)>
2020-08-22 15:30:29.995655 (Thread-1): unclosed <socket.socket fd=672, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65181), raddr=('216.58.193.138', 443)>
2020-08-22 15:30:29.996646 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-08-22 15:30:29.998647 (Thread-1): finished collecting timing info
2020-08-22 15:30:30.019651 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2020-08-22 15:30:30.020652 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


2020-08-22 15:30:30.834720 (Thread-1): finished collecting timing info
2020-08-22 15:30:30.834720 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a5f8d4e-a646-4e69-a004-315639e0d801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7303C3088>]}
2020-08-22 15:30:30.836721 (Thread-1): 10:30:30 | 2 of 5 OK created view model dbt_alice.stg_customers................. [CREATE VIEW in 0.85s]
2020-08-22 15:30:30.836721 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-08-22 15:30:30.836721 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-08-22 15:30:30.838713 (Thread-1): 10:30:30 | 3 of 5 START view model dbt_alice.stg_orders......................... [RUN]
2020-08-22 15:30:30.838713 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:30:30.838713 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:30:30.839712 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-08-22 15:30:30.844714 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:30:30.845714 (Thread-1): finished collecting timing info
2020-08-22 15:30:30.850724 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:30:30.851716 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


2020-08-22 15:30:31.939712 (Thread-1): finished collecting timing info
2020-08-22 15:30:31.940712 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a5f8d4e-a646-4e69-a004-315639e0d801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F730487788>]}
2020-08-22 15:30:31.941712 (Thread-1): 10:30:31 | 3 of 5 OK created view model dbt_alice.stg_orders.................... [CREATE VIEW in 1.10s]
2020-08-22 15:30:31.942797 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-08-22 15:30:31.942797 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:30:31.943713 (Thread-1): 10:30:31 | 4 of 5 START view model dbt_alice.my_second_dbt_model................ [RUN]
2020-08-22 15:30:31.944705 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:30:31.944705 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:30:31.944705 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-08-22 15:30:31.952715 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:30:31.953800 (Thread-1): finished collecting timing info
2020-08-22 15:30:31.958716 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:30:31.959708 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
where id = 1;


2020-08-22 15:30:32.980977 (Thread-1): finished collecting timing info
2020-08-22 15:30:32.981977 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a5f8d4e-a646-4e69-a004-315639e0d801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7305B1288>]}
2020-08-22 15:30:32.982977 (Thread-1): 10:30:32 | 4 of 5 OK created view model dbt_alice.my_second_dbt_model........... [CREATE VIEW in 1.04s]
2020-08-22 15:30:32.983969 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:30:32.983969 (Thread-1): Began running node model.jaffle_shop.customers
2020-08-22 15:30:32.984969 (Thread-1): 10:30:32 | 5 of 5 START view model dbt_alice.customers.......................... [RUN]
2020-08-22 15:30:32.985477 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:30:32.985477 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:30:32.985477 (Thread-1): Compiling model.jaffle_shop.customers
2020-08-22 15:30:32.988490 (Thread-1): unclosed <socket.socket fd=1136, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65187), raddr=('216.58.193.138', 443)>
2020-08-22 15:30:32.988490 (Thread-1): unclosed <socket.socket fd=1144, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65188), raddr=('172.217.9.10', 443)>
2020-08-22 15:30:32.994492 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-08-22 15:30:32.995491 (Thread-1): finished collecting timing info
2020-08-22 15:30:33.000492 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-08-22 15:30:33.001484 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`customers`
  OPTIONS()
  as with customers as (

    select * from `quick-asset-287211`.`dbt_alice`.`stg_customers`

),

orders as (

    select * from `quick-asset-287211`.`dbt_alice`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2020-08-22 15:30:33.962748 (Thread-1): finished collecting timing info
2020-08-22 15:30:33.963748 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a5f8d4e-a646-4e69-a004-315639e0d801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7304A3208>]}
2020-08-22 15:30:33.964748 (Thread-1): 10:30:33 | 5 of 5 OK created view model dbt_alice.customers..................... [CREATE VIEW in 0.98s]
2020-08-22 15:30:33.965365 (Thread-1): Finished running node model.jaffle_shop.customers
2020-08-22 15:30:34.035235 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:30:34.035235 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:30:34.036237 (MainThread): 10:30:34 | 
2020-08-22 15:30:34.036424 (MainThread): 10:30:34 | Finished running 1 table model, 4 view models in 7.02s.
2020-08-22 15:30:34.037429 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:30:34.037429 (MainThread): Connection 'list_quick-asset-287211' was properly closed.
2020-08-22 15:30:34.037429 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:30:34.037429 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2020-08-22 15:30:34.052441 (MainThread): 
2020-08-22 15:30:34.053430 (MainThread): Completed successfully
2020-08-22 15:30:34.053430 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2020-08-22 15:30:34.054430 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7305D6A48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7303FC688>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F730472688>]}
2020-08-22 15:30:34.054430 (MainThread): Flushing usage events
2020-08-22 15:30:49.515237 (MainThread): Running with dbt=0.17.2
2020-08-22 15:30:49.839456 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.clean.CleanTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='clean', write_json=True)
2020-08-22 15:30:49.840456 (MainThread): Tracking: tracking
2020-08-22 15:30:49.841456 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CC74A5C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CCAF011C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CCAEFC688>]}
2020-08-22 15:30:49.841456 (MainThread): Checking target/*
2020-08-22 15:30:49.846855 (MainThread):  Cleaned target/*
2020-08-22 15:30:49.846855 (MainThread): Checking dbt_modules/*
2020-08-22 15:30:49.847855 (MainThread):  Cleaned dbt_modules/*
2020-08-22 15:30:49.848855 (MainThread): Finished cleaning all paths.
2020-08-22 15:30:49.848855 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CCAF011C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CCAF01488>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CCAEF7F08>]}
2020-08-22 15:30:49.848855 (MainThread): Flushing usage events
2020-08-22 15:30:59.996186 (MainThread): Running with dbt=0.17.2
2020-08-22 15:31:00.314286 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.clean.CleanTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='clean', write_json=True)
2020-08-22 15:31:00.314286 (MainThread): Tracking: tracking
2020-08-22 15:31:00.315277 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E2EA4888>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E68FD288>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E6903688>]}
2020-08-22 15:31:00.315277 (MainThread): Checking target/*
2020-08-22 15:31:00.315918 (MainThread):  Cleaned target/*
2020-08-22 15:31:00.316930 (MainThread): Checking dbt_modules/*
2020-08-22 15:31:00.316930 (MainThread):  Cleaned dbt_modules/*
2020-08-22 15:31:00.317921 (MainThread): Finished cleaning all paths.
2020-08-22 15:31:00.317921 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E68FA6C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E68FD288>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E69023C8>]}
2020-08-22 15:31:00.317921 (MainThread): Flushing usage events
2020-08-22 15:31:08.319787 (MainThread): Running with dbt=0.17.2
2020-08-22 15:31:08.640867 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 15:31:08.641868 (MainThread): Tracking: tracking
2020-08-22 15:31:08.642859 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFFDEB4C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFFDEBC48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFFDEBAC8>]}
2020-08-22 15:31:08.690879 (MainThread): Partial parsing not enabled
2020-08-22 15:31:08.694880 (MainThread): Parsing macros\core.sql
2020-08-22 15:31:08.700881 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:31:08.764895 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:31:08.776898 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:31:08.777899 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:31:08.779899 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:31:08.782899 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:31:08.784900 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:31:08.786900 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:31:08.796903 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:31:08.814908 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:31:08.818043 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:31:08.826911 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:31:08.854906 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:31:08.893924 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:31:08.896925 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:31:08.918920 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:31:08.927923 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:31:08.933924 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:31:08.942926 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:31:08.945927 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:31:08.946927 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:31:08.948927 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:31:08.950928 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:31:08.971933 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:31:08.980935 (MainThread): Parsing macros\etc.sql
2020-08-22 15:31:08.980935 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:31:08.998939 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:31:09.001939 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:31:09.004940 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:31:09.017944 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:31:09.043949 (MainThread): Partial parsing not enabled
2020-08-22 15:31:09.086968 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:31:09.086968 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:31:09.121976 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:31:09.121976 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:31:09.133979 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:31:09.133979 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:31:09.145981 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:31:09.145981 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:31:09.155984 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:31:09.155984 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:31:09.409032 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:31:09.426035 (MainThread): 
2020-08-22 15:31:09.427035 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:31:09.428036 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:31:09.435047 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211".
2020-08-22 15:31:09.436047 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 15:31:09.771122 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:31:09.771122 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:31:09.772123 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:31:10.119191 (MainThread): 10:31:10 | Concurrency: 1 threads (target='dev')
2020-08-22 15:31:10.119191 (MainThread): 10:31:10 | 
2020-08-22 15:31:10.123192 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:31:10.124192 (Thread-1): 10:31:10 | 1 of 5 START table model dbt_alice.my_first_dbt_model................ [RUN]
2020-08-22 15:31:10.125192 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:31:10.125192 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:31:10.125192 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-08-22 15:31:10.145197 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:31:10.147198 (Thread-1): finished collecting timing info
2020-08-22 15:31:10.175204 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:31:10.521292 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:31:10.523283 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-08-22 15:31:12.242055 (Thread-1): finished collecting timing info
2020-08-22 15:31:12.243055 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11f11730-f9d7-4b59-b268-1570481be806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFFFAB388>]}
2020-08-22 15:31:12.244055 (Thread-1): 10:31:12 | 1 of 5 OK created table model dbt_alice.my_first_dbt_model........... [CREATE TABLE (2) in 2.12s]
2020-08-22 15:31:12.244055 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:31:12.245055 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-08-22 15:31:12.246056 (Thread-1): 10:31:12 | 2 of 5 START view model dbt_alice.stg_customers...................... [RUN]
2020-08-22 15:31:12.246056 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:31:12.247057 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:31:12.247057 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-08-22 15:31:12.252057 (Thread-1): unclosed <socket.socket fd=940, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65207), raddr=('172.217.9.10', 443)>
2020-08-22 15:31:12.252057 (Thread-1): unclosed <socket.socket fd=936, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65206), raddr=('216.58.193.138', 443)>
2020-08-22 15:31:12.254057 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-08-22 15:31:12.256058 (Thread-1): finished collecting timing info
2020-08-22 15:31:12.277062 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2020-08-22 15:31:12.279064 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


2020-08-22 15:31:13.011228 (Thread-1): finished collecting timing info
2020-08-22 15:31:13.012228 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11f11730-f9d7-4b59-b268-1570481be806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E80FE2388>]}
2020-08-22 15:31:13.013228 (Thread-1): 10:31:13 | 2 of 5 OK created view model dbt_alice.stg_customers................. [CREATE VIEW in 0.77s]
2020-08-22 15:31:13.013228 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-08-22 15:31:13.013228 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-08-22 15:31:13.015229 (Thread-1): 10:31:13 | 3 of 5 START view model dbt_alice.stg_orders......................... [RUN]
2020-08-22 15:31:13.015229 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:31:13.015229 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:31:13.015229 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-08-22 15:31:13.021230 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:31:13.022231 (Thread-1): finished collecting timing info
2020-08-22 15:31:13.026231 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:31:13.027231 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


2020-08-22 15:31:13.750453 (Thread-1): finished collecting timing info
2020-08-22 15:31:13.751445 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11f11730-f9d7-4b59-b268-1570481be806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E81063608>]}
2020-08-22 15:31:13.752454 (Thread-1): 10:31:13 | 3 of 5 OK created view model dbt_alice.stg_orders.................... [CREATE VIEW in 0.74s]
2020-08-22 15:31:13.753445 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-08-22 15:31:13.753445 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:31:13.754446 (Thread-1): 10:31:13 | 4 of 5 START view model dbt_alice.my_second_dbt_model................ [RUN]
2020-08-22 15:31:13.755445 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:31:13.755445 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:31:13.755445 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-08-22 15:31:13.764447 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:31:13.765448 (Thread-1): finished collecting timing info
2020-08-22 15:31:13.771458 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:31:13.772449 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
where id = 1;


2020-08-22 15:31:14.647055 (Thread-1): finished collecting timing info
2020-08-22 15:31:14.647055 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11f11730-f9d7-4b59-b268-1570481be806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E81063608>]}
2020-08-22 15:31:14.648107 (Thread-1): 10:31:14 | 4 of 5 OK created view model dbt_alice.my_second_dbt_model........... [CREATE VIEW in 0.89s]
2020-08-22 15:31:14.649047 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:31:14.649047 (Thread-1): Began running node model.jaffle_shop.customers
2020-08-22 15:31:14.650056 (Thread-1): 10:31:14 | 5 of 5 START view model dbt_alice.customers.......................... [RUN]
2020-08-22 15:31:14.650945 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:31:14.650945 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:31:14.650945 (Thread-1): Compiling model.jaffle_shop.customers
2020-08-22 15:31:14.654017 (Thread-1): unclosed <socket.socket fd=1112, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65215), raddr=('216.58.193.138', 443)>
2020-08-22 15:31:14.654017 (Thread-1): unclosed <socket.socket fd=1164, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65216), raddr=('172.217.9.10', 443)>
2020-08-22 15:31:14.659959 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-08-22 15:31:14.660960 (Thread-1): finished collecting timing info
2020-08-22 15:31:14.665961 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-08-22 15:31:14.666952 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`customers`
  OPTIONS()
  as with customers as (

    select * from `quick-asset-287211`.`dbt_alice`.`stg_customers`

),

orders as (

    select * from `quick-asset-287211`.`dbt_alice`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2020-08-22 15:31:15.456817 (Thread-1): finished collecting timing info
2020-08-22 15:31:15.456817 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11f11730-f9d7-4b59-b268-1570481be806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E8120EEC8>]}
2020-08-22 15:31:15.457816 (Thread-1): 10:31:15 | 5 of 5 OK created view model dbt_alice.customers..................... [CREATE VIEW in 0.81s]
2020-08-22 15:31:15.458809 (Thread-1): Finished running node model.jaffle_shop.customers
2020-08-22 15:31:15.537066 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:31:15.537066 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:31:15.538058 (MainThread): 10:31:15 | 
2020-08-22 15:31:15.538330 (MainThread): 10:31:15 | Finished running 1 table model, 4 view models in 6.11s.
2020-08-22 15:31:15.539335 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:31:15.539335 (MainThread): Connection 'list_quick-asset-287211' was properly closed.
2020-08-22 15:31:15.539335 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:31:15.539335 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2020-08-22 15:31:15.555399 (MainThread): 
2020-08-22 15:31:15.555399 (MainThread): Completed successfully
2020-08-22 15:31:15.556410 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2020-08-22 15:31:15.557401 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFFFF2448>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E81056EC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E811CF0C8>]}
2020-08-22 15:31:15.557401 (MainThread): Flushing usage events
2020-08-22 15:32:14.218157 (MainThread): Running with dbt=0.17.2
2020-08-22 15:32:14.540879 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.clean.CleanTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='clean', write_json=True)
2020-08-22 15:32:14.540879 (MainThread): Tracking: tracking
2020-08-22 15:32:14.541880 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013816276B08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013819CAF888>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013819CCE208>]}
2020-08-22 15:32:14.541880 (MainThread): Checking target/*
2020-08-22 15:32:14.546871 (MainThread):  Cleaned target/*
2020-08-22 15:32:14.547872 (MainThread): Checking dbt_modules/*
2020-08-22 15:32:14.548872 (MainThread):  Cleaned dbt_modules/*
2020-08-22 15:32:14.548872 (MainThread): Finished cleaning all paths.
2020-08-22 15:32:14.549873 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013819CD24C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013818B4D8C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013816276B08>]}
2020-08-22 15:32:14.549873 (MainThread): Flushing usage events
2020-08-22 15:32:28.692077 (MainThread): Running with dbt=0.17.2
2020-08-22 15:32:29.012149 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 15:32:29.012149 (MainThread): Tracking: tracking
2020-08-22 15:32:29.013325 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDCC4A848>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDCC4ACC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDCC4AC48>]}
2020-08-22 15:32:29.061159 (MainThread): Partial parsing not enabled
2020-08-22 15:32:29.064160 (MainThread): Parsing macros\core.sql
2020-08-22 15:32:29.070161 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:32:29.137177 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:32:29.149179 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:32:29.150180 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:32:29.152180 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:32:29.155181 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:32:29.157181 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:32:29.158181 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:32:29.168183 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:32:29.186188 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:32:29.189189 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:32:29.197295 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:32:29.225196 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:32:29.263205 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:32:29.265206 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:32:29.287211 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:32:29.296213 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:32:29.303214 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:32:29.312216 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:32:29.315217 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:32:29.317218 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:32:29.318218 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:32:29.321219 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:32:29.345224 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:32:29.354217 (MainThread): Parsing macros\etc.sql
2020-08-22 15:32:29.355217 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:32:29.373230 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:32:29.377231 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:32:29.379232 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:32:29.394226 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:32:29.423242 (MainThread): Partial parsing not enabled
2020-08-22 15:32:29.466242 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:32:29.467252 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:32:29.502251 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:32:29.503261 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:32:29.515262 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:32:29.515262 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:32:29.528266 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:32:29.528266 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:32:29.539259 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:32:29.539259 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:32:29.795316 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:32:29.796317 (MainThread): 
2020-08-22 15:32:29.798317 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:32:29.798317 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:32:29.806319 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211".
2020-08-22 15:32:29.806319 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 15:32:30.217604 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:32:30.218605 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:32:30.218605 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:32:30.578664 (MainThread): 10:32:30 | Concurrency: 1 threads (target='dev')
2020-08-22 15:32:30.579657 (MainThread): 10:32:30 | 
2020-08-22 15:32:30.583500 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:32:30.584503 (Thread-1): 10:32:30 | 1 of 5 START table model dbt_alice.my_first_dbt_model................ [RUN]
2020-08-22 15:32:30.584984 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-08-22 15:32:30.584984 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:32:30.584984 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-08-22 15:32:30.605991 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:32:30.606991 (Thread-1): finished collecting timing info
2020-08-22 15:32:30.635006 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:32:30.972986 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-08-22 15:32:30.973987 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-08-22 15:32:32.582653 (Thread-1): finished collecting timing info
2020-08-22 15:32:32.583645 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef86a4ec-c319-47cc-a4da-d9bb5bf34249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDCE0E4C8>]}
2020-08-22 15:32:32.584654 (Thread-1): 10:32:32 | 1 of 5 OK created table model dbt_alice.my_first_dbt_model........... [CREATE TABLE (2) in 2.00s]
2020-08-22 15:32:32.585645 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-08-22 15:32:32.585645 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-08-22 15:32:32.586645 (Thread-1): 10:32:32 | 2 of 5 START view model dbt_alice.stg_customers...................... [RUN]
2020-08-22 15:32:32.587290 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:32:32.587290 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:32:32.587290 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-08-22 15:32:32.592304 (Thread-1): unclosed <socket.socket fd=896, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65238), raddr=('172.217.9.10', 443)>
2020-08-22 15:32:32.592304 (Thread-1): unclosed <socket.socket fd=1012, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65237), raddr=('216.58.193.138', 443)>
2020-08-22 15:32:32.594303 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-08-22 15:32:32.595295 (Thread-1): finished collecting timing info
2020-08-22 15:32:32.616308 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2020-08-22 15:32:32.618300 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


2020-08-22 15:32:33.451116 (Thread-1): finished collecting timing info
2020-08-22 15:32:33.451116 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef86a4ec-c319-47cc-a4da-d9bb5bf34249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDCED5248>]}
2020-08-22 15:32:33.452117 (Thread-1): 10:32:33 | 2 of 5 OK created view model dbt_alice.stg_customers................. [CREATE VIEW in 0.86s]
2020-08-22 15:32:33.453262 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-08-22 15:32:33.453262 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-08-22 15:32:33.454266 (Thread-1): 10:32:33 | 3 of 5 START view model dbt_alice.stg_orders......................... [RUN]
2020-08-22 15:32:33.454266 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:32:33.455266 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:32:33.455266 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-08-22 15:32:33.460275 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:32:33.461275 (Thread-1): finished collecting timing info
2020-08-22 15:32:33.465277 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:32:33.467268 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


2020-08-22 15:32:34.243446 (Thread-1): finished collecting timing info
2020-08-22 15:32:34.244447 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef86a4ec-c319-47cc-a4da-d9bb5bf34249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDCE66B88>]}
2020-08-22 15:32:34.245447 (Thread-1): 10:32:34 | 3 of 5 OK created view model dbt_alice.stg_orders.................... [CREATE VIEW in 0.79s]
2020-08-22 15:32:34.246146 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-08-22 15:32:34.246146 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:32:34.247150 (Thread-1): 10:32:34 | 4 of 5 START view model dbt_alice.my_second_dbt_model................ [RUN]
2020-08-22 15:32:34.248149 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-08-22 15:32:34.248149 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:32:34.248149 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-08-22 15:32:34.256152 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:32:34.257160 (Thread-1): finished collecting timing info
2020-08-22 15:32:34.262161 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-08-22 15:32:34.263153 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `quick-asset-287211`.`dbt_alice`.`my_first_dbt_model`
where id = 1;


2020-08-22 15:32:35.139398 (Thread-1): finished collecting timing info
2020-08-22 15:32:35.140398 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef86a4ec-c319-47cc-a4da-d9bb5bf34249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDD099948>]}
2020-08-22 15:32:35.141399 (Thread-1): 10:32:35 | 4 of 5 OK created view model dbt_alice.my_second_dbt_model........... [CREATE VIEW in 0.89s]
2020-08-22 15:32:35.142391 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-08-22 15:32:35.142391 (Thread-1): Began running node model.jaffle_shop.customers
2020-08-22 15:32:35.143391 (Thread-1): 10:32:35 | 5 of 5 START view model dbt_alice.customers.......................... [RUN]
2020-08-22 15:32:35.144391 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:32:35.144391 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:32:35.144391 (Thread-1): Compiling model.jaffle_shop.customers
2020-08-22 15:32:35.147400 (Thread-1): unclosed <socket.socket fd=1176, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65246), raddr=('216.58.193.138', 443)>
2020-08-22 15:32:35.147400 (Thread-1): unclosed <socket.socket fd=1180, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65247), raddr=('172.217.9.10', 443)>
2020-08-22 15:32:35.153402 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-08-22 15:32:35.160203 (Thread-1): finished collecting timing info
2020-08-22 15:32:35.165206 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-08-22 15:32:35.166206 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `quick-asset-287211`.`dbt_alice`.`customers`
  OPTIONS()
  as with customers as (

    select * from `quick-asset-287211`.`dbt_alice`.`stg_customers`

),

orders as (

    select * from `quick-asset-287211`.`dbt_alice`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2020-08-22 15:32:36.253568 (Thread-1): finished collecting timing info
2020-08-22 15:32:36.253568 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef86a4ec-c319-47cc-a4da-d9bb5bf34249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDD09BE48>]}
2020-08-22 15:32:36.254568 (Thread-1): 10:32:36 | 5 of 5 OK created view model dbt_alice.customers..................... [CREATE VIEW in 1.11s]
2020-08-22 15:32:36.255568 (Thread-1): Finished running node model.jaffle_shop.customers
2020-08-22 15:32:36.266560 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:32:36.266560 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:32:36.266560 (MainThread): 10:32:36 | 
2020-08-22 15:32:36.267564 (MainThread): 10:32:36 | Finished running 1 table model, 4 view models in 6.47s.
2020-08-22 15:32:36.267564 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:32:36.267564 (MainThread): Connection 'list_quick-asset-287211' was properly closed.
2020-08-22 15:32:36.267564 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:32:36.268563 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2020-08-22 15:32:36.284566 (MainThread): 
2020-08-22 15:32:36.284566 (MainThread): Completed successfully
2020-08-22 15:32:36.284566 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2020-08-22 15:32:36.285567 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDCF7BCC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDCF21908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDCE93E48>]}
2020-08-22 15:32:36.285567 (MainThread): Flushing usage events
2020-08-22 15:34:42.295029 (MainThread): Running with dbt=0.17.2
2020-08-22 15:34:42.620687 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.clean.CleanTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='clean', write_json=True)
2020-08-22 15:34:42.621687 (MainThread): Tracking: tracking
2020-08-22 15:34:42.621687 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E8057E5148>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E8092DD108>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E8092E2308>]}
2020-08-22 15:34:42.622688 (MainThread): Checking target/*
2020-08-22 15:34:42.627680 (MainThread):  Cleaned target/*
2020-08-22 15:34:42.627680 (MainThread): Checking dbt_modules/*
2020-08-22 15:34:42.628680 (MainThread):  Cleaned dbt_modules/*
2020-08-22 15:34:42.628680 (MainThread): Finished cleaning all paths.
2020-08-22 15:34:42.629680 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E8092E2408>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E8092DABC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E8092E0C48>]}
2020-08-22 15:34:42.629680 (MainThread): Flushing usage events
2020-08-22 15:37:25.568389 (MainThread): Running with dbt=0.17.2
2020-08-22 15:37:25.895471 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.clean.CleanTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='clean', write_json=True)
2020-08-22 15:37:25.895471 (MainThread): Tracking: tracking
2020-08-22 15:37:25.896471 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4FFEE7B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D483961608>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D48395A648>]}
2020-08-22 15:37:25.896471 (MainThread): Checking target/*
2020-08-22 15:37:25.897463 (MainThread):  Cleaned target/*
2020-08-22 15:37:25.898463 (MainThread): Checking dbt_modules/*
2020-08-22 15:37:25.898463 (MainThread):  Cleaned dbt_modules/*
2020-08-22 15:37:25.898463 (MainThread): Finished cleaning all paths.
2020-08-22 15:37:25.899463 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D48395A408>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D48395A648>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D483959EC8>]}
2020-08-22 15:37:25.899463 (MainThread): Flushing usage events
2020-08-22 15:37:44.674488 (MainThread): Running with dbt=0.17.2
2020-08-22 15:37:45.006563 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 15:37:45.007563 (MainThread): Tracking: tracking
2020-08-22 15:37:45.007563 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0C748B808>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0C748BEC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0C748B748>]}
2020-08-22 15:37:45.057574 (MainThread): Partial parsing not enabled
2020-08-22 15:37:45.061576 (MainThread): Parsing macros\core.sql
2020-08-22 15:37:45.067656 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:37:45.130591 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:37:45.141593 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:37:45.142594 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:37:45.145595 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:37:45.147744 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:37:45.149595 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:37:45.151595 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:37:45.160590 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:37:45.178602 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:37:45.181602 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:37:45.189604 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:37:45.216610 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:37:45.254618 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:37:45.256619 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:37:45.277617 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:37:45.287626 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:37:45.294619 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:37:45.303629 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:37:45.306630 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:37:45.308631 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:37:45.309637 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:37:45.312631 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:37:45.335637 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:37:45.344631 (MainThread): Parsing macros\etc.sql
2020-08-22 15:37:45.345640 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:37:45.364635 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:37:45.368644 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:37:45.370645 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:37:45.384648 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:37:45.409645 (MainThread): Partial parsing not enabled
2020-08-22 15:37:45.449662 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:37:45.450663 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:37:45.483670 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:37:45.483670 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:37:45.493664 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:37:45.494665 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:37:45.636696 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:37:45.636696 (MainThread): 
2020-08-22 15:37:45.637697 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:37:45.637697 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:37:45.643699 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211".
2020-08-22 15:37:45.643699 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 15:37:46.044899 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:37:46.044899 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:37:46.045908 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:37:46.394601 (MainThread): 10:37:46 | Concurrency: 1 threads (target='dev')
2020-08-22 15:37:46.395601 (MainThread): 10:37:46 | 
2020-08-22 15:37:46.398601 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-08-22 15:37:46.399611 (Thread-1): 10:37:46 | 1 of 3 START table model dbt_alice.stg_customers..................... [RUN]
2020-08-22 15:37:46.400602 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:37:46.400602 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:37:46.400602 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-08-22 15:37:46.417606 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-08-22 15:37:46.419606 (Thread-1): finished collecting timing info
2020-08-22 15:37:46.445621 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:37:46.841768 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:37:47.007813 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2020-08-22 15:37:47.010804 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`stg_customers`
  
  
  OPTIONS()
  as (
    select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers
  );
    
2020-08-22 15:37:49.372640 (Thread-1): finished collecting timing info
2020-08-22 15:37:49.373641 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10c267f4-3016-4143-aeb3-33c56d051bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0C7894888>]}
2020-08-22 15:37:49.374641 (Thread-1): 10:37:49 | 1 of 3 OK created table model dbt_alice.stg_customers................ [CREATE TABLE (100) in 2.97s]
2020-08-22 15:37:49.374641 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-08-22 15:37:49.374641 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-08-22 15:37:49.375642 (Thread-1): 10:37:49 | 2 of 3 START table model dbt_alice.stg_orders........................ [RUN]
2020-08-22 15:37:49.376642 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:37:49.376642 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:37:49.376642 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-08-22 15:37:49.382643 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:37:49.383634 (Thread-1): finished collecting timing info
2020-08-22 15:37:49.387636 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:37:49.710330 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:37:49.826348 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:37:49.827354 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`stg_orders`
  
  
  OPTIONS()
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders
  );
    
2020-08-22 15:37:52.155808 (Thread-1): finished collecting timing info
2020-08-22 15:37:52.156808 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10c267f4-3016-4143-aeb3-33c56d051bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0C78133C8>]}
2020-08-22 15:37:52.157808 (Thread-1): 10:37:52 | 2 of 3 OK created table model dbt_alice.stg_orders................... [CREATE TABLE (99) in 2.78s]
2020-08-22 15:37:52.157808 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-08-22 15:37:52.158807 (Thread-1): Began running node model.jaffle_shop.customers
2020-08-22 15:37:52.159809 (Thread-1): 10:37:52 | 3 of 3 START table model dbt_alice.customers......................... [RUN]
2020-08-22 15:37:52.159809 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:37:52.159809 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:37:52.160809 (Thread-1): Compiling model.jaffle_shop.customers
2020-08-22 15:37:52.169811 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-08-22 15:37:52.170811 (Thread-1): finished collecting timing info
2020-08-22 15:37:52.175812 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-08-22 15:37:52.177815 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select * from `quick-asset-287211`.`dbt_alice`.`stg_customers`

),

orders as (

    select * from `quick-asset-287211`.`dbt_alice`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2020-08-22 15:37:54.352610 (Thread-1): finished collecting timing info
2020-08-22 15:37:54.353610 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10c267f4-3016-4143-aeb3-33c56d051bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0C759DC48>]}
2020-08-22 15:37:54.355620 (Thread-1): 10:37:54 | 3 of 3 OK created table model dbt_alice.customers.................... [CREATE TABLE (100) in 2.19s]
2020-08-22 15:37:54.356110 (Thread-1): Finished running node model.jaffle_shop.customers
2020-08-22 15:37:54.365617 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:37:54.365617 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:37:54.366619 (MainThread): 10:37:54 | 
2020-08-22 15:37:54.366619 (MainThread): 10:37:54 | Finished running 3 table models in 8.73s.
2020-08-22 15:37:54.366619 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:37:54.366619 (MainThread): Connection 'list_quick-asset-287211' was properly closed.
2020-08-22 15:37:54.367617 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:37:54.367617 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2020-08-22 15:37:54.376628 (MainThread): 
2020-08-22 15:37:54.376628 (MainThread): Completed successfully
2020-08-22 15:37:54.377620 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-08-22 15:37:54.378628 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0C7617C08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0C78CB188>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0C77D6708>]}
2020-08-22 15:37:54.378628 (MainThread): Flushing usage events
2020-08-22 15:39:20.921052 (MainThread): Running with dbt=0.17.2
2020-08-22 15:39:21.237124 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-08-22 15:39:21.238124 (MainThread): Tracking: tracking
2020-08-22 15:39:21.238124 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2B83DB508>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2B83DBC88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2B83DBC08>]}
2020-08-22 15:39:21.290135 (MainThread): Partial parsing not enabled
2020-08-22 15:39:21.294136 (MainThread): Parsing macros\core.sql
2020-08-22 15:39:21.300130 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:39:21.363143 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:39:21.375146 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:39:21.376146 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:39:21.379147 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:39:21.382148 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:39:21.384148 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:39:21.386148 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:39:21.396150 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:39:21.415164 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:39:21.417164 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:39:21.426157 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:39:21.454173 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:39:21.492181 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:39:21.494182 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:39:21.516187 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:39:21.525189 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:39:21.532190 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:39:21.540192 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:39:21.543193 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:39:21.544193 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:39:21.546193 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:39:21.548194 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:39:21.569189 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:39:21.577200 (MainThread): Parsing macros\etc.sql
2020-08-22 15:39:21.578201 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:39:21.595204 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:39:21.599205 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:39:21.601206 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:39:21.613208 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:39:21.639214 (MainThread): Partial parsing not enabled
2020-08-22 15:39:21.681224 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:39:21.681224 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:39:21.714232 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:39:21.714232 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:39:21.724233 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:39:21.724233 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:39:21.733235 (MainThread): A future version of dbt will parse files with both .yml and .yaml file extensions. dbt found 1 files with .yaml extensions in your dbt project. To avoid errors when upgrading to a future release, either remove these files from your dbt project, or change their extensions.
2020-08-22 15:39:21.863401 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:39:21.863401 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-08-22 15:39:21.865401 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2B85DB9C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2B8665CC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2B8665708>]}
2020-08-22 15:39:21.865401 (MainThread): Flushing usage events
2020-08-22 15:39:22.164113 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2020-08-22 15:40:37.684746 (MainThread): Running with dbt=0.17.2
2020-08-22 15:40:38.011221 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 15:40:38.011221 (MainThread): Tracking: tracking
2020-08-22 15:40:38.012221 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223CAFCB788>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223CAFCBA48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223CAFCB9C8>]}
2020-08-22 15:40:38.061232 (MainThread): Partial parsing not enabled
2020-08-22 15:40:38.064233 (MainThread): Parsing macros\core.sql
2020-08-22 15:40:38.070226 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:40:38.133248 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:40:38.144251 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:40:38.146252 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:40:38.148252 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:40:38.150252 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:40:38.152244 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:40:38.154253 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:40:38.164256 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:40:38.182351 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:40:38.185251 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:40:38.193255 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:40:38.221268 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:40:38.259278 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:40:38.261277 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:40:38.283283 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:40:38.292285 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:40:38.298277 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:40:38.307288 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:40:38.309288 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:40:38.310289 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:40:38.312289 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:40:38.314291 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:40:38.335286 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:40:38.343296 (MainThread): Parsing macros\etc.sql
2020-08-22 15:40:38.344296 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:40:38.361300 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:40:38.365292 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:40:38.367301 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:40:38.380304 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:40:38.408310 (MainThread): Partial parsing not enabled
2020-08-22 15:40:38.455321 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:40:38.455321 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:40:38.489321 (MainThread): Flushing usage events
2020-08-22 15:40:38.786379 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2020-08-22 15:40:38.786379 (MainThread): ctrl-c
2020-08-22 15:40:43.684805 (MainThread): Running with dbt=0.17.2
2020-08-22 15:40:44.009878 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-08-22 15:40:44.009878 (MainThread): Tracking: tracking
2020-08-22 15:40:44.010879 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A7036A848>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A7036A748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A7036AFC8>]}
2020-08-22 15:40:44.059890 (MainThread): Partial parsing not enabled
2020-08-22 15:40:44.063891 (MainThread): Parsing macros\core.sql
2020-08-22 15:40:44.069541 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:40:44.133555 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:40:44.144558 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:40:44.145558 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:40:44.147558 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:40:44.150559 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:40:44.152559 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:40:44.153560 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:40:44.163562 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:40:44.182566 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:40:44.184567 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:40:44.192568 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:40:44.219575 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:40:44.257583 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:40:44.259584 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:40:44.281589 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:40:44.290591 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:40:44.296592 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:40:44.304594 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:40:44.307595 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:40:44.308595 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:40:44.310596 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:40:44.312596 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:40:44.333600 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:40:44.342602 (MainThread): Parsing macros\etc.sql
2020-08-22 15:40:44.343603 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:40:44.360606 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:40:44.363607 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:40:44.366608 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:40:44.379611 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:40:44.405617 (MainThread): Partial parsing not enabled
2020-08-22 15:40:44.451628 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:40:44.452628 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:40:44.486636 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:40:44.486636 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:40:44.496638 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:40:44.496638 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:40:44.849717 (MainThread): Found 3 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:40:44.850719 (MainThread): 
2020-08-22 15:40:44.851718 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:40:44.851718 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:40:44.869569 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:40:44.870574 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:40:44.870574 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:40:45.229403 (MainThread): 10:40:45 | Concurrency: 1 threads (target='dev')
2020-08-22 15:40:45.230124 (MainThread): 10:40:45 | 
2020-08-22 15:40:45.233128 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-08-22 15:40:45.233128 (Thread-1): 10:40:45 | 1 of 9 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [RUN]
2020-08-22 15:40:45.233128 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned".
2020-08-22 15:40:45.233128 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:40:45.234128 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-08-22 15:40:45.263143 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"
2020-08-22 15:40:45.265135 (Thread-1): finished collecting timing info
2020-08-22 15:40:45.266144 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"} */





with all_values as (

    select distinct
        status as value_field

    from `quick-asset-287211`.`dbt_alice`.`stg_orders`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'placed','shipped','completed','return_pending','returned'
    )
)

select count(*) as validation_errors
from validation_errors


2020-08-22 15:40:47.136303 (Thread-1): finished collecting timing info
2020-08-22 15:40:47.137303 (Thread-1): 10:40:47 | 1 of 9 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [PASS in 1.90s]
2020-08-22 15:40:47.138294 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-08-22 15:40:47.138294 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id
2020-08-22 15:40:47.138294 (Thread-1): 10:40:47 | 2 of 9 START test not_null_customers_customer_id..................... [RUN]
2020-08-22 15:40:47.138294 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id".
2020-08-22 15:40:47.138294 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:40:47.138294 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id
2020-08-22 15:40:47.148305 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id"
2020-08-22 15:40:47.149297 (Thread-1): finished collecting timing info
2020-08-22 15:40:47.150297 (Thread-1): On test.jaffle_shop.not_null_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id"} */




select count(*) as validation_errors
from `quick-asset-287211`.`dbt_alice`.`customers`
where customer_id is null


2020-08-22 15:40:48.453202 (Thread-1): finished collecting timing info
2020-08-22 15:40:48.454211 (Thread-1): 10:40:48 | 2 of 9 PASS not_null_customers_customer_id........................... [PASS in 1.32s]
2020-08-22 15:40:48.454211 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id
2020-08-22 15:40:48.454211 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-08-22 15:40:48.455203 (Thread-1): 10:40:48 | 3 of 9 START test not_null_stg_customers_customer_id................. [RUN]
2020-08-22 15:40:48.455203 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2020-08-22 15:40:48.455203 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:40:48.456204 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2020-08-22 15:40:48.458212 (Thread-1): unclosed <socket.socket fd=1044, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65411), raddr=('172.217.6.138', 443)>
2020-08-22 15:40:48.458212 (Thread-1): unclosed <socket.socket fd=1060, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65412), raddr=('172.217.9.138', 443)>
2020-08-22 15:40:48.467214 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2020-08-22 15:40:48.468206 (Thread-1): finished collecting timing info
2020-08-22 15:40:48.468206 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id"} */




select count(*) as validation_errors
from `quick-asset-287211`.`dbt_alice`.`stg_customers`
where customer_id is null


2020-08-22 15:40:49.658979 (Thread-1): finished collecting timing info
2020-08-22 15:40:49.659989 (Thread-1): 10:40:49 | 3 of 9 PASS not_null_stg_customers_customer_id....................... [PASS in 1.20s]
2020-08-22 15:40:49.660130 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-08-22 15:40:49.660130 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_customer_id
2020-08-22 15:40:49.660130 (Thread-1): 10:40:49 | 4 of 9 START test not_null_stg_orders_customer_id.................... [RUN]
2020-08-22 15:40:49.661133 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_customer_id".
2020-08-22 15:40:49.661133 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:40:49.661133 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_customer_id
2020-08-22 15:40:49.666143 (Thread-1): unclosed <socket.socket fd=1088, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65414), raddr=('172.217.6.138', 443)>
2020-08-22 15:40:49.666143 (Thread-1): unclosed <socket.socket fd=1084, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65415), raddr=('172.217.9.138', 443)>
2020-08-22 15:40:49.671144 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id"
2020-08-22 15:40:49.672136 (Thread-1): finished collecting timing info
2020-08-22 15:40:49.672136 (Thread-1): On test.jaffle_shop.not_null_stg_orders_customer_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_customer_id"} */




select count(*) as validation_errors
from `quick-asset-287211`.`dbt_alice`.`stg_orders`
where customer_id is null


2020-08-22 15:40:50.859188 (Thread-1): finished collecting timing info
2020-08-22 15:40:50.860189 (Thread-1): 10:40:50 | 4 of 9 PASS not_null_stg_orders_customer_id.......................... [PASS in 1.20s]
2020-08-22 15:40:50.860189 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_customer_id
2020-08-22 15:40:50.861189 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id
2020-08-22 15:40:50.861189 (Thread-1): 10:40:50 | 5 of 9 START test not_null_stg_orders_order_id....................... [RUN]
2020-08-22 15:40:50.861189 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id".
2020-08-22 15:40:50.861189 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:40:50.861189 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id
2020-08-22 15:40:50.871200 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id"
2020-08-22 15:40:50.877449 (Thread-1): finished collecting timing info
2020-08-22 15:40:50.878451 (Thread-1): On test.jaffle_shop.not_null_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id"} */




select count(*) as validation_errors
from `quick-asset-287211`.`dbt_alice`.`stg_orders`
where order_id is null


2020-08-22 15:40:52.042477 (Thread-1): finished collecting timing info
2020-08-22 15:40:52.043487 (Thread-1): 10:40:52 | 5 of 9 PASS not_null_stg_orders_order_id............................. [PASS in 1.18s]
2020-08-22 15:40:52.044486 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id
2020-08-22 15:40:52.044486 (Thread-1): Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_
2020-08-22 15:40:52.044486 (Thread-1): 10:40:52 | 6 of 9 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [RUN]
2020-08-22 15:40:52.044486 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_".
2020-08-22 15:40:52.044486 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:40:52.044486 (Thread-1): Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_
2020-08-22 15:40:52.049487 (Thread-1): unclosed <socket.socket fd=1132, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65418), raddr=('172.217.6.138', 443)>
2020-08-22 15:40:52.049487 (Thread-1): unclosed <socket.socket fd=1176, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65419), raddr=('172.217.9.138', 443)>
2020-08-22 15:40:52.056488 (Thread-1): Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_"
2020-08-22 15:40:52.057489 (Thread-1): finished collecting timing info
2020-08-22 15:40:52.058480 (Thread-1): On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_"} */





select count(*) as validation_errors
from (
    select customer_id as id from `quick-asset-287211`.`dbt_alice`.`stg_orders`
) as child
left join (
    select customer_id as id from `quick-asset-287211`.`dbt_alice`.`stg_customers`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null


2020-08-22 15:40:53.219028 (Thread-1): finished collecting timing info
2020-08-22 15:40:53.219028 (Thread-1): 10:40:53 | 6 of 9 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [PASS in 1.17s]
2020-08-22 15:40:53.220019 (Thread-1): Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_
2020-08-22 15:40:53.220019 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id
2020-08-22 15:40:53.220019 (Thread-1): 10:40:53 | 7 of 9 START test unique_customers_customer_id....................... [RUN]
2020-08-22 15:40:53.221028 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id".
2020-08-22 15:40:53.221028 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:40:53.221028 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id
2020-08-22 15:40:53.230029 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id"
2020-08-22 15:40:53.231284 (Thread-1): finished collecting timing info
2020-08-22 15:40:53.232021 (Thread-1): On test.jaffle_shop.unique_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id"} */




select count(*) as validation_errors
from (

    select
        customer_id

    from `quick-asset-287211`.`dbt_alice`.`customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors


2020-08-22 15:40:54.465138 (Thread-1): finished collecting timing info
2020-08-22 15:40:54.465138 (Thread-1): 10:40:54 | 7 of 9 PASS unique_customers_customer_id............................. [PASS in 1.25s]
2020-08-22 15:40:54.466412 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id
2020-08-22 15:40:54.466412 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2020-08-22 15:40:54.466412 (Thread-1): 10:40:54 | 8 of 9 START test unique_stg_customers_customer_id................... [RUN]
2020-08-22 15:40:54.467414 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2020-08-22 15:40:54.467414 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:40:54.467414 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2020-08-22 15:40:54.469414 (Thread-1): unclosed <socket.socket fd=444, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65422), raddr=('172.217.6.138', 443)>
2020-08-22 15:40:54.469414 (Thread-1): unclosed <socket.socket fd=1256, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65423), raddr=('172.217.9.138', 443)>
2020-08-22 15:40:54.477417 (Thread-1): unclosed <socket.socket fd=360, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65408), raddr=('172.217.6.138', 443)>
2020-08-22 15:40:54.477417 (Thread-1): unclosed <socket.socket fd=480, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65409), raddr=('172.217.9.138', 443)>
2020-08-22 15:40:54.481418 (Thread-1): unclosed <socket.socket fd=1096, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65416), raddr=('172.217.6.138', 443)>
2020-08-22 15:40:54.481418 (Thread-1): unclosed <socket.socket fd=1084, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65417), raddr=('172.217.9.138', 443)>
2020-08-22 15:40:54.483427 (Thread-1): unclosed <socket.socket fd=1208, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65421), raddr=('172.217.9.138', 443)>
2020-08-22 15:40:54.484427 (Thread-1): unclosed <socket.socket fd=1088, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65420), raddr=('172.217.6.138', 443)>
2020-08-22 15:40:54.488419 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2020-08-22 15:40:54.489420 (Thread-1): finished collecting timing info
2020-08-22 15:40:54.490419 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id"} */




select count(*) as validation_errors
from (

    select
        customer_id

    from `quick-asset-287211`.`dbt_alice`.`stg_customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors


2020-08-22 15:40:55.704781 (Thread-1): finished collecting timing info
2020-08-22 15:40:55.705791 (Thread-1): 10:40:55 | 8 of 9 PASS unique_stg_customers_customer_id......................... [PASS in 1.24s]
2020-08-22 15:40:55.705791 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2020-08-22 15:40:55.705791 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id
2020-08-22 15:40:55.706791 (Thread-1): 10:40:55 | 9 of 9 START test unique_stg_orders_order_id......................... [RUN]
2020-08-22 15:40:55.706791 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id".
2020-08-22 15:40:55.706791 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:40:55.706791 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id
2020-08-22 15:40:55.710783 (Thread-1): unclosed <socket.socket fd=444, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65424), raddr=('172.217.6.138', 443)>
2020-08-22 15:40:55.711793 (Thread-1): unclosed <socket.socket fd=1272, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65425), raddr=('172.217.9.138', 443)>
2020-08-22 15:40:55.717793 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id"
2020-08-22 15:40:55.718785 (Thread-1): finished collecting timing info
2020-08-22 15:40:55.719785 (Thread-1): On test.jaffle_shop.unique_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id"} */




select count(*) as validation_errors
from (

    select
        order_id

    from `quick-asset-287211`.`dbt_alice`.`stg_orders`
    where order_id is not null
    group by order_id
    having count(*) > 1

) validation_errors


2020-08-22 15:40:56.838292 (Thread-1): finished collecting timing info
2020-08-22 15:40:56.838292 (Thread-1): 10:40:56 | 9 of 9 PASS unique_stg_orders_order_id............................... [PASS in 1.13s]
2020-08-22 15:40:56.839440 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id
2020-08-22 15:40:56.940324 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:40:56.940324 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:40:56.941316 (MainThread): 10:40:56 | 
2020-08-22 15:40:56.941316 (MainThread): 10:40:56 | Finished running 9 tests in 12.09s.
2020-08-22 15:40:56.942316 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:40:56.942316 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:40:56.942316 (MainThread): Connection 'test.jaffle_shop.unique_stg_orders_order_id' was properly closed.
2020-08-22 15:40:56.971323 (MainThread): 
2020-08-22 15:40:56.971323 (MainThread): Completed successfully
2020-08-22 15:40:56.973332 (MainThread): 
Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
2020-08-22 15:40:56.973332 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A70742608>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A707429C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A703D54C8>]}
2020-08-22 15:40:56.974323 (MainThread): Flushing usage events
2020-08-22 15:42:35.712575 (MainThread): Running with dbt=0.17.2
2020-08-22 15:42:36.026644 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-08-22 15:42:36.026644 (MainThread): Tracking: tracking
2020-08-22 15:42:36.027769 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA2376BDC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA2376B4C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA2376BEC8>]}
2020-08-22 15:42:36.075655 (MainThread): Partial parsing not enabled
2020-08-22 15:42:36.078656 (MainThread): Parsing macros\core.sql
2020-08-22 15:42:36.084657 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:42:36.145671 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:42:36.156674 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:42:36.157674 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:42:36.160666 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:42:36.162675 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:42:36.164675 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:42:36.166676 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:42:36.175678 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:42:36.193683 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:42:36.196682 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:42:36.204684 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:42:36.231690 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:42:36.268692 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:42:36.271877 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:42:36.293841 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:42:36.302855 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:42:36.309861 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:42:36.317710 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:42:36.320906 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:42:36.321887 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:42:36.323886 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:42:36.325906 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:42:36.346716 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:42:36.354718 (MainThread): Parsing macros\etc.sql
2020-08-22 15:42:36.355718 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:42:36.372722 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:42:36.375723 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:42:36.378715 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:42:36.391726 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:42:36.416732 (MainThread): Partial parsing not enabled
2020-08-22 15:42:36.456733 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:42:36.457742 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:42:36.491741 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:42:36.491741 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:42:36.501751 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:42:36.501751 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:42:36.526749 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA2394F148>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA2394F208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA2394F248>]}
2020-08-22 15:42:36.526749 (MainThread): Flushing usage events
2020-08-22 15:42:36.844571 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2020-08-22 15:42:36.845571 (MainThread): Encountered an error:
2020-08-22 15:42:36.845854 (MainThread): Compilation Error
  dbt found two schema.yml entries for the same resource named customers. Resources and their associated columns may only be described a single time. To fix this, remove one of the resource entries for customers in this file:
   - models\schema.yml
  
2020-08-22 15:42:36.861859 (MainThread): Traceback (most recent call last):
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\main.py", line 212, in run_from_args
    results = task.run()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\task\runnable.py", line 390, in run
    self._runtime_initialize()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\task\runnable.py", line 103, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\task\runnable.py", line 71, in _runtime_initialize
    self.load_manifest()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\task\runnable.py", line 60, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\parser\manifest.py", line 641, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\parser\manifest.py", line 356, in load_all
    loader.load(internal_manifest=internal_manifest)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\parser\manifest.py", line 212, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\parser\manifest.py", line 186, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\parser\manifest.py", line 142, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\parser\schemas.py", line 533, in parse_file
    for test_block in parser.parse():
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\parser\schemas.py", line 679, in parse
    self.parse_patch(node_block, refs)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\parser\schemas.py", line 717, in parse_patch
    self.results.add_patch(self.yaml.file, result)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\parser\results.py", line 153, in add_patch
    raise_duplicate_patch_name(patch, self.patches[patch.name])
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\exceptions.py", line 818, in raise_duplicate_patch_name
    f'dbt found two schema.yml entries for the same resource named '
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\exceptions.py", line 396, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two schema.yml entries for the same resource named customers. Resources and their associated columns may only be described a single time. To fix this, remove one of the resource entries for customers in this file:
   - models\schema.yml
  

2020-08-22 15:42:54.532222 (MainThread): Running with dbt=0.17.2
2020-08-22 15:42:54.848700 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-08-22 15:42:54.849710 (MainThread): Tracking: tracking
2020-08-22 15:42:54.850709 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446B20A848>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446B20AC88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446B20A788>]}
2020-08-22 15:42:54.897720 (MainThread): Partial parsing not enabled
2020-08-22 15:42:54.901720 (MainThread): Parsing macros\core.sql
2020-08-22 15:42:54.906721 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:42:54.970736 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:42:54.982739 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:42:54.983739 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:42:54.985740 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:42:54.988740 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:42:54.990741 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:42:54.991741 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:42:55.001743 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:42:55.019747 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:42:55.022748 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:42:55.030749 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:42:55.056756 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:42:55.094764 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:42:55.096765 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:42:55.117769 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:42:55.127771 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:42:55.134773 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:42:55.143775 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:42:55.146776 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:42:55.147776 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:42:55.149776 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:42:55.151777 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:42:55.174782 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:42:55.182784 (MainThread): Parsing macros\etc.sql
2020-08-22 15:42:55.183776 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:42:55.199788 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:42:55.203788 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:42:55.205789 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:42:55.219792 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:42:55.244798 (MainThread): Partial parsing not enabled
2020-08-22 15:42:55.286808 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:42:55.286808 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:42:55.320815 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:42:55.320815 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:42:55.330818 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:42:55.331818 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:42:55.675888 (MainThread): Found 3 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:42:55.677896 (MainThread): 
2020-08-22 15:42:55.677896 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:42:55.677896 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:42:55.695891 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:42:55.695891 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:42:55.696900 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:42:56.058672 (MainThread): 10:42:56 | Concurrency: 1 threads (target='dev')
2020-08-22 15:42:56.058672 (MainThread): 10:42:56 | 
2020-08-22 15:42:56.062664 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-08-22 15:42:56.062664 (Thread-1): 10:42:56 | 1 of 9 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [RUN]
2020-08-22 15:42:56.062664 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned".
2020-08-22 15:42:56.062664 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:42:56.062664 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-08-22 15:42:56.086668 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"
2020-08-22 15:42:56.087668 (Thread-1): finished collecting timing info
2020-08-22 15:42:56.088669 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"} */





with all_values as (

    select distinct
        status as value_field

    from `quick-asset-287211`.`dbt_alice`.`stg_orders`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'placed','shipped','completed','return_pending','returned'
    )
)

select count(*) as validation_errors
from validation_errors


2020-08-22 15:42:57.060670 (Thread-1): finished collecting timing info
2020-08-22 15:42:57.060670 (Thread-1): 10:42:57 | 1 of 9 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [PASS in 1.00s]
2020-08-22 15:42:57.061670 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-08-22 15:42:57.061670 (Thread-1): Began running node test.jaffle_shop.not_null_customers_firstn_nm
2020-08-22 15:42:57.061670 (Thread-1): 10:42:57 | 2 of 9 START test not_null_customers_firstn_nm....................... [RUN]
2020-08-22 15:42:57.062661 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_firstn_nm".
2020-08-22 15:42:57.062661 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:42:57.062661 (Thread-1): Compiling test.jaffle_shop.not_null_customers_firstn_nm
2020-08-22 15:42:57.071672 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_firstn_nm"
2020-08-22 15:42:57.072671 (Thread-1): finished collecting timing info
2020-08-22 15:42:57.073663 (Thread-1): On test.jaffle_shop.not_null_customers_firstn_nm: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_firstn_nm"} */




select count(*) as validation_errors
from `quick-asset-287211`.`dbt_alice`.`customers`
where firstn_nm is null


2020-08-22 15:42:57.465447 (Thread-1): finished collecting timing info
2020-08-22 15:42:57.465447 (Thread-1): Database Error in test not_null_customers_firstn_nm (models\schema.yml)
  Unrecognized name: firstn_nm; Did you mean first_name? at [8:7]
  compiled SQL at target\compiled\jaffle_shop\models\schema.yml\schema_test\not_null_customers_firstn_nm.sql
Traceback (most recent call last):
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 85, in exception_handler
    yield
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 364, in _retry_and_handle
    deadline=None)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 226, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 353, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\future\polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Unrecognized name: firstn_nm; Did you mean first_name? at [8:7]

(job ID: 5494ab82-443c-40a3-9683-c493483af013)

                                                                  -----Query Job SQL Follows-----                                                                  

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_firstn_nm"} */
   2:
   3:
   4:
   5:
   6:select count(*) as validation_errors
   7:from `quick-asset-287211`.`dbt_alice`.`customers`
   8:where firstn_nm is null
   9:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 607, in execute
    failed_rows = self.execute_schema_test(test)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 587, in execute_schema_test
    fetch=True,
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\base\impl.py", line 228, in execute
    fetch=fetch
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 235, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 228, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 364, in _retry_and_handle
    deadline=None)
  File "c:\users\bhala\.conda\envs\dbt\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 89, in exception_handler
    self.handle_error(e, message)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 77, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in test not_null_customers_firstn_nm (models\schema.yml)
  Unrecognized name: firstn_nm; Did you mean first_name? at [8:7]
  compiled SQL at target\compiled\jaffle_shop\models\schema.yml\schema_test\not_null_customers_firstn_nm.sql
2020-08-22 15:42:57.468445 (Thread-1): 10:42:57 | 2 of 9 ERROR not_null_customers_firstn_nm............................ [ERROR in 0.41s]
2020-08-22 15:42:57.469445 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_firstn_nm
2020-08-22 15:42:57.469445 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-08-22 15:42:57.469445 (Thread-1): 10:42:57 | 3 of 9 START test not_null_stg_customers_customer_id................. [RUN]
2020-08-22 15:42:57.469445 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2020-08-22 15:42:57.469445 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:42:57.469445 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2020-08-22 15:42:57.471446 (Thread-1): unclosed <socket.socket fd=1044, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65458), raddr=('172.217.6.138', 443)>
2020-08-22 15:42:57.472446 (Thread-1): unclosed <socket.socket fd=1060, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65459), raddr=('172.217.9.10', 443)>
2020-08-22 15:42:57.480448 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2020-08-22 15:42:57.480448 (Thread-1): finished collecting timing info
2020-08-22 15:42:57.481448 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id"} */




select count(*) as validation_errors
from `quick-asset-287211`.`dbt_alice`.`stg_customers`
where customer_id is null


2020-08-22 15:42:58.443918 (Thread-1): finished collecting timing info
2020-08-22 15:42:58.443918 (Thread-1): 10:42:58 | 3 of 9 PASS not_null_stg_customers_customer_id....................... [PASS in 0.97s]
2020-08-22 15:42:58.444917 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-08-22 15:42:58.444917 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_customer_id
2020-08-22 15:42:58.444917 (Thread-1): 10:42:58 | 4 of 9 START test not_null_stg_orders_customer_id.................... [RUN]
2020-08-22 15:42:58.445908 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_customer_id".
2020-08-22 15:42:58.445908 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:42:58.445908 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_customer_id
2020-08-22 15:42:58.450918 (Thread-1): unclosed <socket.socket fd=1088, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65460), raddr=('172.217.6.138', 443)>
2020-08-22 15:42:58.450918 (Thread-1): unclosed <socket.socket fd=1100, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65461), raddr=('172.217.9.10', 443)>
2020-08-22 15:42:58.455919 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id"
2020-08-22 15:42:58.456919 (Thread-1): finished collecting timing info
2020-08-22 15:42:58.456919 (Thread-1): On test.jaffle_shop.not_null_stg_orders_customer_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_customer_id"} */




select count(*) as validation_errors
from `quick-asset-287211`.`dbt_alice`.`stg_orders`
where customer_id is null


2020-08-22 15:42:59.363858 (Thread-1): finished collecting timing info
2020-08-22 15:42:59.363858 (Thread-1): 10:42:59 | 4 of 9 PASS not_null_stg_orders_customer_id.......................... [PASS in 0.92s]
2020-08-22 15:42:59.364857 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_customer_id
2020-08-22 15:42:59.364857 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id
2020-08-22 15:42:59.364857 (Thread-1): 10:42:59 | 5 of 9 START test not_null_stg_orders_order_id....................... [RUN]
2020-08-22 15:42:59.365857 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id".
2020-08-22 15:42:59.365857 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:42:59.365857 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id
2020-08-22 15:42:59.375859 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id"
2020-08-22 15:42:59.376860 (Thread-1): finished collecting timing info
2020-08-22 15:42:59.376860 (Thread-1): On test.jaffle_shop.not_null_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id"} */




select count(*) as validation_errors
from `quick-asset-287211`.`dbt_alice`.`stg_orders`
where order_id is null


2020-08-22 15:43:00.338387 (Thread-1): finished collecting timing info
2020-08-22 15:43:00.338387 (Thread-1): 10:43:00 | 5 of 9 PASS not_null_stg_orders_order_id............................. [PASS in 0.97s]
2020-08-22 15:43:00.339387 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id
2020-08-22 15:43:00.339387 (Thread-1): Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_
2020-08-22 15:43:00.339387 (Thread-1): 10:43:00 | 6 of 9 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [RUN]
2020-08-22 15:43:00.340387 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_".
2020-08-22 15:43:00.340387 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:43:00.340387 (Thread-1): Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_
2020-08-22 15:43:00.344388 (Thread-1): unclosed <socket.socket fd=1176, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65466), raddr=('172.217.6.138', 443)>
2020-08-22 15:43:00.344388 (Thread-1): unclosed <socket.socket fd=1172, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65468), raddr=('172.217.9.10', 443)>
2020-08-22 15:43:00.352390 (Thread-1): Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_"
2020-08-22 15:43:00.353391 (Thread-1): finished collecting timing info
2020-08-22 15:43:00.354391 (Thread-1): On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_"} */





select count(*) as validation_errors
from (
    select customer_id as id from `quick-asset-287211`.`dbt_alice`.`stg_orders`
) as child
left join (
    select customer_id as id from `quick-asset-287211`.`dbt_alice`.`stg_customers`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null


2020-08-22 15:43:01.232923 (Thread-1): finished collecting timing info
2020-08-22 15:43:01.232923 (Thread-1): 10:43:01 | 6 of 9 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [PASS in 0.89s]
2020-08-22 15:43:01.233923 (Thread-1): Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_
2020-08-22 15:43:01.233923 (Thread-1): Began running node test.jaffle_shop.unique_customers_firstn_nm
2020-08-22 15:43:01.233923 (Thread-1): 10:43:01 | 7 of 9 START test unique_customers_firstn_nm......................... [RUN]
2020-08-22 15:43:01.234915 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_firstn_nm".
2020-08-22 15:43:01.234915 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:43:01.234915 (Thread-1): Compiling test.jaffle_shop.unique_customers_firstn_nm
2020-08-22 15:43:01.243926 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_firstn_nm"
2020-08-22 15:43:01.245047 (Thread-1): finished collecting timing info
2020-08-22 15:43:01.245917 (Thread-1): On test.jaffle_shop.unique_customers_firstn_nm: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_firstn_nm"} */




select count(*) as validation_errors
from (

    select
        firstn_nm

    from `quick-asset-287211`.`dbt_alice`.`customers`
    where firstn_nm is not null
    group by firstn_nm
    having count(*) > 1

) validation_errors


2020-08-22 15:43:01.696548 (Thread-1): finished collecting timing info
2020-08-22 15:43:01.697550 (Thread-1): Database Error in test unique_customers_firstn_nm (models\schema.yml)
  Unrecognized name: firstn_nm; Did you mean first_name? at [13:11]
  compiled SQL at target\compiled\jaffle_shop\models\schema.yml\schema_test\unique_customers_firstn_nm.sql
Traceback (most recent call last):
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 85, in exception_handler
    yield
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 364, in _retry_and_handle
    deadline=None)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 226, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 353, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\future\polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Unrecognized name: firstn_nm; Did you mean first_name? at [13:11]

(job ID: 4a04a617-591c-4fdc-9caf-76b084b25a35)

                                                                 -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_firstn_nm"} */
   2:
   3:
   4:
   5:
   6:select count(*) as validation_errors
   7:from (
   8:
   9:    select
  10:        firstn_nm
  11:
  12:    from `quick-asset-287211`.`dbt_alice`.`customers`
  13:    where firstn_nm is not null
  14:    group by firstn_nm
  15:    having count(*) > 1
  16:
  17:) validation_errors
  18:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 607, in execute
    failed_rows = self.execute_schema_test(test)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 587, in execute_schema_test
    fetch=True,
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\base\impl.py", line 228, in execute
    fetch=fetch
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 235, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 228, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 364, in _retry_and_handle
    deadline=None)
  File "c:\users\bhala\.conda\envs\dbt\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 89, in exception_handler
    self.handle_error(e, message)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 77, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in test unique_customers_firstn_nm (models\schema.yml)
  Unrecognized name: firstn_nm; Did you mean first_name? at [13:11]
  compiled SQL at target\compiled\jaffle_shop\models\schema.yml\schema_test\unique_customers_firstn_nm.sql
2020-08-22 15:43:01.698549 (Thread-1): 10:43:01 | 7 of 9 ERROR unique_customers_firstn_nm.............................. [ERROR in 0.46s]
2020-08-22 15:43:01.698896 (Thread-1): Finished running node test.jaffle_shop.unique_customers_firstn_nm
2020-08-22 15:43:01.698896 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2020-08-22 15:43:01.698896 (Thread-1): 10:43:01 | 8 of 9 START test unique_stg_customers_customer_id................... [RUN]
2020-08-22 15:43:01.699902 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2020-08-22 15:43:01.699902 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:43:01.699902 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2020-08-22 15:43:01.702910 (Thread-1): unclosed <socket.socket fd=1264, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65471), raddr=('172.217.6.138', 443)>
2020-08-22 15:43:01.702910 (Thread-1): unclosed <socket.socket fd=1276, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65472), raddr=('172.217.9.10', 443)>
2020-08-22 15:43:01.709910 (Thread-1): unclosed <socket.socket fd=356, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65455), raddr=('172.217.6.138', 443)>
2020-08-22 15:43:01.709910 (Thread-1): unclosed <socket.socket fd=844, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65456), raddr=('172.217.9.10', 443)>
2020-08-22 15:43:01.713912 (Thread-1): unclosed <socket.socket fd=1136, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65462), raddr=('172.217.6.138', 443)>
2020-08-22 15:43:01.713912 (Thread-1): unclosed <socket.socket fd=1140, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65463), raddr=('172.217.9.10', 443)>
2020-08-22 15:43:01.715912 (Thread-1): unclosed <socket.socket fd=1224, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65470), raddr=('172.217.9.10', 443)>
2020-08-22 15:43:01.715912 (Thread-1): unclosed <socket.socket fd=1212, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65469), raddr=('172.217.6.138', 443)>
2020-08-22 15:43:01.719904 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2020-08-22 15:43:01.720913 (Thread-1): finished collecting timing info
2020-08-22 15:43:01.721904 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id"} */




select count(*) as validation_errors
from (

    select
        customer_id

    from `quick-asset-287211`.`dbt_alice`.`stg_customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors


2020-08-22 15:43:02.645583 (Thread-1): finished collecting timing info
2020-08-22 15:43:02.645583 (Thread-1): 10:43:02 | 8 of 9 PASS unique_stg_customers_customer_id......................... [PASS in 0.95s]
2020-08-22 15:43:02.646583 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2020-08-22 15:43:02.646583 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id
2020-08-22 15:43:02.646583 (Thread-1): 10:43:02 | 9 of 9 START test unique_stg_orders_order_id......................... [RUN]
2020-08-22 15:43:02.647583 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id".
2020-08-22 15:43:02.647583 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:43:02.647583 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id
2020-08-22 15:43:02.651593 (Thread-1): unclosed <socket.socket fd=880, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65473), raddr=('172.217.6.138', 443)>
2020-08-22 15:43:02.651593 (Thread-1): unclosed <socket.socket fd=1272, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65474), raddr=('172.217.9.10', 443)>
2020-08-22 15:43:02.657593 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id"
2020-08-22 15:43:02.658595 (Thread-1): finished collecting timing info
2020-08-22 15:43:02.659585 (Thread-1): On test.jaffle_shop.unique_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id"} */




select count(*) as validation_errors
from (

    select
        order_id

    from `quick-asset-287211`.`dbt_alice`.`stg_orders`
    where order_id is not null
    group by order_id
    having count(*) > 1

) validation_errors


2020-08-22 15:43:03.662295 (Thread-1): finished collecting timing info
2020-08-22 15:43:03.662295 (Thread-1): 10:43:03 | 9 of 9 PASS unique_stg_orders_order_id............................... [PASS in 1.01s]
2020-08-22 15:43:03.663380 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id
2020-08-22 15:43:03.711569 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:43:03.711569 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:43:03.712573 (MainThread): 10:43:03 | 
2020-08-22 15:43:03.712573 (MainThread): 10:43:03 | Finished running 9 tests in 8.03s.
2020-08-22 15:43:03.713574 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:43:03.713574 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:43:03.713574 (MainThread): Connection 'test.jaffle_shop.unique_stg_orders_order_id' was properly closed.
2020-08-22 15:43:03.740588 (MainThread): 
2020-08-22 15:43:03.740588 (MainThread): Completed with 2 errors and 0 warnings:
2020-08-22 15:43:03.741580 (MainThread): 
2020-08-22 15:43:03.741580 (MainThread): Database Error in test not_null_customers_firstn_nm (models\schema.yml)
2020-08-22 15:43:03.742589 (MainThread):   Unrecognized name: firstn_nm; Did you mean first_name? at [8:7]
2020-08-22 15:43:03.742589 (MainThread):   compiled SQL at target\compiled\jaffle_shop\models\schema.yml\schema_test\not_null_customers_firstn_nm.sql
2020-08-22 15:43:03.744581 (MainThread): 
2020-08-22 15:43:03.744581 (MainThread): Database Error in test unique_customers_firstn_nm (models\schema.yml)
2020-08-22 15:43:03.745589 (MainThread):   Unrecognized name: firstn_nm; Did you mean first_name? at [13:11]
2020-08-22 15:43:03.745589 (MainThread):   compiled SQL at target\compiled\jaffle_shop\models\schema.yml\schema_test\unique_customers_firstn_nm.sql
2020-08-22 15:43:03.746589 (MainThread): 
Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
2020-08-22 15:43:03.746589 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446B481388>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446B320B08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446B82F608>]}
2020-08-22 15:43:03.746589 (MainThread): Flushing usage events
2020-08-22 15:43:14.397068 (MainThread): Running with dbt=0.17.2
2020-08-22 15:43:14.714393 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-08-22 15:43:14.715393 (MainThread): Tracking: tracking
2020-08-22 15:43:14.715393 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66732B488>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66732B5C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66732BC08>]}
2020-08-22 15:43:14.764404 (MainThread): Partial parsing not enabled
2020-08-22 15:43:14.767404 (MainThread): Parsing macros\core.sql
2020-08-22 15:43:14.774405 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:43:14.845421 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:43:14.857424 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:43:14.858424 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:43:14.860425 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:43:14.863425 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:43:14.865426 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:43:14.866426 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:43:14.876428 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:43:14.895433 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:43:14.897433 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:43:14.906435 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:43:14.934441 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:43:14.971449 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:43:14.973450 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:43:14.995455 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:43:15.004458 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:43:15.011459 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:43:15.019460 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:43:15.022461 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:43:15.023461 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:43:15.024462 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:43:15.027462 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:43:15.047467 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:43:15.055468 (MainThread): Parsing macros\etc.sql
2020-08-22 15:43:15.056469 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:43:15.073473 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:43:15.076473 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:43:15.079474 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:43:15.091477 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:43:15.117482 (MainThread): Partial parsing not enabled
2020-08-22 15:43:15.157491 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:43:15.157491 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:43:15.191500 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:43:15.191500 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:43:15.201501 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:43:15.201501 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:43:15.538577 (MainThread): Found 3 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:43:15.539578 (MainThread): 
2020-08-22 15:43:15.539578 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:43:15.539578 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:43:15.557582 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:43:15.557582 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:43:15.558582 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:43:16.007189 (MainThread): 10:43:16 | Concurrency: 1 threads (target='dev')
2020-08-22 15:43:16.007189 (MainThread): 10:43:16 | 
2020-08-22 15:43:16.010248 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-08-22 15:43:16.011244 (Thread-1): 10:43:16 | 1 of 9 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [RUN]
2020-08-22 15:43:16.011244 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned".
2020-08-22 15:43:16.011244 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:43:16.011244 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-08-22 15:43:16.035259 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"
2020-08-22 15:43:16.036259 (Thread-1): finished collecting timing info
2020-08-22 15:43:16.037250 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"} */





with all_values as (

    select distinct
        status as value_field

    from `quick-asset-287211`.`dbt_alice`.`stg_orders`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'placed','shipped','completed','return_pending','returned'
    )
)

select count(*) as validation_errors
from validation_errors


2020-08-22 15:43:17.058803 (Thread-1): finished collecting timing info
2020-08-22 15:43:17.058803 (Thread-1): 10:43:17 | 1 of 9 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [PASS in 1.05s]
2020-08-22 15:43:17.059803 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-08-22 15:43:17.059803 (Thread-1): Began running node test.jaffle_shop.not_null_customers_first_nm
2020-08-22 15:43:17.059803 (Thread-1): 10:43:17 | 2 of 9 START test not_null_customers_first_nm........................ [RUN]
2020-08-22 15:43:17.060803 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_first_nm".
2020-08-22 15:43:17.060803 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:43:17.060803 (Thread-1): Compiling test.jaffle_shop.not_null_customers_first_nm
2020-08-22 15:43:17.069805 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_first_nm"
2020-08-22 15:43:17.070805 (Thread-1): finished collecting timing info
2020-08-22 15:43:17.071806 (Thread-1): On test.jaffle_shop.not_null_customers_first_nm: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_first_nm"} */




select count(*) as validation_errors
from `quick-asset-287211`.`dbt_alice`.`customers`
where first_nm is null


2020-08-22 15:43:17.520962 (Thread-1): finished collecting timing info
2020-08-22 15:43:17.520962 (Thread-1): Database Error in test not_null_customers_first_nm (models\schema.yml)
  Unrecognized name: first_nm; Did you mean first_name? at [8:7]
  compiled SQL at target\compiled\jaffle_shop\models\schema.yml\schema_test\not_null_customers_first_nm.sql
Traceback (most recent call last):
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 85, in exception_handler
    yield
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 364, in _retry_and_handle
    deadline=None)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 226, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 353, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\future\polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Unrecognized name: first_nm; Did you mean first_name? at [8:7]

(job ID: bdd07d40-f4e3-4181-a582-d6c8c676ce15)

                                                                 -----Query Job SQL Follows-----                                                                  

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_first_nm"} */
   2:
   3:
   4:
   5:
   6:select count(*) as validation_errors
   7:from `quick-asset-287211`.`dbt_alice`.`customers`
   8:where first_nm is null
   9:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 607, in execute
    failed_rows = self.execute_schema_test(test)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 587, in execute_schema_test
    fetch=True,
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\base\impl.py", line 228, in execute
    fetch=fetch
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 235, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 228, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 364, in _retry_and_handle
    deadline=None)
  File "c:\users\bhala\.conda\envs\dbt\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 89, in exception_handler
    self.handle_error(e, message)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 77, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in test not_null_customers_first_nm (models\schema.yml)
  Unrecognized name: first_nm; Did you mean first_name? at [8:7]
  compiled SQL at target\compiled\jaffle_shop\models\schema.yml\schema_test\not_null_customers_first_nm.sql
2020-08-22 15:43:17.523963 (Thread-1): 10:43:17 | 2 of 9 ERROR not_null_customers_first_nm............................. [ERROR in 0.46s]
2020-08-22 15:43:17.524673 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_first_nm
2020-08-22 15:43:17.524673 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-08-22 15:43:17.524673 (Thread-1): 10:43:17 | 3 of 9 START test not_null_stg_customers_customer_id................. [RUN]
2020-08-22 15:43:17.525676 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2020-08-22 15:43:17.525676 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:43:17.525676 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2020-08-22 15:43:17.527686 (Thread-1): unclosed <socket.socket fd=1044, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65487), raddr=('216.58.194.138', 443)>
2020-08-22 15:43:17.527686 (Thread-1): unclosed <socket.socket fd=1056, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65488), raddr=('172.217.9.10', 443)>
2020-08-22 15:43:17.535687 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2020-08-22 15:43:17.536719 (Thread-1): finished collecting timing info
2020-08-22 15:43:17.537679 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id"} */




select count(*) as validation_errors
from `quick-asset-287211`.`dbt_alice`.`stg_customers`
where customer_id is null


2020-08-22 15:43:18.404161 (Thread-1): finished collecting timing info
2020-08-22 15:43:18.404161 (Thread-1): 10:43:18 | 3 of 9 PASS not_null_stg_customers_customer_id....................... [PASS in 0.88s]
2020-08-22 15:43:18.404998 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-08-22 15:43:18.404998 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_customer_id
2020-08-22 15:43:18.404998 (Thread-1): 10:43:18 | 4 of 9 START test not_null_stg_orders_customer_id.................... [RUN]
2020-08-22 15:43:18.405991 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_customer_id".
2020-08-22 15:43:18.405991 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:43:18.405991 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_customer_id
2020-08-22 15:43:18.410990 (Thread-1): unclosed <socket.socket fd=752, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65489), raddr=('216.58.194.138', 443)>
2020-08-22 15:43:18.410990 (Thread-1): unclosed <socket.socket fd=1092, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65490), raddr=('172.217.9.10', 443)>
2020-08-22 15:43:18.415992 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id"
2020-08-22 15:43:18.416992 (Thread-1): finished collecting timing info
2020-08-22 15:43:18.416992 (Thread-1): On test.jaffle_shop.not_null_stg_orders_customer_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_customer_id"} */




select count(*) as validation_errors
from `quick-asset-287211`.`dbt_alice`.`stg_orders`
where customer_id is null


2020-08-22 15:43:19.355730 (Thread-1): finished collecting timing info
2020-08-22 15:43:19.355730 (Thread-1): 10:43:19 | 4 of 9 PASS not_null_stg_orders_customer_id.......................... [PASS in 0.95s]
2020-08-22 15:43:19.356729 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_customer_id
2020-08-22 15:43:19.356729 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id
2020-08-22 15:43:19.356729 (Thread-1): 10:43:19 | 5 of 9 START test not_null_stg_orders_order_id....................... [RUN]
2020-08-22 15:43:19.357729 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id".
2020-08-22 15:43:19.357729 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:43:19.357729 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id
2020-08-22 15:43:19.366739 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id"
2020-08-22 15:43:19.367739 (Thread-1): finished collecting timing info
2020-08-22 15:43:19.368732 (Thread-1): On test.jaffle_shop.not_null_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id"} */




select count(*) as validation_errors
from `quick-asset-287211`.`dbt_alice`.`stg_orders`
where order_id is null


2020-08-22 15:43:20.375398 (Thread-1): finished collecting timing info
2020-08-22 15:43:20.375398 (Thread-1): 10:43:20 | 5 of 9 PASS not_null_stg_orders_order_id............................. [PASS in 1.02s]
2020-08-22 15:43:20.376398 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id
2020-08-22 15:43:20.376398 (Thread-1): Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_
2020-08-22 15:43:20.376398 (Thread-1): 10:43:20 | 6 of 9 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [RUN]
2020-08-22 15:43:20.376398 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_".
2020-08-22 15:43:20.377398 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:43:20.377398 (Thread-1): Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_
2020-08-22 15:43:20.381409 (Thread-1): unclosed <socket.socket fd=752, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65493), raddr=('216.58.194.138', 443)>
2020-08-22 15:43:20.381409 (Thread-1): unclosed <socket.socket fd=1184, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65494), raddr=('172.217.9.10', 443)>
2020-08-22 15:43:20.389410 (Thread-1): Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_"
2020-08-22 15:43:20.390402 (Thread-1): finished collecting timing info
2020-08-22 15:43:20.390402 (Thread-1): On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_"} */





select count(*) as validation_errors
from (
    select customer_id as id from `quick-asset-287211`.`dbt_alice`.`stg_orders`
) as child
left join (
    select customer_id as id from `quick-asset-287211`.`dbt_alice`.`stg_customers`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null


2020-08-22 15:43:21.276751 (Thread-1): finished collecting timing info
2020-08-22 15:43:21.276751 (Thread-1): 10:43:21 | 6 of 9 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [PASS in 0.90s]
2020-08-22 15:43:21.277752 (Thread-1): Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_
2020-08-22 15:43:21.277752 (Thread-1): Began running node test.jaffle_shop.unique_customers_first_nm
2020-08-22 15:43:21.277752 (Thread-1): 10:43:21 | 7 of 9 START test unique_customers_first_nm.......................... [RUN]
2020-08-22 15:43:21.278752 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_first_nm".
2020-08-22 15:43:21.278752 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:43:21.278752 (Thread-1): Compiling test.jaffle_shop.unique_customers_first_nm
2020-08-22 15:43:21.288764 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_first_nm"
2020-08-22 15:43:21.289755 (Thread-1): finished collecting timing info
2020-08-22 15:43:21.290755 (Thread-1): On test.jaffle_shop.unique_customers_first_nm: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_first_nm"} */




select count(*) as validation_errors
from (

    select
        first_nm

    from `quick-asset-287211`.`dbt_alice`.`customers`
    where first_nm is not null
    group by first_nm
    having count(*) > 1

) validation_errors


2020-08-22 15:43:21.673934 (Thread-1): finished collecting timing info
2020-08-22 15:43:21.673934 (Thread-1): Database Error in test unique_customers_first_nm (models\schema.yml)
  Unrecognized name: first_nm; Did you mean first_name? at [13:11]
  compiled SQL at target\compiled\jaffle_shop\models\schema.yml\schema_test\unique_customers_first_nm.sql
Traceback (most recent call last):
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 85, in exception_handler
    yield
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 364, in _retry_and_handle
    deadline=None)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 226, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 353, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\cloud\bigquery\job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\google\api_core\future\polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Unrecognized name: first_nm; Did you mean first_name? at [13:11]

(job ID: 3c208e8c-aa03-4b43-9b3a-7e6919c5d5ea)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_first_nm"} */
   2:
   3:
   4:
   5:
   6:select count(*) as validation_errors
   7:from (
   8:
   9:    select
  10:        first_nm
  11:
  12:    from `quick-asset-287211`.`dbt_alice`.`customers`
  13:    where first_nm is not null
  14:    group by first_nm
  15:    having count(*) > 1
  16:
  17:) validation_errors
  18:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 607, in execute
    failed_rows = self.execute_schema_test(test)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\node_runners.py", line 587, in execute_schema_test
    fetch=True,
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\base\impl.py", line 228, in execute
    fetch=fetch
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 235, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 228, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 364, in _retry_and_handle
    deadline=None)
  File "c:\users\bhala\.conda\envs\dbt\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 89, in exception_handler
    self.handle_error(e, message)
  File "c:\users\bhala\.conda\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 77, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in test unique_customers_first_nm (models\schema.yml)
  Unrecognized name: first_nm; Did you mean first_name? at [13:11]
  compiled SQL at target\compiled\jaffle_shop\models\schema.yml\schema_test\unique_customers_first_nm.sql
2020-08-22 15:43:21.674937 (Thread-1): 10:43:21 | 7 of 9 ERROR unique_customers_first_nm............................... [ERROR in 0.40s]
2020-08-22 15:43:21.675937 (Thread-1): Finished running node test.jaffle_shop.unique_customers_first_nm
2020-08-22 15:43:21.675937 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2020-08-22 15:43:21.676937 (Thread-1): 10:43:21 | 8 of 9 START test unique_stg_customers_customer_id................... [RUN]
2020-08-22 15:43:21.676937 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2020-08-22 15:43:21.676937 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:43:21.676937 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2020-08-22 15:43:21.679938 (Thread-1): unclosed <socket.socket fd=884, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65498), raddr=('216.58.194.138', 443)>
2020-08-22 15:43:21.679938 (Thread-1): unclosed <socket.socket fd=1268, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65499), raddr=('172.217.9.10', 443)>
2020-08-22 15:43:21.686947 (Thread-1): unclosed <socket.socket fd=952, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65485), raddr=('216.58.194.138', 443)>
2020-08-22 15:43:21.686947 (Thread-1): unclosed <socket.socket fd=956, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65486), raddr=('172.217.9.10', 443)>
2020-08-22 15:43:21.690940 (Thread-1): unclosed <socket.socket fd=1124, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65491), raddr=('216.58.194.138', 443)>
2020-08-22 15:43:21.690940 (Thread-1): unclosed <socket.socket fd=1132, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65492), raddr=('172.217.9.10', 443)>
2020-08-22 15:43:21.693941 (Thread-1): unclosed <socket.socket fd=1212, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65497), raddr=('172.217.9.10', 443)>
2020-08-22 15:43:21.693941 (Thread-1): unclosed <socket.socket fd=1208, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65496), raddr=('216.58.194.138', 443)>
2020-08-22 15:43:21.697942 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2020-08-22 15:43:21.698942 (Thread-1): finished collecting timing info
2020-08-22 15:43:21.698942 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id"} */




select count(*) as validation_errors
from (

    select
        customer_id

    from `quick-asset-287211`.`dbt_alice`.`stg_customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors


2020-08-22 15:43:22.613036 (Thread-1): finished collecting timing info
2020-08-22 15:43:22.613036 (Thread-1): 10:43:22 | 8 of 9 PASS unique_stg_customers_customer_id......................... [PASS in 0.94s]
2020-08-22 15:43:22.614157 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2020-08-22 15:43:22.614157 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id
2020-08-22 15:43:22.614157 (Thread-1): 10:43:22 | 9 of 9 START test unique_stg_orders_order_id......................... [RUN]
2020-08-22 15:43:22.615037 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id".
2020-08-22 15:43:22.615037 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:43:22.615037 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id
2020-08-22 15:43:22.619046 (Thread-1): unclosed <socket.socket fd=1260, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65500), raddr=('216.58.194.138', 443)>
2020-08-22 15:43:22.619046 (Thread-1): unclosed <socket.socket fd=776, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65501), raddr=('172.217.9.10', 443)>
2020-08-22 15:43:22.625047 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id"
2020-08-22 15:43:22.626039 (Thread-1): finished collecting timing info
2020-08-22 15:43:22.627039 (Thread-1): On test.jaffle_shop.unique_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id"} */




select count(*) as validation_errors
from (

    select
        order_id

    from `quick-asset-287211`.`dbt_alice`.`stg_orders`
    where order_id is not null
    group by order_id
    having count(*) > 1

) validation_errors


2020-08-22 15:43:23.454720 (Thread-1): finished collecting timing info
2020-08-22 15:43:23.454720 (Thread-1): 10:43:23 | 9 of 9 PASS unique_stg_orders_order_id............................... [PASS in 0.84s]
2020-08-22 15:43:23.455720 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id
2020-08-22 15:43:23.531921 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:43:23.531921 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:43:23.532934 (MainThread): 10:43:23 | 
2020-08-22 15:43:23.533113 (MainThread): 10:43:23 | Finished running 9 tests in 7.99s.
2020-08-22 15:43:23.534118 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:43:23.534118 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:43:23.534118 (MainThread): Connection 'test.jaffle_shop.unique_stg_orders_order_id' was properly closed.
2020-08-22 15:43:23.561122 (MainThread): 
2020-08-22 15:43:23.561122 (MainThread): Completed with 2 errors and 0 warnings:
2020-08-22 15:43:23.562122 (MainThread): 
2020-08-22 15:43:23.562122 (MainThread): Database Error in test not_null_customers_first_nm (models\schema.yml)
2020-08-22 15:43:23.564123 (MainThread):   Unrecognized name: first_nm; Did you mean first_name? at [8:7]
2020-08-22 15:43:23.564123 (MainThread):   compiled SQL at target\compiled\jaffle_shop\models\schema.yml\schema_test\not_null_customers_first_nm.sql
2020-08-22 15:43:23.564123 (MainThread): 
2020-08-22 15:43:23.565123 (MainThread): Database Error in test unique_customers_first_nm (models\schema.yml)
2020-08-22 15:43:23.565123 (MainThread):   Unrecognized name: first_nm; Did you mean first_name? at [13:11]
2020-08-22 15:43:23.566123 (MainThread):   compiled SQL at target\compiled\jaffle_shop\models\schema.yml\schema_test\unique_customers_first_nm.sql
2020-08-22 15:43:23.566123 (MainThread): 
Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
2020-08-22 15:43:23.567123 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B667702D08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B667702448>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6677B2E08>]}
2020-08-22 15:43:23.567123 (MainThread): Flushing usage events
2020-08-22 15:43:36.417975 (MainThread): Running with dbt=0.17.2
2020-08-22 15:43:36.741040 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-08-22 15:43:36.742040 (MainThread): Tracking: tracking
2020-08-22 15:43:36.743094 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE800EB648>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE800EB748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE800EBEC8>]}
2020-08-22 15:43:36.792059 (MainThread): Partial parsing not enabled
2020-08-22 15:43:36.796062 (MainThread): Parsing macros\core.sql
2020-08-22 15:43:36.802053 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:43:36.866067 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:43:36.879079 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:43:36.880080 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:43:36.882080 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:43:36.885080 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:43:36.887081 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:43:36.889072 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:43:36.900075 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:43:36.920079 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:43:36.923081 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:43:36.932084 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:43:36.961090 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:43:37.000097 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:43:37.002108 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:43:37.024221 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:43:37.033239 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:43:37.040254 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:43:37.048268 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:43:37.051118 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:43:37.052257 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:43:37.054296 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:43:37.056286 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:43:37.077124 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:43:37.086126 (MainThread): Parsing macros\etc.sql
2020-08-22 15:43:37.087126 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:43:37.104130 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:43:37.107130 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:43:37.110131 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:43:37.123134 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:43:37.148140 (MainThread): Partial parsing not enabled
2020-08-22 15:43:37.191149 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:43:37.191149 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:43:37.226157 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:43:37.226157 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:43:37.237160 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:43:37.237160 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:43:37.587239 (MainThread): Found 3 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:43:37.588230 (MainThread): 
2020-08-22 15:43:37.589232 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:43:37.589232 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:43:37.607235 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:43:37.607235 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:43:37.608244 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:43:37.930980 (MainThread): 10:43:37 | Concurrency: 1 threads (target='dev')
2020-08-22 15:43:37.931894 (MainThread): 10:43:37 | 
2020-08-22 15:43:37.935096 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-08-22 15:43:37.936096 (Thread-1): 10:43:37 | 1 of 9 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [RUN]
2020-08-22 15:43:37.936096 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned".
2020-08-22 15:43:37.936096 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:43:37.936096 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-08-22 15:43:37.960110 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"
2020-08-22 15:43:37.961110 (Thread-1): finished collecting timing info
2020-08-22 15:43:37.962102 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"} */





with all_values as (

    select distinct
        status as value_field

    from `quick-asset-287211`.`dbt_alice`.`stg_orders`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'placed','shipped','completed','return_pending','returned'
    )
)

select count(*) as validation_errors
from validation_errors


2020-08-22 15:43:38.985489 (Thread-1): finished collecting timing info
2020-08-22 15:43:38.985489 (Thread-1): 10:43:38 | 1 of 9 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [PASS in 1.05s]
2020-08-22 15:43:38.986490 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-08-22 15:43:38.986490 (Thread-1): Began running node test.jaffle_shop.not_null_customers_first_name
2020-08-22 15:43:38.987490 (Thread-1): 10:43:38 | 2 of 9 START test not_null_customers_first_name...................... [RUN]
2020-08-22 15:43:38.987490 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_first_name".
2020-08-22 15:43:38.987490 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:43:38.987490 (Thread-1): Compiling test.jaffle_shop.not_null_customers_first_name
2020-08-22 15:43:38.997492 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_first_name"
2020-08-22 15:43:38.998493 (Thread-1): finished collecting timing info
2020-08-22 15:43:38.999492 (Thread-1): On test.jaffle_shop.not_null_customers_first_name: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_first_name"} */




select count(*) as validation_errors
from `quick-asset-287211`.`dbt_alice`.`customers`
where first_name is null


2020-08-22 15:43:40.127678 (Thread-1): finished collecting timing info
2020-08-22 15:43:40.127678 (Thread-1): 10:43:40 | 2 of 9 PASS not_null_customers_first_name............................ [PASS in 1.14s]
2020-08-22 15:43:40.128678 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_first_name
2020-08-22 15:43:40.128678 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-08-22 15:43:40.128678 (Thread-1): 10:43:40 | 3 of 9 START test not_null_stg_customers_customer_id................. [RUN]
2020-08-22 15:43:40.129678 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2020-08-22 15:43:40.129678 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:43:40.129678 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2020-08-22 15:43:40.132670 (Thread-1): unclosed <socket.socket fd=1044, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65514), raddr=('216.58.194.138', 443)>
2020-08-22 15:43:40.132670 (Thread-1): unclosed <socket.socket fd=1056, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65515), raddr=('172.217.9.10', 443)>
2020-08-22 15:43:40.139680 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2020-08-22 15:43:40.140672 (Thread-1): finished collecting timing info
2020-08-22 15:43:40.140672 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id"} */




select count(*) as validation_errors
from `quick-asset-287211`.`dbt_alice`.`stg_customers`
where customer_id is null


2020-08-22 15:43:40.991150 (Thread-1): finished collecting timing info
2020-08-22 15:43:40.992149 (Thread-1): 10:43:40 | 3 of 9 PASS not_null_stg_customers_customer_id....................... [PASS in 0.86s]
2020-08-22 15:43:40.993149 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-08-22 15:43:40.993149 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_customer_id
2020-08-22 15:43:40.994151 (Thread-1): 10:43:40 | 4 of 9 START test not_null_stg_orders_customer_id.................... [RUN]
2020-08-22 15:43:40.994151 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_customer_id".
2020-08-22 15:43:40.994151 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:43:40.994151 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_customer_id
2020-08-22 15:43:41.002152 (Thread-1): unclosed <socket.socket fd=1080, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65516), raddr=('216.58.194.138', 443)>
2020-08-22 15:43:41.003152 (Thread-1): unclosed <socket.socket fd=1092, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65517), raddr=('172.217.9.10', 443)>
2020-08-22 15:43:41.009153 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id"
2020-08-22 15:43:41.009153 (Thread-1): finished collecting timing info
2020-08-22 15:43:41.010154 (Thread-1): On test.jaffle_shop.not_null_stg_orders_customer_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_customer_id"} */




select count(*) as validation_errors
from `quick-asset-287211`.`dbt_alice`.`stg_orders`
where customer_id is null


2020-08-22 15:43:41.841549 (Thread-1): finished collecting timing info
2020-08-22 15:43:41.841549 (Thread-1): 10:43:41 | 4 of 9 PASS not_null_stg_orders_customer_id.......................... [PASS in 0.85s]
2020-08-22 15:43:41.847377 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_customer_id
2020-08-22 15:43:41.848377 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id
2020-08-22 15:43:41.848377 (Thread-1): 10:43:41 | 5 of 9 START test not_null_stg_orders_order_id....................... [RUN]
2020-08-22 15:43:41.848377 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id".
2020-08-22 15:43:41.848377 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:43:41.849377 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id
2020-08-22 15:43:41.859389 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id"
2020-08-22 15:43:41.859389 (Thread-1): finished collecting timing info
2020-08-22 15:43:41.860381 (Thread-1): On test.jaffle_shop.not_null_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id"} */




select count(*) as validation_errors
from `quick-asset-287211`.`dbt_alice`.`stg_orders`
where order_id is null


2020-08-22 15:43:42.693004 (Thread-1): finished collecting timing info
2020-08-22 15:43:42.693004 (Thread-1): 10:43:42 | 5 of 9 PASS not_null_stg_orders_order_id............................. [PASS in 0.84s]
2020-08-22 15:43:42.694003 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id
2020-08-22 15:43:42.694003 (Thread-1): Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_
2020-08-22 15:43:42.694003 (Thread-1): 10:43:42 | 6 of 9 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [RUN]
2020-08-22 15:43:42.694993 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_".
2020-08-22 15:43:42.694993 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:43:42.694993 (Thread-1): Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_
2020-08-22 15:43:42.700003 (Thread-1): unclosed <socket.socket fd=832, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65520), raddr=('216.58.194.138', 443)>
2020-08-22 15:43:42.700003 (Thread-1): unclosed <socket.socket fd=1164, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65521), raddr=('172.217.9.10', 443)>
2020-08-22 15:43:42.707004 (Thread-1): Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_"
2020-08-22 15:43:42.708004 (Thread-1): finished collecting timing info
2020-08-22 15:43:42.708004 (Thread-1): On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_"} */





select count(*) as validation_errors
from (
    select customer_id as id from `quick-asset-287211`.`dbt_alice`.`stg_orders`
) as child
left join (
    select customer_id as id from `quick-asset-287211`.`dbt_alice`.`stg_customers`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null


2020-08-22 15:43:43.792711 (Thread-1): finished collecting timing info
2020-08-22 15:43:43.792711 (Thread-1): 10:43:43 | 6 of 9 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [PASS in 1.10s]
2020-08-22 15:43:43.793711 (Thread-1): Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_
2020-08-22 15:43:43.793711 (Thread-1): Began running node test.jaffle_shop.unique_customers_first_name
2020-08-22 15:43:43.793711 (Thread-1): 10:43:43 | 7 of 9 START test unique_customers_first_name........................ [RUN]
2020-08-22 15:43:43.794712 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_first_name".
2020-08-22 15:43:43.794712 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:43:43.794712 (Thread-1): Compiling test.jaffle_shop.unique_customers_first_name
2020-08-22 15:43:43.803713 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_first_name"
2020-08-22 15:43:43.804713 (Thread-1): finished collecting timing info
2020-08-22 15:43:43.805706 (Thread-1): On test.jaffle_shop.unique_customers_first_name: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_first_name"} */




select count(*) as validation_errors
from (

    select
        first_name

    from `quick-asset-287211`.`dbt_alice`.`customers`
    where first_name is not null
    group by first_name
    having count(*) > 1

) validation_errors


2020-08-22 15:43:44.954054 (Thread-1): finished collecting timing info
2020-08-22 15:43:44.954054 (Thread-1): 10:43:44 | 7 of 9 FAIL 19 unique_customers_first_name........................... [FAIL 19 in 1.16s]
2020-08-22 15:43:44.955054 (Thread-1): Finished running node test.jaffle_shop.unique_customers_first_name
2020-08-22 15:43:44.955054 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2020-08-22 15:43:44.955054 (Thread-1): 10:43:44 | 8 of 9 START test unique_stg_customers_customer_id................... [RUN]
2020-08-22 15:43:44.956054 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2020-08-22 15:43:44.956054 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:43:44.956054 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2020-08-22 15:43:44.960055 (Thread-1): unclosed <socket.socket fd=1232, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65524), raddr=('216.58.194.138', 443)>
2020-08-22 15:43:44.960055 (Thread-1): unclosed <socket.socket fd=1260, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65525), raddr=('172.217.9.10', 443)>
2020-08-22 15:43:44.966056 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2020-08-22 15:43:44.967056 (Thread-1): finished collecting timing info
2020-08-22 15:43:44.968057 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id"} */




select count(*) as validation_errors
from (

    select
        customer_id

    from `quick-asset-287211`.`dbt_alice`.`stg_customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors


2020-08-22 15:43:44.969057 (Thread-1): unclosed <socket.socket fd=844, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65512), raddr=('216.58.194.138', 443)>
2020-08-22 15:43:44.969057 (Thread-1): unclosed <socket.socket fd=688, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65513), raddr=('172.217.9.10', 443)>
2020-08-22 15:43:44.973057 (Thread-1): unclosed <socket.socket fd=1088, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65518), raddr=('216.58.194.138', 443)>
2020-08-22 15:43:44.974057 (Thread-1): unclosed <socket.socket fd=880, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65519), raddr=('172.217.9.10', 443)>
2020-08-22 15:43:44.976058 (Thread-1): unclosed <socket.socket fd=680, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65522), raddr=('216.58.194.138', 443)>
2020-08-22 15:43:44.976058 (Thread-1): unclosed <socket.socket fd=1176, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.5', 65523), raddr=('172.217.9.10', 443)>
2020-08-22 15:43:45.809282 (Thread-1): finished collecting timing info
2020-08-22 15:43:45.809282 (Thread-1): 10:43:45 | 8 of 9 PASS unique_stg_customers_customer_id......................... [PASS in 0.85s]
2020-08-22 15:43:45.810282 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2020-08-22 15:43:45.810282 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id
2020-08-22 15:43:45.810282 (Thread-1): 10:43:45 | 9 of 9 START test unique_stg_orders_order_id......................... [RUN]
2020-08-22 15:43:45.810282 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id".
2020-08-22 15:43:45.811282 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:43:45.811282 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id
2020-08-22 15:43:45.820293 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id"
2020-08-22 15:43:45.821293 (Thread-1): finished collecting timing info
2020-08-22 15:43:45.822294 (Thread-1): On test.jaffle_shop.unique_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id"} */




select count(*) as validation_errors
from (

    select
        order_id

    from `quick-asset-287211`.`dbt_alice`.`stg_orders`
    where order_id is not null
    group by order_id
    having count(*) > 1

) validation_errors


2020-08-22 15:43:46.748979 (Thread-1): finished collecting timing info
2020-08-22 15:43:46.748979 (Thread-1): 10:43:46 | 9 of 9 PASS unique_stg_orders_order_id............................... [PASS in 0.94s]
2020-08-22 15:43:46.749980 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id
2020-08-22 15:43:46.778324 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:43:46.778324 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:43:46.779327 (MainThread): 10:43:46 | 
2020-08-22 15:43:46.779327 (MainThread): 10:43:46 | Finished running 9 tests in 9.19s.
2020-08-22 15:43:46.780335 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:43:46.780335 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:43:46.780335 (MainThread): Connection 'test.jaffle_shop.unique_stg_orders_order_id' was properly closed.
2020-08-22 15:43:46.808333 (MainThread): 
2020-08-22 15:43:46.808333 (MainThread): Completed with 1 error and 0 warnings:
2020-08-22 15:43:46.809333 (MainThread): 
2020-08-22 15:43:46.809333 (MainThread): Failure in test unique_customers_first_name (models\schema.yml)
2020-08-22 15:43:46.810334 (MainThread):   Got 19 results, expected 0.
2020-08-22 15:43:46.811342 (MainThread): 
2020-08-22 15:43:46.811342 (MainThread):   compiled SQL at target\compiled\jaffle_shop\models\schema.yml\schema_test\unique_customers_first_name.sql
2020-08-22 15:43:46.812343 (MainThread): 
Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
2020-08-22 15:43:46.812343 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE8064BA48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE8064BA88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE80294208>]}
2020-08-22 15:43:46.813343 (MainThread): Flushing usage events
2020-08-22 15:46:20.603824 (MainThread): Running with dbt=0.17.2
2020-08-22 15:46:20.926896 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-08-22 15:46:20.927896 (MainThread): Tracking: tracking
2020-08-22 15:46:20.927896 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DBDEEB788>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DBDEEBA48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DBDEEB9C8>]}
2020-08-22 15:46:20.981908 (MainThread): Partial parsing not enabled
2020-08-22 15:46:20.985909 (MainThread): Parsing macros\core.sql
2020-08-22 15:46:20.992293 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:46:21.057308 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:46:21.068310 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:46:21.070310 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:46:21.072310 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:46:21.074311 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:46:21.077312 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:46:21.078312 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:46:21.089315 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:46:21.107318 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:46:21.110319 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:46:21.118321 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:46:21.145327 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:46:21.183335 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:46:21.185336 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:46:21.206341 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:46:21.215343 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:46:21.221344 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:46:21.230346 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:46:21.232347 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:46:21.234347 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:46:21.235347 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:46:21.237348 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:46:21.257352 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:46:21.265354 (MainThread): Parsing macros\etc.sql
2020-08-22 15:46:21.266354 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:46:21.285360 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:46:21.289360 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:46:21.291361 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:46:21.306363 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:46:21.332370 (MainThread): Partial parsing not enabled
2020-08-22 15:46:21.373379 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:46:21.373379 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:46:21.406387 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:46:21.406387 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:46:21.416389 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:46:21.417389 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:46:21.725467 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:46:21.726459 (MainThread): 
2020-08-22 15:46:21.727458 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:46:21.727458 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:46:21.742463 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:46:21.742463 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 15:46:21.742463 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:46:22.099324 (MainThread): 10:46:22 | Concurrency: 1 threads (target='dev')
2020-08-22 15:46:22.099324 (MainThread): 10:46:22 | 
2020-08-22 15:46:22.103195 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-08-22 15:46:22.103195 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:46:22.103195 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:46:22.103195 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-08-22 15:46:22.122202 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-08-22 15:46:22.123202 (Thread-1): finished collecting timing info
2020-08-22 15:46:22.123202 (Thread-1): finished collecting timing info
2020-08-22 15:46:22.124202 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-08-22 15:46:22.124202 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-08-22 15:46:22.124202 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:46:22.125202 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:46:22.125202 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-08-22 15:46:22.132204 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:46:22.132204 (Thread-1): finished collecting timing info
2020-08-22 15:46:22.132204 (Thread-1): finished collecting timing info
2020-08-22 15:46:22.133204 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-08-22 15:46:22.133204 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-08-22 15:46:22.133204 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2020-08-22 15:46:22.134204 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:46:22.134204 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2020-08-22 15:46:22.150208 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2020-08-22 15:46:22.151208 (Thread-1): finished collecting timing info
2020-08-22 15:46:22.151208 (Thread-1): finished collecting timing info
2020-08-22 15:46:22.151208 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-08-22 15:46:22.151208 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2020-08-22 15:46:22.152210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2020-08-22 15:46:22.152210 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:46:22.152210 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2020-08-22 15:46:22.161211 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2020-08-22 15:46:22.162211 (Thread-1): finished collecting timing info
2020-08-22 15:46:22.163211 (Thread-1): finished collecting timing info
2020-08-22 15:46:22.163211 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2020-08-22 15:46:22.163211 (Thread-1): Began running node model.jaffle_shop.customers
2020-08-22 15:46:22.163211 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:46:22.163211 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:46:22.164211 (Thread-1): Compiling model.jaffle_shop.customers
2020-08-22 15:46:22.173213 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-08-22 15:46:22.174213 (Thread-1): finished collecting timing info
2020-08-22 15:46:22.174213 (Thread-1): finished collecting timing info
2020-08-22 15:46:22.175214 (Thread-1): Finished running node model.jaffle_shop.customers
2020-08-22 15:46:22.175214 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-08-22 15:46:22.175214 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned".
2020-08-22 15:46:22.175214 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:46:22.175214 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-08-22 15:46:22.186216 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"
2020-08-22 15:46:22.187216 (Thread-1): finished collecting timing info
2020-08-22 15:46:22.188217 (Thread-1): finished collecting timing info
2020-08-22 15:46:22.188217 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-08-22 15:46:22.188217 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id
2020-08-22 15:46:22.188217 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id".
2020-08-22 15:46:22.188217 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:46:22.188217 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id
2020-08-22 15:46:22.198219 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id"
2020-08-22 15:46:22.199219 (Thread-1): finished collecting timing info
2020-08-22 15:46:22.199219 (Thread-1): finished collecting timing info
2020-08-22 15:46:22.199219 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id
2020-08-22 15:46:22.199219 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id
2020-08-22 15:46:22.200219 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id".
2020-08-22 15:46:22.200219 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:46:22.200219 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id
2020-08-22 15:46:22.209221 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id"
2020-08-22 15:46:22.210222 (Thread-1): finished collecting timing info
2020-08-22 15:46:22.210222 (Thread-1): finished collecting timing info
2020-08-22 15:46:22.210222 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id
2020-08-22 15:46:22.210222 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id
2020-08-22 15:46:22.211222 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id".
2020-08-22 15:46:22.211222 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:46:22.211222 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id
2020-08-22 15:46:22.220224 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id"
2020-08-22 15:46:22.221224 (Thread-1): finished collecting timing info
2020-08-22 15:46:22.221224 (Thread-1): finished collecting timing info
2020-08-22 15:46:22.221224 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id
2020-08-22 15:46:22.222224 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id
2020-08-22 15:46:22.222224 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id".
2020-08-22 15:46:22.222224 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:46:22.222224 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id
2020-08-22 15:46:22.232226 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id"
2020-08-22 15:46:22.232226 (Thread-1): finished collecting timing info
2020-08-22 15:46:22.233227 (Thread-1): finished collecting timing info
2020-08-22 15:46:22.233227 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id
2020-08-22 15:46:22.315867 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:46:22.315867 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:46:22.315867 (MainThread): Connection 'test.jaffle_shop.unique_customers_customer_id' was properly closed.
2020-08-22 15:46:22.346879 (MainThread): 10:46:22 | Done.
2020-08-22 15:46:22.733947 (MainThread): Acquiring new bigquery connection "generate_catalog".
2020-08-22 15:46:22.733947 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:46:22.733947 (MainThread): 10:46:22 | Building catalog
2020-08-22 15:46:23.095295 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "quick-asset-287211.information_schema".
2020-08-22 15:46:23.095295 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:46:23.113290 (ThreadPoolExecutor-1_0): On quick-asset-287211.information_schema: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "quick-asset-287211.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `quick-asset-287211`.`dbt_alice`.__TABLES__
        where (upper(dataset_id) = upper('dbt_alice'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `quick-asset-287211`.`dbt_alice`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `quick-asset-287211`.`dbt_alice`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2020-08-22 15:46:30.954823 (MainThread): 10:46:30 | Catalog written to C:\Users\bhala\jaffle-shop\target\catalog.json
2020-08-22 15:46:30.955825 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DBE2AD088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DBE2AD148>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DBE2AD288>]}
2020-08-22 15:46:30.955825 (MainThread): Flushing usage events
2020-08-22 15:46:31.269277 (MainThread): Connection 'generate_catalog' was properly closed.
2020-08-22 15:46:31.270276 (MainThread): Connection 'quick-asset-287211.information_schema' was properly closed.
2020-08-22 15:46:42.022508 (MainThread): Running with dbt=0.17.2
2020-08-22 15:46:42.345985 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-08-22 15:46:42.346986 (MainThread): Tracking: tracking
2020-08-22 15:46:42.346986 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BA5DB0FC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BA72A22C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BA72A2308>]}
2020-08-22 15:46:42.350987 (MainThread): Serving docs at 0.0.0.0:8080
2020-08-22 15:46:42.350987 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2020-08-22 15:46:42.351987 (MainThread): Press Ctrl+C to exit.


2020-08-22 15:48:10.311643 (MainThread): Flushing usage events
2020-08-22 15:48:10.600118 (MainThread): ctrl-c
2020-08-22 15:50:04.290586 (MainThread): Running with dbt=0.17.2
2020-08-22 15:50:04.614658 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-22 15:50:04.615651 (MainThread): Tracking: tracking
2020-08-22 15:50:04.615651 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025128CAB808>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025128CABC08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025128CAB648>]}
2020-08-22 15:50:04.664670 (MainThread): Partial parsing not enabled
2020-08-22 15:50:04.668671 (MainThread): Parsing macros\core.sql
2020-08-22 15:50:04.674672 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:50:04.737687 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:50:04.748680 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:50:04.749681 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:50:04.751690 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:50:04.754691 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:50:04.756691 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:50:04.758691 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:50:04.767693 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:50:04.786698 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:50:04.788698 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:50:04.797700 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:50:04.824706 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:50:04.862707 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:50:04.864707 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:50:04.886712 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:50:04.896714 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:50:04.903716 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:50:04.911717 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:50:04.914718 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:50:04.915719 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:50:04.917719 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:50:04.919719 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:50:04.941725 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:50:04.949726 (MainThread): Parsing macros\etc.sql
2020-08-22 15:50:04.950727 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:50:04.967730 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:50:04.971731 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:50:04.973732 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:50:04.987735 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:50:05.013741 (MainThread): Partial parsing not enabled
2020-08-22 15:50:05.055749 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:50:05.055749 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:50:05.090757 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:50:05.090757 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:50:05.100769 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:50:05.100769 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:50:05.415831 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:50:05.416832 (MainThread): 
2020-08-22 15:50:05.417832 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:50:05.417832 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:50:05.422832 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211".
2020-08-22 15:50:05.422832 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 15:50:05.870683 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:50:05.870683 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:50:05.871687 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:50:06.196108 (MainThread): 10:50:06 | Concurrency: 1 threads (target='dev')
2020-08-22 15:50:06.197220 (MainThread): 10:50:06 | 
2020-08-22 15:50:06.200224 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-08-22 15:50:06.202232 (Thread-1): 10:50:06 | 1 of 3 START table model dbt_alice.stg_customers..................... [RUN]
2020-08-22 15:50:06.202592 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:50:06.202592 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:50:06.202592 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-08-22 15:50:06.221607 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-08-22 15:50:06.222608 (Thread-1): finished collecting timing info
2020-08-22 15:50:06.249604 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:50:06.607091 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2020-08-22 15:50:06.608082 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`stg_customers`
  
  
  OPTIONS()
  as (
    select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers
  );
    
2020-08-22 15:50:09.097449 (Thread-1): finished collecting timing info
2020-08-22 15:50:09.098450 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cead0cbd-6ed3-475b-9b96-f8ecbfbd61f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025128E63888>]}
2020-08-22 15:50:09.099450 (Thread-1): 10:50:09 | 1 of 3 OK created table model dbt_alice.stg_customers................ [CREATE TABLE (100) in 2.90s]
2020-08-22 15:50:09.100450 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-08-22 15:50:09.100450 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-08-22 15:50:09.101450 (Thread-1): 10:50:09 | 2 of 3 START table model dbt_alice.stg_orders........................ [RUN]
2020-08-22 15:50:09.102450 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:50:09.102450 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:50:09.102450 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-08-22 15:50:09.108451 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:50:09.109452 (Thread-1): finished collecting timing info
2020-08-22 15:50:09.114453 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:50:09.467741 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:50:09.468740 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`stg_orders`
  
  
  OPTIONS()
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders
  );
    
2020-08-22 15:50:12.083289 (Thread-1): finished collecting timing info
2020-08-22 15:50:12.083289 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cead0cbd-6ed3-475b-9b96-f8ecbfbd61f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025128F2BFC8>]}
2020-08-22 15:50:12.084289 (Thread-1): 10:50:12 | 2 of 3 OK created table model dbt_alice.stg_orders................... [CREATE TABLE (99) in 2.98s]
2020-08-22 15:50:12.085291 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-08-22 15:50:12.085291 (Thread-1): Began running node model.jaffle_shop.customers
2020-08-22 15:50:12.087291 (Thread-1): 10:50:12 | 3 of 3 START table model dbt_alice.customers......................... [RUN]
2020-08-22 15:50:12.088006 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:50:12.088006 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:50:12.088006 (Thread-1): Compiling model.jaffle_shop.customers
2020-08-22 15:50:12.099020 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-08-22 15:50:12.099020 (Thread-1): finished collecting timing info
2020-08-22 15:50:12.104021 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:50:12.443853 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-08-22 15:50:12.444852 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `quick-asset-287211`.`dbt_alice`.`customers`
  
  
  OPTIONS()
  as (
    

with customers as (

    select * from `quick-asset-287211`.`dbt_alice`.`stg_customers`

),

orders as (

    select * from `quick-asset-287211`.`dbt_alice`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2020-08-22 15:50:14.436357 (Thread-1): finished collecting timing info
2020-08-22 15:50:14.436357 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cead0cbd-6ed3-475b-9b96-f8ecbfbd61f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025128DC0848>]}
2020-08-22 15:50:14.437358 (Thread-1): 10:50:14 | 3 of 3 OK created table model dbt_alice.customers.................... [CREATE TABLE (100) in 2.35s]
2020-08-22 15:50:14.438475 (Thread-1): Finished running node model.jaffle_shop.customers
2020-08-22 15:50:14.513054 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:50:14.513054 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:50:14.514054 (MainThread): 10:50:14 | 
2020-08-22 15:50:14.514267 (MainThread): 10:50:14 | Finished running 3 table models in 9.10s.
2020-08-22 15:50:14.515271 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:50:14.515271 (MainThread): Connection 'list_quick-asset-287211' was properly closed.
2020-08-22 15:50:14.515271 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:50:14.515271 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2020-08-22 15:50:14.525281 (MainThread): 
2020-08-22 15:50:14.526272 (MainThread): Completed successfully
2020-08-22 15:50:14.526272 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-08-22 15:50:14.527272 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025128F43B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025128EACC88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025128E952C8>]}
2020-08-22 15:50:14.527272 (MainThread): Flushing usage events
2020-08-22 15:50:18.970966 (MainThread): Running with dbt=0.17.2
2020-08-22 15:50:19.304898 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-08-22 15:50:19.305900 (MainThread): Tracking: tracking
2020-08-22 15:50:19.305900 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA3E0B808>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA3DE0A48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA3E0BD08>]}
2020-08-22 15:50:19.361911 (MainThread): Partial parsing not enabled
2020-08-22 15:50:19.364911 (MainThread): Parsing macros\core.sql
2020-08-22 15:50:19.371886 (MainThread): Parsing macros\adapters\common.sql
2020-08-22 15:50:19.435901 (MainThread): Parsing macros\etc\datetime.sql
2020-08-22 15:50:19.447893 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-08-22 15:50:19.448895 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-08-22 15:50:19.450904 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-08-22 15:50:19.453904 (MainThread): Parsing macros\etc\is_incremental.sql
2020-08-22 15:50:19.455905 (MainThread): Parsing macros\etc\query.sql
2020-08-22 15:50:19.457905 (MainThread): Parsing macros\materializations\helpers.sql
2020-08-22 15:50:19.466907 (MainThread): Parsing macros\materializations\common\merge.sql
2020-08-22 15:50:19.484911 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-08-22 15:50:19.487911 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-08-22 15:50:19.495914 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-08-22 15:50:19.523920 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-08-22 15:50:19.561929 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-08-22 15:50:19.563929 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-08-22 15:50:19.585934 (MainThread): Parsing macros\materializations\table\table.sql
2020-08-22 15:50:19.594935 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-08-22 15:50:19.601937 (MainThread): Parsing macros\materializations\view\view.sql
2020-08-22 15:50:19.609939 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-08-22 15:50:19.612939 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-08-22 15:50:19.613975 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-08-22 15:50:19.615940 (MainThread): Parsing macros\schema_tests\unique.sql
2020-08-22 15:50:19.617941 (MainThread): Parsing macros\adapters.sql
2020-08-22 15:50:19.638938 (MainThread): Parsing macros\catalog.sql
2020-08-22 15:50:19.646947 (MainThread): Parsing macros\etc.sql
2020-08-22 15:50:19.647947 (MainThread): Parsing macros\materializations\incremental.sql
2020-08-22 15:50:19.664943 (MainThread): Parsing macros\materializations\seed.sql
2020-08-22 15:50:19.668944 (MainThread): Parsing macros\materializations\snapshot.sql
2020-08-22 15:50:19.670945 (MainThread): Parsing macros\materializations\table.sql
2020-08-22 15:50:19.684948 (MainThread): Parsing macros\materializations\view.sql
2020-08-22 15:50:19.709954 (MainThread): Partial parsing not enabled
2020-08-22 15:50:19.751963 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:50:19.751963 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:50:19.785971 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:50:19.785971 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:50:19.796973 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:50:19.796973 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:50:20.114107 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-08-22 15:50:20.115044 (MainThread): 
2020-08-22 15:50:20.115044 (MainThread): Acquiring new bigquery connection "master".
2020-08-22 15:50:20.116046 (MainThread): Opening a new connection, currently in state closed
2020-08-22 15:50:20.131058 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_quick-asset-287211_dbt_alice".
2020-08-22 15:50:20.131058 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-22 15:50:20.131058 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-08-22 15:50:20.456496 (MainThread): 10:50:20 | Concurrency: 1 threads (target='dev')
2020-08-22 15:50:20.457496 (MainThread): 10:50:20 | 
2020-08-22 15:50:20.461026 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-08-22 15:50:20.461026 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-08-22 15:50:20.461026 (Thread-1): Opening a new connection, currently in state init
2020-08-22 15:50:20.461026 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-08-22 15:50:20.481032 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-08-22 15:50:20.482034 (Thread-1): finished collecting timing info
2020-08-22 15:50:20.482034 (Thread-1): finished collecting timing info
2020-08-22 15:50:20.482034 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-08-22 15:50:20.482034 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-08-22 15:50:20.483033 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-08-22 15:50:20.483033 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:50:20.483033 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-08-22 15:50:20.490034 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-08-22 15:50:20.491034 (Thread-1): finished collecting timing info
2020-08-22 15:50:20.491034 (Thread-1): finished collecting timing info
2020-08-22 15:50:20.491034 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-08-22 15:50:20.491034 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-08-22 15:50:20.492035 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2020-08-22 15:50:20.492035 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:50:20.492035 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2020-08-22 15:50:20.509039 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2020-08-22 15:50:20.510038 (Thread-1): finished collecting timing info
2020-08-22 15:50:20.510038 (Thread-1): finished collecting timing info
2020-08-22 15:50:20.510038 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-08-22 15:50:20.510038 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2020-08-22 15:50:20.511040 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2020-08-22 15:50:20.511040 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:50:20.511040 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2020-08-22 15:50:20.521041 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2020-08-22 15:50:20.521041 (Thread-1): finished collecting timing info
2020-08-22 15:50:20.522042 (Thread-1): finished collecting timing info
2020-08-22 15:50:20.522042 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2020-08-22 15:50:20.522042 (Thread-1): Began running node model.jaffle_shop.customers
2020-08-22 15:50:20.522042 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-08-22 15:50:20.523043 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:50:20.523043 (Thread-1): Compiling model.jaffle_shop.customers
2020-08-22 15:50:20.533044 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-08-22 15:50:20.534044 (Thread-1): finished collecting timing info
2020-08-22 15:50:20.534044 (Thread-1): finished collecting timing info
2020-08-22 15:50:20.535045 (Thread-1): Finished running node model.jaffle_shop.customers
2020-08-22 15:50:20.535045 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-08-22 15:50:20.535045 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned".
2020-08-22 15:50:20.535045 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:50:20.535045 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-08-22 15:50:20.547047 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"
2020-08-22 15:50:20.548047 (Thread-1): finished collecting timing info
2020-08-22 15:50:20.548047 (Thread-1): finished collecting timing info
2020-08-22 15:50:20.548047 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-08-22 15:50:20.548047 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id
2020-08-22 15:50:20.549047 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id".
2020-08-22 15:50:20.549047 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:50:20.549047 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id
2020-08-22 15:50:20.558050 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id"
2020-08-22 15:50:20.559050 (Thread-1): finished collecting timing info
2020-08-22 15:50:20.559050 (Thread-1): finished collecting timing info
2020-08-22 15:50:20.559050 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id
2020-08-22 15:50:20.560050 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id
2020-08-22 15:50:20.560050 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id".
2020-08-22 15:50:20.560050 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:50:20.560050 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id
2020-08-22 15:50:20.569052 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id"
2020-08-22 15:50:20.570052 (Thread-1): finished collecting timing info
2020-08-22 15:50:20.570052 (Thread-1): finished collecting timing info
2020-08-22 15:50:20.570052 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id
2020-08-22 15:50:20.571052 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id
2020-08-22 15:50:20.571052 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id".
2020-08-22 15:50:20.571052 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:50:20.571052 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id
2020-08-22 15:50:20.581055 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id"
2020-08-22 15:50:20.582055 (Thread-1): finished collecting timing info
2020-08-22 15:50:20.582055 (Thread-1): finished collecting timing info
2020-08-22 15:50:20.582055 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id
2020-08-22 15:50:20.582055 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id
2020-08-22 15:50:20.583055 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id".
2020-08-22 15:50:20.583055 (Thread-1): Opening a new connection, currently in state closed
2020-08-22 15:50:20.583055 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id
2020-08-22 15:50:20.592057 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id"
2020-08-22 15:50:20.593057 (Thread-1): finished collecting timing info
2020-08-22 15:50:20.593057 (Thread-1): finished collecting timing info
2020-08-22 15:50:20.594058 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id
2020-08-22 15:50:20.670902 (MainThread): Connection 'master' was properly closed.
2020-08-22 15:50:20.670902 (MainThread): Connection 'list_quick-asset-287211_dbt_alice' was properly closed.
2020-08-22 15:50:20.670902 (MainThread): Connection 'test.jaffle_shop.unique_customers_customer_id' was properly closed.
2020-08-22 15:50:20.701911 (MainThread): 10:50:20 | Done.
2020-08-22 15:50:20.704920 (MainThread): Acquiring new bigquery connection "generate_catalog".
2020-08-22 15:50:20.705912 (MainThread): Opening a new connection, currently in state init
2020-08-22 15:50:20.705912 (MainThread): 10:50:20 | Building catalog
2020-08-22 15:50:21.044418 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "quick-asset-287211.information_schema".
2020-08-22 15:50:21.045417 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-22 15:50:21.062421 (ThreadPoolExecutor-1_0): On quick-asset-287211.information_schema: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "quick-asset-287211.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `quick-asset-287211`.`dbt_alice`.__TABLES__
        where (upper(dataset_id) = upper('dbt_alice'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `quick-asset-287211`.`dbt_alice`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `quick-asset-287211`.`dbt_alice`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2020-08-22 15:50:27.144969 (MainThread): 10:50:27 | Catalog written to C:\Users\bhala\jaffle-shop\target\catalog.json
2020-08-22 15:50:27.144969 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA41CD108>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA41CD188>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA41CD2C8>]}
2020-08-22 15:50:27.144969 (MainThread): Flushing usage events
2020-08-22 15:50:27.389403 (MainThread): Connection 'generate_catalog' was properly closed.
2020-08-22 15:50:27.390415 (MainThread): Connection 'quick-asset-287211.information_schema' was properly closed.
2020-08-22 15:50:36.935641 (MainThread): Running with dbt=0.17.2
2020-08-22 15:50:37.265646 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-08-22 15:50:37.266646 (MainThread): Tracking: tracking
2020-08-22 15:50:37.266646 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C3ED39C08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C4278B348>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C42790848>]}
2020-08-22 15:50:37.270637 (MainThread): Serving docs at 0.0.0.0:8080
2020-08-22 15:50:37.271638 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2020-08-22 15:50:37.272648 (MainThread): Press Ctrl+C to exit.


2020-08-22 15:51:00.496717 (MainThread): Flushing usage events
2020-08-22 15:51:00.728243 (MainThread): ctrl-c
2020-08-22 15:52:14.194559 (MainThread): Running with dbt=0.17.2
2020-08-22 15:52:14.512631 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.clean.CleanTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\bhala\\.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='clean', write_json=True)
2020-08-22 15:52:14.513632 (MainThread): Tracking: tracking
2020-08-22 15:52:14.513632 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022909016AC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002290CA732C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002290CA73608>]}
2020-08-22 15:52:14.514772 (MainThread): Checking target/*
2020-08-22 15:52:14.523072 (MainThread):  Cleaned target/*
2020-08-22 15:52:14.523072 (MainThread): Checking dbt_modules/*
2020-08-22 15:52:14.524072 (MainThread):  Cleaned dbt_modules/*
2020-08-22 15:52:14.524072 (MainThread): Finished cleaning all paths.
2020-08-22 15:52:14.524072 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002290CA70D48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002290CA6ABC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002290CA73288>]}
2020-08-22 15:52:14.525071 (MainThread): Flushing usage events
